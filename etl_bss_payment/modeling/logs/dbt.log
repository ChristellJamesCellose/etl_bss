[0m10:38:07.341037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E584D0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E587ACC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E587ACD810>]}


============================== 10:38:07.352126 | 00e7b807-aa15-4c69-8b8b-456e0db53d79 ==============================
[0m10:38:07.352126 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:38:07.352126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:07.771375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00e7b807-aa15-4c69-8b8b-456e0db53d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E587ACF100>]}
[0m10:38:07.774382 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:07.779376 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:07.780376 [debug] [MainThread]: Command `dbt deps` succeeded at 10:38:07.780376 after 0.56 seconds
[0m10:38:07.781377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E584D0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E587ACF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E587ACCAC0>]}
[0m10:38:07.781377 [debug] [MainThread]: Flushing usage events
[0m10:38:12.492888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C480279E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483113520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4831102B0>]}


============================== 10:38:12.498981 | 96c569fa-18eb-4d9a-9163-29b60c708c2f ==============================
[0m10:38:12.498981 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:38:12.498981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:38:13.411685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4FF232C20>]}
[0m10:38:13.576919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4831404F0>]}
[0m10:38:13.578932 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:38:13.599915 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:38:13.600915 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:38:13.601915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483112DD0>]}
[0m10:38:15.882496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:38:15.888533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483D4CC40>]}
[0m10:38:15.899490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483FA8D00>]}
[0m10:38:15.900827 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:38:15.900827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96c569fa-18eb-4d9a-9163-29b60c708c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483FD96F0>]}
[0m10:38:15.902835 [debug] [MainThread]: Command `dbt ls` succeeded at 10:38:15.902835 after 3.48 seconds
[0m10:38:15.903914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C480279E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483C08790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C483FD96F0>]}
[0m10:38:15.903914 [debug] [MainThread]: Flushing usage events
[0m10:38:21.685787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148940DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C1CC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C1CF1C0>]}


============================== 10:38:21.691570 | 2ef8d711-4774-49dc-a1ed-19bf82bca334 ==============================
[0m10:38:21.691570 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:38:21.692570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:38:21.904205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef8d711-4774-49dc-a1ed-19bf82bca334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C1CFAF0>]}
[0m10:38:21.905207 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:21.907119 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:21.908209 [debug] [MainThread]: Command `dbt deps` succeeded at 10:38:21.908209 after 0.30 seconds
[0m10:38:21.908209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148940DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C1CE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C237220>]}
[0m10:38:21.909207 [debug] [MainThread]: Flushing usage events
[0m10:38:26.532410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD723B9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75182EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75180790>]}


============================== 10:38:26.537782 | 8176e822-e35a-4c08-865f-076e03ca4b21 ==============================
[0m10:38:26.537782 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:38:26.538830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m paytv_users_stg_to_prod -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:38:27.189055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD729ECCA0>]}
[0m10:38:27.341375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD759F3610>]}
[0m10:38:27.343287 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:38:27.356355 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:38:27.465639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:27.466638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:27.466638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:38:27.472632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75EA40D0>]}
[0m10:38:27.486651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75E74EB0>]}
[0m10:38:27.488006 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:38:27.488006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75E74D90>]}
[0m10:38:27.489103 [info ] [MainThread]: 
[0m10:38:27.490037 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:38:27.492012 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:38:27.507098 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:38:27.508101 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:38:27.508101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:27.513102 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:27.514109 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:30.475823 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m10:38:30.477820 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:38:30.480819 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:38:30.487822 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:38:30.488822 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:38:30.488822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:30.489823 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:30.489823 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:31.270997 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:38:31.272011 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:38:31.273001 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:38:31.756845 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:31.763758 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:38:31.855107 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:38:31.894084 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:31.894084 [debug] [MainThread]: On master: BEGIN
[0m10:38:31.895086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:31.895086 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:31.895086 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:32.681842 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m10:38:32.682837 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:32.683837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:38:33.177622 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:33.181677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD76101690>]}
[0m10:38:33.182624 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:33.457573 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:33.458570 [debug] [MainThread]: On master: BEGIN
[0m10:38:33.757227 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:33.758272 [debug] [MainThread]: On master: COMMIT
[0m10:38:33.758272 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:33.759283 [debug] [MainThread]: On master: COMMIT
[0m10:38:34.048455 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:34.049477 [debug] [MainThread]: On master: Close
[0m10:38:34.050485 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:38:34.051475 [info ] [MainThread]: 
[0m10:38:34.074855 [debug] [Thread-1 (]: Began running node model.modeling.paytv_users_stg_to_prod
[0m10:38:34.074855 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.paytv_users_stg_to_prod ........... [RUN]
[0m10:38:34.075913 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.paytv_users_stg_to_prod'
[0m10:38:34.076999 [debug] [Thread-1 (]: Began compiling node model.modeling.paytv_users_stg_to_prod
[0m10:38:34.080015 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.paytv_users_stg_to_prod"
[0m10:38:34.082920 [debug] [Thread-1 (]: Timing info for model.modeling.paytv_users_stg_to_prod (compile): 10:38:34.076999 => 10:38:34.081934
[0m10:38:34.082920 [debug] [Thread-1 (]: Began executing node model.modeling.paytv_users_stg_to_prod
[0m10:38:34.141930 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.paytv_users_stg_to_prod"
[0m10:38:34.146926 [debug] [Thread-1 (]: Using redshift connection "model.modeling.paytv_users_stg_to_prod"
[0m10:38:34.146926 [debug] [Thread-1 (]: On model.modeling.paytv_users_stg_to_prod: BEGIN
[0m10:38:34.147927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:38:34.147927 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:34.147927 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:36.575384 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m10:38:36.576474 [debug] [Thread-1 (]: Using redshift connection "model.modeling.paytv_users_stg_to_prod"
[0m10:38:36.577461 [debug] [Thread-1 (]: On model.modeling.paytv_users_stg_to_prod: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.paytv_users_stg_to_prod"} */

      
  
    

  create  table
    "vplus_db_premium"."analytics"."paytv_users_stg_to_prod"
    
    
    
  as (
    

select getdate(),* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m10:38:51.980921 [debug] [Thread-1 (]: SQL status: SUCCESS in 15.0 seconds
[0m10:38:52.004307 [debug] [Thread-1 (]: On model.modeling.paytv_users_stg_to_prod: COMMIT
[0m10:38:52.005396 [debug] [Thread-1 (]: Using redshift connection "model.modeling.paytv_users_stg_to_prod"
[0m10:38:52.005396 [debug] [Thread-1 (]: On model.modeling.paytv_users_stg_to_prod: COMMIT
[0m10:38:53.045258 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:38:53.047360 [debug] [Thread-1 (]: Timing info for model.modeling.paytv_users_stg_to_prod (execute): 10:38:34.083923 => 10:38:53.046377
[0m10:38:53.047360 [debug] [Thread-1 (]: On model.modeling.paytv_users_stg_to_prod: Close
[0m10:38:53.048358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8176e822-e35a-4c08-865f-076e03ca4b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD760F8520>]}
[0m10:38:53.049347 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.paytv_users_stg_to_prod ...... [[32mSUCCESS[0m in 18.97s]
[0m10:38:53.050310 [debug] [Thread-1 (]: Finished running node model.modeling.paytv_users_stg_to_prod
[0m10:38:53.053257 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:53.053257 [debug] [MainThread]: On master: BEGIN
[0m10:38:53.053257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:53.054259 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:38:53.054259 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:38:55.459781 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m10:38:55.459781 [debug] [MainThread]: On master: COMMIT
[0m10:38:55.460792 [debug] [MainThread]: Using redshift connection "master"
[0m10:38:55.460792 [debug] [MainThread]: On master: COMMIT
[0m10:38:55.759600 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:38:55.759600 [debug] [MainThread]: On master: Close
[0m10:38:55.761595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:55.762593 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:38:55.762593 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:38:55.763591 [debug] [MainThread]: Connection 'model.modeling.paytv_users_stg_to_prod' was properly closed.
[0m10:38:55.763591 [info ] [MainThread]: 
[0m10:38:55.764590 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 28.27 seconds (28.27s).
[0m10:38:55.765581 [debug] [MainThread]: Command end result
[0m10:38:55.776499 [info ] [MainThread]: 
[0m10:38:55.777496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:55.778553 [info ] [MainThread]: 
[0m10:38:55.778553 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:55.780592 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:55.779632 after 29.32 seconds
[0m10:38:55.780592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD723B9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75EDD2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75E74B80>]}
[0m10:38:55.780592 [debug] [MainThread]: Flushing usage events
[0m10:47:46.638296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEEEEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFF1C9C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFF1C9D870>]}


============================== 10:47:46.643381 | e4fb71db-da47-4169-bff8-cadfd77107c6 ==============================
[0m10:47:46.643381 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:47:46.643381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:47:46.824844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4fb71db-da47-4169-bff8-cadfd77107c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFF1CD0CA0>]}
[0m10:47:46.825833 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:47:46.826798 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:47:46.828194 [debug] [MainThread]: Command `dbt deps` succeeded at 10:47:46.828194 after 0.26 seconds
[0m10:47:46.828194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEEEEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFF1C9FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFF1C9FB50>]}
[0m10:47:46.829292 [debug] [MainThread]: Flushing usage events
[0m10:47:51.365123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A69DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761D4626B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761D460BB0>]}


============================== 10:47:51.370629 | fe3d9d91-9300-4da6-9441-cc7de1356ed7 ==============================
[0m10:47:51.370629 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:47:51.371636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:47:52.029299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe3d9d91-9300-4da6-9441-cc7de1356ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761D4908B0>]}
[0m10:47:52.173745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe3d9d91-9300-4da6-9441-cc7de1356ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761DF3CD30>]}
[0m10:47:52.174741 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:47:52.186745 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:47:52.275501 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:47:52.276503 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_users.sql
[0m10:47:52.277499 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m10:47:52.277499 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\paytv_users_stg_to_prod.sql
[0m10:47:52.607212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:47:52.613211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe3d9d91-9300-4da6-9441-cc7de1356ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761E4A80D0>]}
[0m10:47:52.625211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe3d9d91-9300-4da6-9441-cc7de1356ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761E00D120>]}
[0m10:47:52.625211 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:47:52.626211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3d9d91-9300-4da6-9441-cc7de1356ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761E00D180>]}
[0m10:47:52.628211 [debug] [MainThread]: Command `dbt ls` succeeded at 10:47:52.628211 after 1.35 seconds
[0m10:47:52.628211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A69DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761E00C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761E00D180>]}
[0m10:47:52.629211 [debug] [MainThread]: Flushing usage events
[0m10:47:57.827709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210559DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210835C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210835F1C0>]}


============================== 10:47:57.832705 | c5bf4c16-31cc-446f-8a61-cc3ef471eec9 ==============================
[0m10:47:57.832705 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:47:57.833624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:47:58.013333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5bf4c16-31cc-446f-8a61-cc3ef471eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210835FAF0>]}
[0m10:47:58.014340 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:47:58.016286 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:47:58.018372 [debug] [MainThread]: Command `dbt deps` succeeded at 10:47:58.018372 after 0.26 seconds
[0m10:47:58.019369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210559DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002210835E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221083C7220>]}
[0m10:47:58.019369 [debug] [MainThread]: Flushing usage events
[0m10:48:02.820319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E987852F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E987851540>]}


============================== 10:48:02.826322 | 4a20443f-48b4-487c-b655-835adac20f4d ==============================
[0m10:48:02.826322 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:48:02.826322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:03.633866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98537AEC0>]}
[0m10:48:03.837212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E987853EB0>]}
[0m10:48:03.839223 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:48:03.863218 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:48:04.323595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:04.324592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:04.325591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:48:04.331589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9885780D0>]}
[0m10:48:04.356977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E988549060>]}
[0m10:48:04.358141 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:48:04.359173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E988549150>]}
[0m10:48:04.361165 [info ] [MainThread]: 
[0m10:48:04.362168 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:48:04.364148 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:48:04.397921 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:48:04.398923 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:48:04.398923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:04.411904 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:48:04.411904 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:48:05.422693 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:48:05.427680 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:48:05.429677 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:48:05.437675 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:48:05.437675 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:48:05.437675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:05.438676 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:48:05.438676 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:48:05.788015 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:05.790005 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:48:05.790005 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:48:05.879970 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:05.885088 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:48:05.944409 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:48:05.985407 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:05.986409 [debug] [MainThread]: On master: BEGIN
[0m10:48:05.986409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:05.987409 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:48:05.987409 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:48:06.271611 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:06.272709 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:06.273700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:48:06.409857 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:06.413949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9887D5810>]}
[0m10:48:06.413949 [debug] [MainThread]: On master: ROLLBACK
[0m10:48:06.472950 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:06.472950 [debug] [MainThread]: On master: BEGIN
[0m10:48:06.494704 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:06.495721 [debug] [MainThread]: On master: COMMIT
[0m10:48:06.496719 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:06.497717 [debug] [MainThread]: On master: COMMIT
[0m10:48:06.545467 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:06.546551 [debug] [MainThread]: On master: Close
[0m10:48:06.548469 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:48:06.549491 [info ] [MainThread]: 
[0m10:48:06.574768 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m10:48:06.574768 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m10:48:06.575771 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m10:48:06.576772 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m10:48:06.579781 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m10:48:06.581778 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 10:48:06.576772 => 10:48:06.580781
[0m10:48:06.581778 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m10:48:06.644288 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:06.645288 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp104806609288"
    
    
    
  as (
    

select getdate(),* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m10:48:06.645288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:06.646288 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:48:06.646288 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:48:15.329451 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m10:48:15.350400 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:15.351446 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m10:48:15.413778 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:15.414783 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:15.415775 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp104806609288'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp104806609288'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp104806609288'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:48:15.660273 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:15.679310 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:15.679310 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:48:15.876466 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:15.896473 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:15.897560 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:48:16.060925 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:16.081618 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m10:48:16.084615 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:16.085615 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp104806609288"
            );
[0m10:48:16.405380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:16.407364 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:48:16.408394 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp104806609288"
    )
[0m10:48:16.514783 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "upload_date" does not exist in bss_paytv_users__dbt_tmp104806609288
[0m10:48:16.515780 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: ROLLBACK
[0m10:48:16.573010 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 10:48:06.581778 => 10:48:16.571937
[0m10:48:16.575012 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m10:48:16.611098 [debug] [Thread-1 (]: Database Error in model bss_paytv_users (models\bss_paytv_users.sql)
  column "upload_date" does not exist in bss_paytv_users__dbt_tmp104806609288
  compiled Code at target\run\modeling\models\bss_paytv_users.sql
[0m10:48:16.612104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a20443f-48b4-487c-b655-835adac20f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E988878400>]}
[0m10:48:16.612104 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics.bss_paytv_users .......... [[31mERROR[0m in 10.04s]
[0m10:48:16.612104 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m10:48:16.615694 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:16.615694 [debug] [MainThread]: On master: BEGIN
[0m10:48:16.616694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:16.616694 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:48:16.617694 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:48:18.701117 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m10:48:18.703105 [debug] [MainThread]: On master: COMMIT
[0m10:48:18.704119 [debug] [MainThread]: Using redshift connection "master"
[0m10:48:18.705120 [debug] [MainThread]: On master: COMMIT
[0m10:48:18.821851 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:48:18.823837 [debug] [MainThread]: On master: Close
[0m10:48:18.825833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:18.825833 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:48:18.826832 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:48:18.826832 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m10:48:18.827829 [info ] [MainThread]: 
[0m10:48:18.827829 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 14.47 seconds (14.47s).
[0m10:48:18.828841 [debug] [MainThread]: Command end result
[0m10:48:18.840837 [info ] [MainThread]: 
[0m10:48:18.840837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:48:18.841829 [info ] [MainThread]: 
[0m10:48:18.841829 [error] [MainThread]:   Database Error in model bss_paytv_users (models\bss_paytv_users.sql)
  column "upload_date" does not exist in bss_paytv_users__dbt_tmp104806609288
  compiled Code at target\run\modeling\models\bss_paytv_users.sql
[0m10:48:18.842829 [info ] [MainThread]: 
[0m10:48:18.842829 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:48:18.843834 [debug] [MainThread]: Command `dbt run` failed at 10:48:18.843834 after 16.11 seconds
[0m10:48:18.844830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E988903130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E988902DD0>]}
[0m10:48:18.844830 [debug] [MainThread]: Flushing usage events
[0m10:53:05.395598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187290BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872BE8C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872BE8F1C0>]}


============================== 10:53:05.399723 | 54c0b9be-eac6-4641-9823-cad524d7e1b7 ==============================
[0m10:53:05.399723 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:53:05.400730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:05.582794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54c0b9be-eac6-4641-9823-cad524d7e1b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872BE8FAF0>]}
[0m10:53:05.583799 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:05.585772 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:05.587795 [debug] [MainThread]: Command `dbt deps` succeeded at 10:53:05.586771 after 0.27 seconds
[0m10:53:05.587795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187290BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872BE8E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872BEF7220>]}
[0m10:53:05.587795 [debug] [MainThread]: Flushing usage events
[0m10:53:10.367591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EF50DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F22D2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F22D0BE0>]}


============================== 10:53:10.373588 | 29e3a53a-b2f9-46e6-9b27-400bf8aa265b ==============================
[0m10:53:10.373588 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:53:10.373588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m10:53:10.973626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e3a53a-b2f9-46e6-9b27-400bf8aa265b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F2300E80>]}
[0m10:53:11.123465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e3a53a-b2f9-46e6-9b27-400bf8aa265b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F23004C0>]}
[0m10:53:11.125231 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:53:11.136573 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:53:11.225182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:11.226178 [debug] [MainThread]: Partial parsing: updated file: modeling://models\bss_paytv_users.sql
[0m10:53:11.426318 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:53:11.431940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29e3a53a-b2f9-46e6-9b27-400bf8aa265b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F31B40D0>]}
[0m10:53:11.441022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29e3a53a-b2f9-46e6-9b27-400bf8aa265b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F2E6D210>]}
[0m10:53:11.441982 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:53:11.441982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e3a53a-b2f9-46e6-9b27-400bf8aa265b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F2E6D300>]}
[0m10:53:11.444982 [debug] [MainThread]: Command `dbt ls` succeeded at 10:53:11.444018 after 1.15 seconds
[0m10:53:11.444982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EF50DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F2E6CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F2E6D300>]}
[0m10:53:11.444982 [debug] [MainThread]: Flushing usage events
[0m10:53:16.730124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779373DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277964FC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277964FF1C0>]}


============================== 10:53:16.735200 | 53bbbcc0-4e5f-473e-895c-1082deec7b72 ==============================
[0m10:53:16.735200 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:53:16.736556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:16.915079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53bbbcc0-4e5f-473e-895c-1082deec7b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277964FFAF0>]}
[0m10:53:16.916081 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:16.917076 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:16.918080 [debug] [MainThread]: Command `dbt deps` succeeded at 10:53:16.918080 after 0.26 seconds
[0m10:53:16.918080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779373DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277964FE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027796567220>]}
[0m10:53:16.919080 [debug] [MainThread]: Flushing usage events
[0m10:53:21.463159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E4C8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E7A52EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E7A50790>]}


============================== 10:53:21.468241 | 030678b4-00c9-43d8-b353-662e65819762 ==============================
[0m10:53:21.468241 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:53:21.469195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:22.085215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E7A86830>]}
[0m10:53:22.241178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E8244910>]}
[0m10:53:22.243497 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:53:22.255504 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:53:22.342128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:22.343129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:22.343129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:53:22.349130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E87780D0>]}
[0m10:53:22.360137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E8749030>]}
[0m10:53:22.361137 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:53:22.362153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E8749120>]}
[0m10:53:22.364137 [info ] [MainThread]: 
[0m10:53:22.364137 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:53:22.367144 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:53:22.383754 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:53:22.384764 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:53:22.384764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:22.390753 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:53:22.390753 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:53:23.248934 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:53:23.250929 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:53:23.254922 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:53:23.261925 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:53:23.261925 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:53:23.262926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:23.262926 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:53:23.262926 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:53:23.776370 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:53:23.777401 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:53:23.777401 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:53:23.896886 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:23.901883 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:53:24.001273 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:53:24.040246 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:24.041249 [debug] [MainThread]: On master: BEGIN
[0m10:53:24.041249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:24.042249 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:53:24.042249 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:53:24.509983 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:24.510987 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:24.510987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:53:24.677553 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:24.681547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E89D1840>]}
[0m10:53:24.682546 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:24.794471 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:24.795466 [debug] [MainThread]: On master: BEGIN
[0m10:53:24.817985 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:24.818985 [debug] [MainThread]: On master: COMMIT
[0m10:53:24.820985 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:24.821982 [debug] [MainThread]: On master: COMMIT
[0m10:53:24.872989 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:24.874010 [debug] [MainThread]: On master: Close
[0m10:53:24.875004 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:53:24.876619 [info ] [MainThread]: 
[0m10:53:24.900766 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m10:53:24.901767 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m10:53:24.902766 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m10:53:24.903766 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m10:53:24.906767 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m10:53:24.907766 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 10:53:24.903766 => 10:53:24.907766
[0m10:53:24.908784 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m10:53:24.971878 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:24.972889 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp105324935766"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m10:53:24.973873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:24.973873 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:53:24.974876 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:53:25.701538 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:53:25.720533 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:25.721534 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m10:53:25.816551 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:25.818616 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:25.819545 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp105324935766'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp105324935766'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp105324935766'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:53:26.046928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:26.062907 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:26.063998 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:53:26.289637 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:26.307588 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:26.308582 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:53:26.467739 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:26.489402 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m10:53:26.493404 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:26.493404 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp105324935766"
            );
[0m10:53:30.539155 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m10:53:30.541150 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:30.543147 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp105324935766"
    )
[0m10:53:38.116585 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m10:53:38.136572 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:53:38.136572 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:53:38.137588 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:53:38.974334 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:53:38.978328 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 10:53:24.908784 => 10:53:38.977332
[0m10:53:38.978328 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m10:53:38.980329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030678b4-00c9-43d8-b353-662e65819762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E89C88B0>]}
[0m10:53:38.981325 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 14.08s]
[0m10:53:38.982324 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m10:53:38.985762 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:38.985762 [debug] [MainThread]: On master: BEGIN
[0m10:53:38.986875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:38.986875 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:53:38.987871 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:53:39.247965 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:39.249045 [debug] [MainThread]: On master: COMMIT
[0m10:53:39.250043 [debug] [MainThread]: Using redshift connection "master"
[0m10:53:39.251058 [debug] [MainThread]: On master: COMMIT
[0m10:53:39.324346 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:53:39.325361 [debug] [MainThread]: On master: Close
[0m10:53:39.326436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:39.326436 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:53:39.326436 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:53:39.327436 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m10:53:39.327436 [info ] [MainThread]: 
[0m10:53:39.327436 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 16.96 seconds (16.96s).
[0m10:53:39.328386 [debug] [MainThread]: Command end result
[0m10:53:39.338353 [info ] [MainThread]: 
[0m10:53:39.339353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:39.339353 [info ] [MainThread]: 
[0m10:53:39.340388 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:53:39.341431 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:39.341431 after 17.95 seconds
[0m10:53:39.342428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E4C8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E8B06920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E8B06410>]}
[0m10:53:39.342428 [debug] [MainThread]: Flushing usage events
[0m11:24:20.426570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EF06DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186F1E2E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186F1E2F250>]}


============================== 11:24:20.434604 | 852f11a9-82dc-4317-b61b-273e98f2ca41 ==============================
[0m11:24:20.434604 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:24:20.434604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:20.712479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852f11a9-82dc-4317-b61b-273e98f2ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186F1E60850>]}
[0m11:24:20.714605 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:24:20.717482 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:24:20.718529 [debug] [MainThread]: Command `dbt deps` succeeded at 11:24:20.718529 after 0.37 seconds
[0m11:24:20.719583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EF06DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186F1E2E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186F1E2E710>]}
[0m11:24:20.719583 [debug] [MainThread]: Flushing usage events
[0m11:24:25.323600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001581D8DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158206B26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158206B0BB0>]}


============================== 11:24:25.329201 | 68e3bca1-e135-4176-9348-8e6bf2e073db ==============================
[0m11:24:25.329201 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:24:25.329201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m11:24:26.020415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68e3bca1-e135-4176-9348-8e6bf2e073db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158206E08B0>]}
[0m11:24:26.161891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68e3bca1-e135-4176-9348-8e6bf2e073db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001582118CD30>]}
[0m11:24:26.163896 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:24:26.175000 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:24:26.299515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:24:26.299515 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_user_packages.sql
[0m11:24:26.300518 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m11:24:26.641962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:24:26.647045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68e3bca1-e135-4176-9348-8e6bf2e073db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158216FC0D0>]}
[0m11:24:26.660152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68e3bca1-e135-4176-9348-8e6bf2e073db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001582125D420>]}
[0m11:24:26.660152 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:24:26.661203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e3bca1-e135-4176-9348-8e6bf2e073db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001582125D480>]}
[0m11:24:26.664193 [debug] [MainThread]: Command `dbt ls` succeeded at 11:24:26.663204 after 1.41 seconds
[0m11:24:26.664193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001581D8DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001582125CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001582125D480>]}
[0m11:24:26.664193 [debug] [MainThread]: Flushing usage events
[0m11:24:31.937849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818C5ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818F36C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818F36D810>]}


============================== 11:24:31.943808 | 5d74f870-11c0-486d-ab86-05f3c74429c1 ==============================
[0m11:24:31.943808 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:24:31.944808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:32.126849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d74f870-11c0-486d-ab86-05f3c74429c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818F36F100>]}
[0m11:24:32.127850 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:24:32.128851 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:24:32.130851 [debug] [MainThread]: Command `dbt deps` succeeded at 11:24:32.130851 after 0.28 seconds
[0m11:24:32.131850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818C5ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818F36F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002818F36CAC0>]}
[0m11:24:32.131850 [debug] [MainThread]: Flushing usage events
[0m11:24:36.616098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F6AB9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9882EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9881330>]}


============================== 11:24:36.620110 | 8a01ddcc-4fb4-4595-b5d1-840a6d942776 ==============================
[0m11:24:36.620110 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:24:36.621109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:37.275858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F70F3B20>]}
[0m11:24:37.428305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA0DFC40>]}
[0m11:24:37.429315 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:24:37.441281 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:24:37.541484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:37.541484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:37.542489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:24:37.547497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA5A80D0>]}
[0m11:24:37.558486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA579480>]}
[0m11:24:37.559492 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:24:37.559492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA579570>]}
[0m11:24:37.561506 [info ] [MainThread]: 
[0m11:24:37.562523 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:24:37.564407 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:24:37.580137 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:24:37.581172 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:24:37.582071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:37.588124 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:24:37.588124 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:24:39.388329 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m11:24:39.391326 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:24:39.394324 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:24:39.403425 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:24:39.404429 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:24:39.404429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:39.404429 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:24:39.405426 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:24:39.657747 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:39.659796 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:24:39.660795 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:24:39.750129 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:39.758125 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:24:39.834417 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:24:39.869406 [debug] [MainThread]: Using redshift connection "master"
[0m11:24:39.869406 [debug] [MainThread]: On master: BEGIN
[0m11:24:39.870410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:39.870410 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:24:39.871409 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:24:40.178230 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:40.179253 [debug] [MainThread]: Using redshift connection "master"
[0m11:24:40.180249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:24:40.311007 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:40.315418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA8080D0>]}
[0m11:24:40.316419 [debug] [MainThread]: On master: ROLLBACK
[0m11:24:40.372238 [debug] [MainThread]: Using redshift connection "master"
[0m11:24:40.373329 [debug] [MainThread]: On master: BEGIN
[0m11:24:40.419391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:40.420515 [debug] [MainThread]: On master: COMMIT
[0m11:24:40.421497 [debug] [MainThread]: Using redshift connection "master"
[0m11:24:40.422495 [debug] [MainThread]: On master: COMMIT
[0m11:24:40.479204 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:40.480306 [debug] [MainThread]: On master: Close
[0m11:24:40.482332 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:24:40.483331 [info ] [MainThread]: 
[0m11:24:40.506512 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m11:24:40.506512 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m11:24:40.507492 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m11:24:40.508492 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m11:24:40.511493 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m11:24:40.512494 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 11:24:40.508492 => 11:24:40.512494
[0m11:24:40.513650 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m11:24:40.579475 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:40.580067 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp112440543451"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m11:24:40.580067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:40.581183 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:24:40.582187 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:24:52.709500 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m11:24:52.726520 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:52.727518 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m11:24:52.771340 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:52.772339 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:52.774342 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp112440543451'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp112440543451'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp112440543451'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:24:52.980275 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:52.997359 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:52.998361 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:24:53.186719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:53.206413 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:53.207503 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:24:53.353539 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:53.370489 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m11:24:53.376096 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:53.376096 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp112440543451"
            );
[0m11:24:53.526268 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:24:53.528397 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:53.529394 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp112440543451"
    )
[0m11:24:59.480171 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m11:24:59.496236 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m11:24:59.497156 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:24:59.498244 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m11:25:00.393853 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:25:00.396851 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 11:24:40.513650 => 11:25:00.395859
[0m11:25:00.396851 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m11:25:00.397849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a01ddcc-4fb4-4595-b5d1-840a6d942776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA7FCF70>]}
[0m11:25:00.398849 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 19.89s]
[0m11:25:00.398849 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m11:25:00.401852 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:00.401852 [debug] [MainThread]: On master: BEGIN
[0m11:25:00.402854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:00.402854 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:00.402854 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:00.646264 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:00.647347 [debug] [MainThread]: On master: COMMIT
[0m11:25:00.648341 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:00.649258 [debug] [MainThread]: On master: COMMIT
[0m11:25:00.692845 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:00.693845 [debug] [MainThread]: On master: Close
[0m11:25:00.695844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:00.696946 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:25:00.697945 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:25:00.697945 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m11:25:00.698934 [info ] [MainThread]: 
[0m11:25:00.699953 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 23.14 seconds (23.14s).
[0m11:25:00.700894 [debug] [MainThread]: Command end result
[0m11:25:00.711926 [info ] [MainThread]: 
[0m11:25:00.712927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:00.712927 [info ] [MainThread]: 
[0m11:25:00.713961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:25:00.715011 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:00.715011 after 24.17 seconds
[0m11:25:00.715939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F6AB9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA929750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FA928430>]}
[0m11:25:00.715939 [debug] [MainThread]: Flushing usage events
[0m11:25:05.672215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573D62DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257403EE230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257403EF250>]}


============================== 11:25:05.676694 | 958132cb-7ada-4844-b54f-b1d0e38bf4c0 ==============================
[0m11:25:05.676694 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:25:05.677650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m11:25:05.859163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '958132cb-7ada-4844-b54f-b1d0e38bf4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002574042F700>]}
[0m11:25:05.860165 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:25:05.862160 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:25:05.863160 [debug] [MainThread]: Command `dbt deps` succeeded at 11:25:05.863160 after 0.26 seconds
[0m11:25:05.864160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573D62DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257403EE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257403EE710>]}
[0m11:25:05.864160 [debug] [MainThread]: Flushing usage events
[0m11:25:10.410334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191971DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019199FA2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019199FA0790>]}


============================== 11:25:10.414420 | 811cf7b5-7097-4a79-a69f-b31cff26c677 ==============================
[0m11:25:10.414420 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:25:10.415374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:11.054130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019199FCE830>]}
[0m11:25:11.206755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919A794910>]}
[0m11:25:11.208664 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:25:11.219749 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:25:11.297126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:11.298130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:11.298130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:25:11.303145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919ACC80D0>]}
[0m11:25:11.314504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919AC994B0>]}
[0m11:25:11.315506 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:25:11.315506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919AC995A0>]}
[0m11:25:11.316505 [info ] [MainThread]: 
[0m11:25:11.317504 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:25:11.318543 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:25:11.333593 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:25:11.333593 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:25:11.333593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:11.339111 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:11.340112 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:13.360716 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m11:25:13.361709 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:25:13.363719 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:25:13.370717 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:25:13.371728 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:25:13.371728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:13.372724 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:13.372724 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:13.616834 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:13.617851 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:25:13.618851 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:25:13.702785 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:13.708780 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:25:13.759454 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:25:13.798461 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:13.799461 [debug] [MainThread]: On master: BEGIN
[0m11:25:13.799461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:13.799461 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:13.800462 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:14.052119 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.054200 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:14.055209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:25:14.190348 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.193353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919AF280D0>]}
[0m11:25:14.194370 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:14.257653 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:14.258756 [debug] [MainThread]: On master: BEGIN
[0m11:25:14.282168 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.282168 [debug] [MainThread]: On master: COMMIT
[0m11:25:14.283202 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:14.283202 [debug] [MainThread]: On master: COMMIT
[0m11:25:14.327873 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.328754 [debug] [MainThread]: On master: Close
[0m11:25:14.329752 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:25:14.330753 [info ] [MainThread]: 
[0m11:25:14.352309 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m11:25:14.353363 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m11:25:14.355280 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m11:25:14.356320 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m11:25:14.359277 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m11:25:14.361278 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 11:25:14.356320 => 11:25:14.360278
[0m11:25:14.361278 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m11:25:14.428463 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:14.428463 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp112514389278"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m11:25:14.429466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:25:14.429466 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:14.430478 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:14.844879 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.862843 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:14.862843 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m11:25:14.913728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:14.914831 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:14.915843 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp112514389278'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp112514389278'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp112514389278'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:25:15.122467 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:15.142612 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:15.143601 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:25:15.352629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:15.371625 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:15.371625 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:25:15.522556 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:15.545242 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m11:25:15.549235 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:15.550317 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp112514389278"
            );
[0m11:25:15.846934 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:15.847932 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:15.848932 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp112514389278"
    )
[0m11:25:16.084169 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:16.101171 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m11:25:16.101171 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:25:16.102180 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m11:25:16.948557 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:25:16.952486 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 11:25:14.362278 => 11:25:16.951487
[0m11:25:16.953479 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m11:25:16.954480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811cf7b5-7097-4a79-a69f-b31cff26c677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919AF20F70>]}
[0m11:25:16.956474 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 2.60s]
[0m11:25:16.957471 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m11:25:16.961496 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:16.964481 [debug] [MainThread]: On master: BEGIN
[0m11:25:16.964481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:16.965550 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:25:16.965550 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:25:17.265214 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:17.266142 [debug] [MainThread]: On master: COMMIT
[0m11:25:17.268227 [debug] [MainThread]: Using redshift connection "master"
[0m11:25:17.268227 [debug] [MainThread]: On master: COMMIT
[0m11:25:17.329223 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:25:17.330134 [debug] [MainThread]: On master: Close
[0m11:25:17.331132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:17.332131 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:25:17.332131 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:25:17.333130 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m11:25:17.333130 [info ] [MainThread]: 
[0m11:25:17.334137 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m11:25:17.335136 [debug] [MainThread]: Command end result
[0m11:25:17.346136 [info ] [MainThread]: 
[0m11:25:17.347135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:17.347135 [info ] [MainThread]: 
[0m11:25:17.348136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:25:17.349657 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:17.348651 after 7.01 seconds
[0m11:25:17.349657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191971DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919B03C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919B03C520>]}
[0m11:25:17.350656 [debug] [MainThread]: Flushing usage events
[0m13:43:20.070674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105B33DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105E0FE230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105E0FF250>]}


============================== 13:43:20.080206 | dee5679e-8f5d-4f25-aacf-f1abd5fce75a ==============================
[0m13:43:20.080206 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:20.080206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:20.441964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dee5679e-8f5d-4f25-aacf-f1abd5fce75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105E13B700>]}
[0m13:43:20.443964 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:20.449444 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:20.453458 [debug] [MainThread]: Command `dbt deps` succeeded at 13:43:20.453458 after 0.46 seconds
[0m13:43:20.453458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105B33DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105E0FE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105E0FE710>]}
[0m13:43:20.454965 [debug] [MainThread]: Flushing usage events
[0m13:43:25.670204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A56579E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A59343520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A593402B0>]}


============================== 13:43:25.675895 | 95cfe00f-5559-4bed-b4b4-0c31ba710072 ==============================
[0m13:43:25.675895 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:25.675895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m13:43:26.642397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95cfe00f-5559-4bed-b4b4-0c31ba710072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A55622C20>]}
[0m13:43:26.799782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95cfe00f-5559-4bed-b4b4-0c31ba710072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A593704F0>]}
[0m13:43:26.801712 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:43:26.813424 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:43:26.991985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m13:43:26.991985 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_provider_packages.sql
[0m13:43:26.992980 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_providers.sql
[0m13:43:26.992980 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m13:43:26.993984 [debug] [MainThread]: Partial parsing: updated file: modeling://models\bss_paytv_user_packages.sql
[0m13:43:27.365097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:43:27.371455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95cfe00f-5559-4bed-b4b4-0c31ba710072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5A38C0D0>]}
[0m13:43:27.385716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95cfe00f-5559-4bed-b4b4-0c31ba710072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5A039840>]}
[0m13:43:27.386778 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:43:27.386778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95cfe00f-5559-4bed-b4b4-0c31ba710072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5A039930>]}
[0m13:43:27.389761 [debug] [MainThread]: Command `dbt ls` succeeded at 13:43:27.389761 after 1.80 seconds
[0m13:43:27.389761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A56579E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5A039120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5A039930>]}
[0m13:43:27.390811 [debug] [MainThread]: Flushing usage events
[0m13:43:33.182244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD7DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEB3C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEB3D870>]}


============================== 13:43:33.187946 | dd946c1c-57da-4b76-8328-a33e17679460 ==============================
[0m13:43:33.187946 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:33.188907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:33.381161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd946c1c-57da-4b76-8328-a33e17679460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEB7B340>]}
[0m13:43:33.382162 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:33.384162 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:33.385668 [debug] [MainThread]: Command `dbt deps` succeeded at 13:43:33.385668 after 0.28 seconds
[0m13:43:33.386675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD7DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEB3FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFEB3FB50>]}
[0m13:43:33.386675 [debug] [MainThread]: Flushing usage events
[0m13:43:38.179688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7CA1DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7F7E01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7F7E2410>]}


============================== 13:43:38.185244 | f05eadde-394b-4674-9fbb-f994f7682fa0 ==============================
[0m13:43:38.185244 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:38.185498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:38.853732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7F812020>]}
[0m13:43:39.007303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7F7E3340>]}
[0m13:43:39.010307 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:43:39.022975 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:43:39.123229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:39.123229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:39.124215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:43:39.129918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D005C0A60>]}
[0m13:43:39.147060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00592320>]}
[0m13:43:39.147060 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:43:39.148060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00592380>]}
[0m13:43:39.149057 [info ] [MainThread]: 
[0m13:43:39.150056 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:43:39.153053 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:43:39.172985 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:43:39.173997 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:43:39.173997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:39.181529 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:39.181529 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:40.585416 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:40.589276 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:43:40.593272 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:43:40.600818 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:43:40.601818 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:43:40.601818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:40.602819 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:40.602819 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:41.113216 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:41.115283 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:43:41.115884 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:43:41.216079 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:41.222075 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:43:41.309194 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:43:41.353391 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:41.353391 [debug] [MainThread]: On master: BEGIN
[0m13:43:41.353391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:41.353391 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:41.355003 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:41.751354 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:41.751354 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:41.752459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:43:41.907175 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:41.913173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00820AC0>]}
[0m13:43:41.913173 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:41.983500 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:41.985377 [debug] [MainThread]: On master: BEGIN
[0m13:43:42.051655 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:42.052740 [debug] [MainThread]: On master: COMMIT
[0m13:43:42.053735 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:42.053735 [debug] [MainThread]: On master: COMMIT
[0m13:43:42.213594 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:42.213594 [debug] [MainThread]: On master: Close
[0m13:43:42.217289 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:43:42.218350 [info ] [MainThread]: 
[0m13:43:42.250184 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m13:43:42.251267 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m13:43:42.252184 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m13:43:42.253283 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m13:43:42.256970 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m13:43:42.259555 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 13:43:42.253283 => 13:43:42.259555
[0m13:43:42.260482 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m13:43:42.327565 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:43:42.327565 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp134342289055"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages";
  );
[0m13:43:42.327565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:42.329578 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:42.329578 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:42.917786 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m13:43:42.919783 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 13:43:42.260482 => 13:43:42.919783
[0m13:43:42.920782 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m13:43:42.929543 [debug] [Thread-1 (]: Database Error in model bss_paytv_provider_packages (models\bss_paytv_provider_packages.sql)
  syntax error at or near ";"
[0m13:43:42.930567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f05eadde-394b-4674-9fbb-f994f7682fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D005B1CC0>]}
[0m13:43:42.930567 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics.bss_paytv_provider_packages  [[31mERROR[0m in 0.68s]
[0m13:43:42.931585 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m13:43:42.936018 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:42.937096 [debug] [MainThread]: On master: BEGIN
[0m13:43:42.937096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:42.938097 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:42.938097 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:43.600852 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:43.602934 [debug] [MainThread]: On master: COMMIT
[0m13:43:43.603822 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:43.604933 [debug] [MainThread]: On master: COMMIT
[0m13:43:43.672146 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:43.673163 [debug] [MainThread]: On master: Close
[0m13:43:43.675162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:43.676626 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:43:43.677631 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:43:43.678629 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m13:43:43.678629 [info ] [MainThread]: 
[0m13:43:43.679629 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m13:43:43.680628 [debug] [MainThread]: Command end result
[0m13:43:43.696817 [info ] [MainThread]: 
[0m13:43:43.697863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:43.698812 [info ] [MainThread]: 
[0m13:43:43.698812 [error] [MainThread]:   Database Error in model bss_paytv_provider_packages (models\bss_paytv_provider_packages.sql)
  syntax error at or near ";"
[0m13:43:43.699811 [info ] [MainThread]: 
[0m13:43:43.699811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:43.700811 [debug] [MainThread]: Command `dbt run` failed at 13:43:43.700811 after 5.60 seconds
[0m13:43:43.701811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7CA1DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D007FBBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D007F89A0>]}
[0m13:43:43.701811 [debug] [MainThread]: Flushing usage events
[0m13:43:49.013214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92573DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92850C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92850D810>]}


============================== 13:43:49.017654 | e351a8ac-7146-4ac4-a7d0-2413f39baf1d ==============================
[0m13:43:49.017654 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:49.018654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:49.219949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e351a8ac-7146-4ac4-a7d0-2413f39baf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92850F100>]}
[0m13:43:49.220971 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:49.222893 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:43:49.223963 [debug] [MainThread]: Command `dbt deps` succeeded at 13:43:49.223963 after 0.29 seconds
[0m13:43:49.224956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92573DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92850F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B92850CAC0>]}
[0m13:43:49.225539 [debug] [MainThread]: Flushing usage events
[0m13:43:54.410740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B99A3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9C806F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9C8055A0>]}


============================== 13:43:54.415284 | e390898a-c9f8-4904-a1ab-ab37d9bde9a3 ==============================
[0m13:43:54.415284 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:43:54.416147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:55.138751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9C836020>]}
[0m13:43:55.291461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9C807340>]}
[0m13:43:55.293381 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:43:55.307772 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:43:55.386105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:55.386105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:55.387131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:43:55.393137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D530A60>]}
[0m13:43:55.405409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D502230>]}
[0m13:43:55.406430 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:43:55.407516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D502320>]}
[0m13:43:55.408499 [info ] [MainThread]: 
[0m13:43:55.408499 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:43:55.411423 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:43:55.427709 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:43:55.428713 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:43:55.428713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:55.433667 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:55.433667 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:56.612396 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:56.617007 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:43:56.622127 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:43:56.631722 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:43:56.632795 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:43:56.632795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:56.633795 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:56.633795 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:57.340398 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:57.342499 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:43:57.343463 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:43:57.475282 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:57.481298 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:43:57.562548 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:43:57.606921 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:57.606921 [debug] [MainThread]: On master: BEGIN
[0m13:43:57.606921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:57.607917 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:57.607917 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:58.145301 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:58.146228 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:58.148318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:43:58.282344 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:58.288100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D790AF0>]}
[0m13:43:58.289085 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:58.400852 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:58.400852 [debug] [MainThread]: On master: BEGIN
[0m13:43:58.447481 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:58.449487 [debug] [MainThread]: On master: COMMIT
[0m13:43:58.450474 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:58.451473 [debug] [MainThread]: On master: COMMIT
[0m13:43:58.543867 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:58.545903 [debug] [MainThread]: On master: Close
[0m13:43:58.548913 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:43:58.549911 [info ] [MainThread]: 
[0m13:43:58.577250 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m13:43:58.577250 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m13:43:58.578247 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m13:43:58.579941 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m13:43:58.582923 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m13:43:58.584894 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 13:43:58.579941 => 13:43:58.583928
[0m13:43:58.585404 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m13:43:58.652362 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:43:58.652362 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp134358613818"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers";
  );
[0m13:43:58.653362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:58.653362 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:58.653362 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:58.949239 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m13:43:58.950338 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 13:43:58.585404 => 13:43:58.950338
[0m13:43:58.951335 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m13:43:58.955877 [debug] [Thread-1 (]: Database Error in model bss_paytv_providers (models\bss_paytv_providers.sql)
  syntax error at or near ";"
[0m13:43:58.955877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e390898a-c9f8-4904-a1ab-ab37d9bde9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D521CC0>]}
[0m13:43:58.956944 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics.bss_paytv_providers ...... [[31mERROR[0m in 0.38s]
[0m13:43:58.957957 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m13:43:58.961937 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:58.961937 [debug] [MainThread]: On master: BEGIN
[0m13:43:58.962967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:58.963862 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:43:58.963862 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:43:59.624946 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:43:59.626517 [debug] [MainThread]: On master: COMMIT
[0m13:43:59.627512 [debug] [MainThread]: Using redshift connection "master"
[0m13:43:59.627512 [debug] [MainThread]: On master: COMMIT
[0m13:43:59.875142 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:43:59.876171 [debug] [MainThread]: On master: Close
[0m13:43:59.879165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:59.880172 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:43:59.880172 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:43:59.880172 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m13:43:59.881779 [info ] [MainThread]: 
[0m13:43:59.882878 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m13:43:59.883864 [debug] [MainThread]: Command end result
[0m13:43:59.896009 [info ] [MainThread]: 
[0m13:43:59.896009 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:59.897084 [info ] [MainThread]: 
[0m13:43:59.897084 [error] [MainThread]:   Database Error in model bss_paytv_providers (models\bss_paytv_providers.sql)
  syntax error at or near ";"
[0m13:43:59.898103 [info ] [MainThread]: 
[0m13:43:59.898103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:59.899080 [debug] [MainThread]: Command `dbt run` failed at 13:43:59.899080 after 5.58 seconds
[0m13:43:59.900099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B99A3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D76B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B9D76B790>]}
[0m13:43:59.900099 [debug] [MainThread]: Flushing usage events
[0m13:44:05.659793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BEC99E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1A5C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1A5CFD0>]}


============================== 13:44:05.669864 | dcb09f79-ce98-406c-afaf-23e17ae128ab ==============================
[0m13:44:05.669864 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:44:05.670971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.874028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb09f79-ce98-406c-afaf-23e17ae128ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1A5FAC0>]}
[0m13:44:05.875616 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:05.877631 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:05.878705 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:05.878705 after 0.32 seconds
[0m13:44:05.879703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223BEC99E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1A5ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C1AC71F0>]}
[0m13:44:05.879703 [debug] [MainThread]: Flushing usage events
[0m13:44:11.277524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09953DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C306FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C305690>]}


============================== 13:44:11.282499 | 2f7732af-94e1-4088-af3e-f2370b8dc3a0 ==============================
[0m13:44:11.282499 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:44:11.283499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:11.977634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09BCA1510>]}
[0m13:44:12.145583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C3075B0>]}
[0m13:44:12.148689 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:44:12.161351 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:44:12.255711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:12.255711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:12.257723 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:44:12.269353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D030AC0>]}
[0m13:44:12.300172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D002290>]}
[0m13:44:12.301171 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:44:12.301171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D002380>]}
[0m13:44:12.303169 [info ] [MainThread]: 
[0m13:44:12.303169 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:44:12.305201 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:44:12.322141 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:44:12.323139 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:44:12.323139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:12.328823 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:12.328823 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:13.073594 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:13.077120 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:44:13.082114 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:44:13.094969 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:44:13.095992 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:44:13.096975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:13.098024 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:13.099032 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:13.450342 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:13.451300 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:44:13.452363 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:44:13.580286 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:13.584795 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:44:13.910713 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:44:13.962888 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:13.962888 [debug] [MainThread]: On master: BEGIN
[0m13:44:13.962888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:13.963889 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:13.963889 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:14.940585 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:14.943478 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:14.943478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:44:15.083754 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:15.092297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D290B80>]}
[0m13:44:15.093395 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:15.159983 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:15.161945 [debug] [MainThread]: On master: BEGIN
[0m13:44:15.194036 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:15.195028 [debug] [MainThread]: On master: COMMIT
[0m13:44:15.196669 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:15.197793 [debug] [MainThread]: On master: COMMIT
[0m13:44:15.278175 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:15.280269 [debug] [MainThread]: On master: Close
[0m13:44:15.283164 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:44:15.284166 [info ] [MainThread]: 
[0m13:44:15.317475 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m13:44:15.321467 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m13:44:15.323465 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m13:44:15.323465 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m13:44:15.329133 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m13:44:15.334058 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 13:44:15.325134 => 13:44:15.333058
[0m13:44:15.336659 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m13:44:15.415702 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:44:15.417713 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp134415372600"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages";
  );
[0m13:44:15.418800 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:15.420801 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:15.421739 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:15.776277 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m13:44:15.777284 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 13:44:15.337653 => 13:44:15.777284
[0m13:44:15.777284 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m13:44:15.780283 [debug] [Thread-1 (]: Database Error in model bss_paytv_user_packages (models\bss_paytv_user_packages.sql)
  syntax error at or near ";"
[0m13:44:15.781280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7732af-94e1-4088-af3e-f2370b8dc3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D022AD0>]}
[0m13:44:15.781280 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model analytics.bss_paytv_user_packages .. [[31mERROR[0m in 0.46s]
[0m13:44:15.782203 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m13:44:15.786708 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:15.786708 [debug] [MainThread]: On master: BEGIN
[0m13:44:15.787714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:15.787714 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:15.788714 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:16.179288 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:16.180270 [debug] [MainThread]: On master: COMMIT
[0m13:44:16.181358 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:16.182281 [debug] [MainThread]: On master: COMMIT
[0m13:44:16.249062 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:16.250146 [debug] [MainThread]: On master: Close
[0m13:44:16.253167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:16.254152 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:44:16.255173 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:44:16.255173 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m13:44:16.255782 [info ] [MainThread]: 
[0m13:44:16.256820 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m13:44:16.257844 [debug] [MainThread]: Command end result
[0m13:44:16.269200 [info ] [MainThread]: 
[0m13:44:16.270219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:16.270219 [info ] [MainThread]: 
[0m13:44:16.271242 [error] [MainThread]:   Database Error in model bss_paytv_user_packages (models\bss_paytv_user_packages.sql)
  syntax error at or near ";"
[0m13:44:16.271242 [info ] [MainThread]: 
[0m13:44:16.272194 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:44:16.273287 [debug] [MainThread]: Command `dbt run` failed at 13:44:16.272194 after 5.07 seconds
[0m13:44:16.273287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09953DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D26BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D26BAF0>]}
[0m13:44:16.273287 [debug] [MainThread]: Flushing usage events
[0m13:44:22.382976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08FCDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0BD8C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0BD8D810>]}


============================== 13:44:22.390498 | c53c657d-b27c-438a-855e-2ea8f5f4a26a ==============================
[0m13:44:22.390498 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:44:22.390498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m13:44:22.685464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c53c657d-b27c-438a-855e-2ea8f5f4a26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0BD8F100>]}
[0m13:44:22.687288 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:22.689296 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:22.691294 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:22.690295 after 0.41 seconds
[0m13:44:22.691294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08FCDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0BD8F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0BD8CAC0>]}
[0m13:44:22.692294 [debug] [MainThread]: Flushing usage events
[0m13:44:28.538509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6119E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA8EE2EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA8EE1330>]}


============================== 13:44:28.542578 | 9d704602-1608-4643-a794-f23406e12625 ==============================
[0m13:44:28.542578 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:44:28.543591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:29.473387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA973E470>]}
[0m13:44:29.708271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA8E9DE10>]}
[0m13:44:29.710177 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:44:29.731223 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:44:29.817974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:29.818992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:29.818992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:44:29.825008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9C109D0>]}
[0m13:44:29.838127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9BE21A0>]}
[0m13:44:29.839217 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:44:29.839217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9BE2290>]}
[0m13:44:29.841225 [info ] [MainThread]: 
[0m13:44:29.842216 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:44:29.844127 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:44:29.861544 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:44:29.862544 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:44:29.862544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:29.868219 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:29.868219 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:31.358292 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:31.361289 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:44:31.364352 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:44:31.383977 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:44:31.384978 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:44:31.386180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:31.393207 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:31.395710 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:31.795646 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:31.797661 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:44:31.798667 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:44:31.917726 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:31.928270 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:44:32.349456 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:44:32.423745 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:32.425342 [debug] [MainThread]: On master: BEGIN
[0m13:44:32.426310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:32.427381 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:32.428374 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:32.730765 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:32.731778 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:32.733771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:44:32.977567 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:32.982641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9E70A30>]}
[0m13:44:32.983640 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:33.195184 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:33.196105 [debug] [MainThread]: On master: BEGIN
[0m13:44:33.235670 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:33.236680 [debug] [MainThread]: On master: COMMIT
[0m13:44:33.237818 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:33.237818 [debug] [MainThread]: On master: COMMIT
[0m13:44:33.289787 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:33.290797 [debug] [MainThread]: On master: Close
[0m13:44:33.291796 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:44:33.292824 [info ] [MainThread]: 
[0m13:44:33.315409 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m13:44:33.316420 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m13:44:33.318420 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m13:44:33.321493 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m13:44:33.329980 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m13:44:33.331985 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 13:44:33.324969 => 13:44:33.331985
[0m13:44:33.332985 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m13:44:33.461416 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:33.462421 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp134433395383"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m13:44:33.462421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:33.463413 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:33.463413 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:34.034087 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:34.059151 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:34.060148 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m13:44:34.218351 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:34.219432 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:34.219432 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp134433395383'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp134433395383'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp134433395383'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:44:34.771065 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:34.787649 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:34.788655 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:44:35.241361 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:35.276926 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:35.278929 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:44:35.555097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:35.602651 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m13:44:35.607213 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:35.608212 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp134433395383"
            );
[0m13:44:35.775532 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:35.777388 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:35.777388 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp134433395383"
    )
[0m13:44:36.244226 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:36.302584 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m13:44:36.306193 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:44:36.307253 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m13:44:37.100434 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:37.106308 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 13:44:33.333986 => 13:44:37.105265
[0m13:44:37.107280 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m13:44:37.110282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d704602-1608-4643-a794-f23406e12625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9E64D90>]}
[0m13:44:37.112240 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 3.79s]
[0m13:44:37.113318 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m13:44:37.121291 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:37.123821 [debug] [MainThread]: On master: BEGIN
[0m13:44:37.123821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:37.126350 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:44:37.127348 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:44:38.373090 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:44:38.373090 [debug] [MainThread]: On master: COMMIT
[0m13:44:38.374183 [debug] [MainThread]: Using redshift connection "master"
[0m13:44:38.375794 [debug] [MainThread]: On master: COMMIT
[0m13:44:38.873939 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:44:38.873939 [debug] [MainThread]: On master: Close
[0m13:44:38.875623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:38.876748 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:44:38.877747 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:44:38.878741 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m13:44:38.879628 [info ] [MainThread]: 
[0m13:44:38.881638 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m13:44:38.882687 [debug] [MainThread]: Command end result
[0m13:44:38.908552 [info ] [MainThread]: 
[0m13:44:38.909535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:38.909535 [info ] [MainThread]: 
[0m13:44:38.910546 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:38.911537 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:38.911537 after 10.45 seconds
[0m13:44:38.911537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6119E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA981EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9BE1D20>]}
[0m13:44:38.912540 [debug] [MainThread]: Flushing usage events
[0m13:45:54.209220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E6A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E984C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E984D810>]}


============================== 13:45:54.215995 | 9fb64071-3b0a-48a0-ba0c-f8cda9a25a05 ==============================
[0m13:45:54.215995 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:45:54.216895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:45:54.414003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb64071-3b0a-48a0-ba0c-f8cda9a25a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E984F100>]}
[0m13:45:54.415596 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:45:54.417609 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:45:54.418638 [debug] [MainThread]: Command `dbt deps` succeeded at 13:45:54.418638 after 0.31 seconds
[0m13:45:54.418638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E6A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E984F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E984CAC0>]}
[0m13:45:54.420234 [debug] [MainThread]: Flushing usage events
[0m13:45:59.627256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E4A0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E77C2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E77C14E0>]}


============================== 13:45:59.633281 | 8cfeed78-a771-4811-9cc1-21380666b24b ==============================
[0m13:45:59.633281 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:45:59.634253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:00.350647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cfeed78-a771-4811-9cc1-21380666b24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E77F3520>]}
[0m13:46:00.505095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cfeed78-a771-4811-9cc1-21380666b24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E80488B0>]}
[0m13:46:00.507102 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:46:00.520698 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:46:00.631054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:46:00.632055 [debug] [MainThread]: Partial parsing: updated file: modeling://models\bss_paytv_provider_packages.sql
[0m13:46:00.632055 [debug] [MainThread]: Partial parsing: updated file: modeling://models\bss_paytv_user_packages.sql
[0m13:46:00.633054 [debug] [MainThread]: Partial parsing: updated file: modeling://models\bss_paytv_providers.sql
[0m13:46:00.862065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:46:00.869760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cfeed78-a771-4811-9cc1-21380666b24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E86B80D0>]}
[0m13:46:00.882430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cfeed78-a771-4811-9cc1-21380666b24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E83E64D0>]}
[0m13:46:00.882430 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:46:00.883516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfeed78-a771-4811-9cc1-21380666b24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E83E64A0>]}
[0m13:46:00.886050 [debug] [MainThread]: Command `dbt ls` succeeded at 13:46:00.886050 after 1.34 seconds
[0m13:46:00.887112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E4A0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E83E5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225E83E64A0>]}
[0m13:46:00.887112 [debug] [MainThread]: Flushing usage events
[0m13:46:07.546373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F420BD9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42399FA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42399CEB0>]}


============================== 13:46:07.551325 | ed9a472e-9f54-44fb-bc23-bd0c584e97f9 ==============================
[0m13:46:07.551325 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:46:07.552323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m13:46:07.741993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed9a472e-9f54-44fb-bc23-bd0c584e97f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42399CFA0>]}
[0m13:46:07.743004 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:46:07.744933 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:46:07.746484 [debug] [MainThread]: Command `dbt deps` succeeded at 13:46:07.746484 after 0.28 seconds
[0m13:46:07.746484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F420BD9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F42399CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F423AAF280>]}
[0m13:46:07.747462 [debug] [MainThread]: Flushing usage events
[0m13:46:14.123060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5073DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD534FAF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD534F9540>]}


============================== 13:46:14.128315 | 53ed9a3d-e700-4c84-a785-832156552eb6 ==============================
[0m13:46:14.128315 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:46:14.129316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:15.016861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5102AEC0>]}
[0m13:46:15.231247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD534FBEB0>]}
[0m13:46:15.234204 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:46:15.253098 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:46:15.382159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:15.383252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:15.384253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:46:15.393813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD54230A30>]}
[0m13:46:15.413017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD54202200>]}
[0m13:46:15.413017 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:46:15.414018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD542022F0>]}
[0m13:46:15.415026 [info ] [MainThread]: 
[0m13:46:15.415614 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:46:15.424869 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:46:15.447865 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:46:15.448863 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:46:15.448863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:15.460395 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:15.460395 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:16.501225 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:16.506734 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:46:16.512734 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:46:16.531009 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:46:16.531912 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:46:16.531912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:16.532975 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:16.533887 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:17.005781 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:17.007834 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:46:17.008916 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:46:17.135166 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:17.150448 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:46:17.261640 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:46:17.321256 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:17.322279 [debug] [MainThread]: On master: BEGIN
[0m13:46:17.323277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:17.323277 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:17.324276 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:18.045082 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:18.047186 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:18.048208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:46:18.198412 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:18.209011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD54490A60>]}
[0m13:46:18.210012 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:18.339150 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:18.341235 [debug] [MainThread]: On master: BEGIN
[0m13:46:18.372375 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:18.373457 [debug] [MainThread]: On master: COMMIT
[0m13:46:18.375335 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:18.377157 [debug] [MainThread]: On master: COMMIT
[0m13:46:18.433257 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:18.436764 [debug] [MainThread]: On master: Close
[0m13:46:18.439803 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:46:18.440768 [info ] [MainThread]: 
[0m13:46:18.485985 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m13:46:18.489034 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m13:46:18.490982 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m13:46:18.492983 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m13:46:18.505428 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m13:46:18.509280 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 13:46:18.492983 => 13:46:18.508282
[0m13:46:18.510384 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m13:46:18.728102 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:18.729111 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp134618607806"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m13:46:18.730107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:18.732998 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:18.735493 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:22.981002 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m13:46:23.038628 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.040634 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m13:46:23.092960 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:23.094880 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.097083 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp134618607806'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp134618607806'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp134618607806'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:46:23.336842 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:23.386175 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.388248 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:46:23.591368 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:23.652043 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.653554 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:46:23.808948 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:23.868072 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.880790 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:23.883797 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp134618607806"
            );
[0m13:46:24.039701 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:24.041682 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:24.042688 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp134618607806"
    )
[0m13:46:28.256203 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m13:46:28.315447 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m13:46:28.316481 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m13:46:28.317478 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m13:46:29.250274 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:29.253253 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 13:46:18.511379 => 13:46:29.252253
[0m13:46:29.255251 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m13:46:29.261381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53ed9a3d-e700-4c84-a785-832156552eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD54426BC0>]}
[0m13:46:29.263382 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 10.77s]
[0m13:46:29.265905 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m13:46:29.271915 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:29.277468 [debug] [MainThread]: On master: BEGIN
[0m13:46:29.279481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:29.280482 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:29.281489 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:29.926559 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:29.929012 [debug] [MainThread]: On master: COMMIT
[0m13:46:29.931011 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:29.932014 [debug] [MainThread]: On master: COMMIT
[0m13:46:30.056263 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:30.059295 [debug] [MainThread]: On master: Close
[0m13:46:30.063955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:30.065516 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:46:30.066636 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:46:30.067584 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m13:46:30.068641 [info ] [MainThread]: 
[0m13:46:30.069619 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 14.65 seconds (14.65s).
[0m13:46:30.071615 [debug] [MainThread]: Command end result
[0m13:46:30.113161 [info ] [MainThread]: 
[0m13:46:30.114226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:30.115810 [info ] [MainThread]: 
[0m13:46:30.116882 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:46:30.120921 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:30.119907 after 16.11 seconds
[0m13:46:30.121908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5073DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5446B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD544687F0>]}
[0m13:46:30.122828 [debug] [MainThread]: Flushing usage events
[0m13:46:37.273974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270B738DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BA14E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BA14F250>]}


============================== 13:46:37.280764 | 5e87e5d0-bc44-419f-a232-4d1d0474f50f ==============================
[0m13:46:37.280764 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:46:37.280764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:37.541076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e87e5d0-bc44-419f-a232-4d1d0474f50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BA18B700>]}
[0m13:46:37.542082 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:46:37.544076 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:46:37.545081 [debug] [MainThread]: Command `dbt deps` succeeded at 13:46:37.545081 after 0.37 seconds
[0m13:46:37.545591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270B738DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BA14E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BA14E710>]}
[0m13:46:37.546602 [debug] [MainThread]: Flushing usage events
[0m13:46:43.748592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002535116DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025353F40220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025353F42380>]}


============================== 13:46:43.753781 | 402c2c03-ff6e-4407-bbeb-e2cbfe1d8784 ==============================
[0m13:46:43.753781 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:46:43.753781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:44.714115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253538D1510>]}
[0m13:46:44.937707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025353F435B0>]}
[0m13:46:44.939702 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:46:44.957064 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:46:45.081020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:45.082029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:45.083052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:46:45.088783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354C70AC0>]}
[0m13:46:45.106749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354C42290>]}
[0m13:46:45.106749 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:46:45.107763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354C42380>]}
[0m13:46:45.108849 [info ] [MainThread]: 
[0m13:46:45.110767 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:46:45.116284 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:46:45.137785 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:46:45.138797 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:46:45.138797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:45.148286 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:45.149356 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:46.534284 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:46.536557 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:46:46.541628 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:46:46.557064 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:46:46.557064 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:46:46.557935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:46.557935 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:46.562292 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:46.978405 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:46.980952 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:46:46.982042 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:46:47.099637 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:47.115286 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:46:47.168857 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:46:47.275818 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:47.278830 [debug] [MainThread]: On master: BEGIN
[0m13:46:47.280342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:47.281443 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:47.282442 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:47.613636 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:47.615240 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:47.616246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:46:47.750240 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:47.756839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354ED0AF0>]}
[0m13:46:47.758779 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:47.823901 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:47.829336 [debug] [MainThread]: On master: BEGIN
[0m13:46:47.855505 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:47.857448 [debug] [MainThread]: On master: COMMIT
[0m13:46:47.859366 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:47.861378 [debug] [MainThread]: On master: COMMIT
[0m13:46:47.912689 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:47.913684 [debug] [MainThread]: On master: Close
[0m13:46:47.917393 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:46:47.918394 [info ] [MainThread]: 
[0m13:46:47.965351 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m13:46:47.967353 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m13:46:47.970368 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m13:46:47.971369 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m13:46:47.983669 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m13:46:47.987283 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 13:46:47.972369 => 13:46:47.986341
[0m13:46:47.988364 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m13:46:48.162712 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:48.163870 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp134648074207"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m13:46:48.163870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:48.165011 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:48.165885 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:52.230615 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m13:46:52.295290 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:52.296391 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m13:46:52.350660 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:52.351661 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:52.352661 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp134648074207'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp134648074207'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp134648074207'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:46:52.626744 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:52.668066 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:52.670070 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:46:53.035870 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:53.092170 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:53.093198 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:46:53.259937 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:53.321192 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m13:46:53.332479 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:53.333474 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp134648074207"
            );
[0m13:46:53.464544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:53.466256 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:53.468240 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp134648074207"
    )
[0m13:46:57.223157 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m13:46:57.277346 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m13:46:57.279363 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m13:46:57.281642 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m13:46:57.875984 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:46:57.879026 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 13:46:47.990411 => 13:46:57.879026
[0m13:46:57.881034 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m13:46:57.884933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '402c2c03-ff6e-4407-bbeb-e2cbfe1d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354E6AA10>]}
[0m13:46:57.889479 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 9.92s]
[0m13:46:57.891567 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m13:46:57.898742 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:57.901772 [debug] [MainThread]: On master: BEGIN
[0m13:46:57.903759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:57.906287 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:46:57.907377 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:46:58.296966 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:58.298048 [debug] [MainThread]: On master: COMMIT
[0m13:46:58.303631 [debug] [MainThread]: Using redshift connection "master"
[0m13:46:58.305230 [debug] [MainThread]: On master: COMMIT
[0m13:46:58.366045 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:46:58.370030 [debug] [MainThread]: On master: Close
[0m13:46:58.373028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:58.374042 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:46:58.375565 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:46:58.376584 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m13:46:58.377616 [info ] [MainThread]: 
[0m13:46:58.379614 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.27 seconds (13.27s).
[0m13:46:58.381609 [debug] [MainThread]: Command end result
[0m13:46:58.425071 [info ] [MainThread]: 
[0m13:46:58.427171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:58.428188 [info ] [MainThread]: 
[0m13:46:58.429172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:46:58.434117 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:58.433085 after 14.80 seconds
[0m13:46:58.436610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002535116DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354EABCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025354EABA60>]}
[0m13:46:58.437610 [debug] [MainThread]: Flushing usage events
[0m13:47:05.473310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FA91DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FD6DC280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FD6DD870>]}


============================== 13:47:05.483930 | c222fe98-ebf2-4561-a2a0-33c4f6d5afcd ==============================
[0m13:47:05.483930 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:47:05.484904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:47:05.781454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c222fe98-ebf2-4561-a2a0-33c4f6d5afcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FD71B340>]}
[0m13:47:05.782490 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:47:05.785047 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:47:05.786147 [debug] [MainThread]: Command `dbt deps` succeeded at 13:47:05.786147 after 0.45 seconds
[0m13:47:05.787134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FA91DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FD6DFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FD6DFB50>]}
[0m13:47:05.787134 [debug] [MainThread]: Flushing usage events
[0m13:47:12.084989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84214DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C844F16FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C844F15690>]}


============================== 13:47:12.095591 | 6f1423d2-61e0-42d3-98b8-bad6a0376bae ==============================
[0m13:47:12.095591 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:47:12.096693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:13.080380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8448B1510>]}
[0m13:47:13.296619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C844F175B0>]}
[0m13:47:13.298535 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:47:13.316805 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:47:13.427362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:13.428363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:13.429363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:47:13.433362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845C40AC0>]}
[0m13:47:13.450888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845C12290>]}
[0m13:47:13.450888 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:47:13.451983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845C12380>]}
[0m13:47:13.453902 [info ] [MainThread]: 
[0m13:47:13.459454 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:47:13.461512 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:47:13.480535 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:47:13.481525 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:47:13.481525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:13.490107 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:13.491049 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:14.546128 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:14.549216 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:47:14.557809 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:47:14.569417 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:47:14.573417 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:47:14.575035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:14.575937 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:14.575937 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:14.906232 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:14.908230 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:47:14.909223 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:47:15.014231 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:15.029073 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:47:15.091147 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:47:15.192962 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:15.193965 [debug] [MainThread]: On master: BEGIN
[0m13:47:15.193965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:15.194963 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:15.195468 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:15.495181 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:15.497089 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:15.498089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:47:15.708943 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:15.715582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845EA0B20>]}
[0m13:47:15.716720 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:16.572844 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:16.573848 [debug] [MainThread]: On master: BEGIN
[0m13:47:16.645036 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:16.645943 [debug] [MainThread]: On master: COMMIT
[0m13:47:16.646947 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:16.647954 [debug] [MainThread]: On master: COMMIT
[0m13:47:16.712589 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:16.713695 [debug] [MainThread]: On master: Close
[0m13:47:16.716363 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:47:16.718334 [info ] [MainThread]: 
[0m13:47:16.762103 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m13:47:16.764150 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m13:47:16.767813 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m13:47:16.772773 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m13:47:16.782345 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m13:47:16.790922 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 13:47:16.773812 => 13:47:16.789922
[0m13:47:16.791931 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m13:47:16.993117 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:16.995032 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp134716872227"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m13:47:16.995032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:16.996458 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:16.997455 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:17.482284 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:17.553674 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:17.556267 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m13:47:17.605671 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:17.607690 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:17.607690 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp134716872227'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp134716872227'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp134716872227'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:47:17.823953 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:17.879282 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:17.880283 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:47:18.076071 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:18.140088 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:18.141087 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:47:18.293663 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:18.349085 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m13:47:18.364077 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:18.367606 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp134716872227"
            );
[0m13:47:22.388969 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m13:47:22.391074 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:22.391991 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp134716872227"
    )
[0m13:47:23.411439 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:23.472454 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m13:47:23.473465 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m13:47:23.475337 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m13:47:24.236444 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:24.240512 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 13:47:16.791931 => 13:47:24.239516
[0m13:47:24.241529 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m13:47:24.245260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f1423d2-61e0-42d3-98b8-bad6a0376bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845E2EB30>]}
[0m13:47:24.250107 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 7.48s]
[0m13:47:24.253188 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m13:47:24.260788 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:24.262729 [debug] [MainThread]: On master: BEGIN
[0m13:47:24.265399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:24.268266 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:24.269373 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:24.559334 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:24.561338 [debug] [MainThread]: On master: COMMIT
[0m13:47:24.565023 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:24.566923 [debug] [MainThread]: On master: COMMIT
[0m13:47:24.621391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:24.622375 [debug] [MainThread]: On master: Close
[0m13:47:24.625090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:24.626960 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:47:24.627970 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:47:24.631515 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m13:47:24.633502 [info ] [MainThread]: 
[0m13:47:24.633502 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m13:47:24.636107 [debug] [MainThread]: Command end result
[0m13:47:24.672857 [info ] [MainThread]: 
[0m13:47:24.673853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:24.674921 [info ] [MainThread]: 
[0m13:47:24.676195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:24.682198 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:24.681197 after 12.70 seconds
[0m13:47:24.684190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84214DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845E7BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C845E7BE20>]}
[0m13:47:24.685284 [debug] [MainThread]: Flushing usage events
[0m13:47:31.865328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E69FEFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A2CBC280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A2CBD870>]}


============================== 13:47:31.871340 | 68b7586a-c0e7-473c-a7c6-807f43a68a1f ==============================
[0m13:47:31.871340 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:47:31.874976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:32.179972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b7586a-c0e7-473c-a7c6-807f43a68a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A2CFB340>]}
[0m13:47:32.180974 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:47:32.182988 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:47:32.183974 [debug] [MainThread]: Command `dbt deps` succeeded at 13:47:32.183974 after 0.45 seconds
[0m13:47:32.183974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E69FEFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A2CBFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A2CBFB50>]}
[0m13:47:32.184974 [debug] [MainThread]: Flushing usage events
[0m13:47:38.591557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578C5DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578F3A6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578F3A55A0>]}


============================== 13:47:38.596164 | 42d2b248-a783-4105-ac66-8f24b17d13c5 ==============================
[0m13:47:38.596164 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:47:38.597241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:47:39.556963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578F3D6020>]}
[0m13:47:39.761254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578F3A7340>]}
[0m13:47:39.763290 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m13:47:39.781662 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m13:47:39.892132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:39.893101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:39.894108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m13:47:39.903702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257900D0A60>]}
[0m13:47:39.924974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257900A2320>]}
[0m13:47:39.925483 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m13:47:39.926578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257900A2380>]}
[0m13:47:39.927574 [info ] [MainThread]: 
[0m13:47:39.928489 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:47:39.930491 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m13:47:39.953466 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m13:47:39.953466 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m13:47:39.953466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:39.959163 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:39.960162 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:40.761267 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:40.764265 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m13:47:40.773316 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m13:47:40.789387 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:47:40.790389 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m13:47:40.790389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:40.791390 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:40.791390 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:41.110995 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:41.111991 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m13:47:41.113025 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m13:47:41.211247 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:41.223741 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m13:47:41.293749 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m13:47:41.371346 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:41.371346 [debug] [MainThread]: On master: BEGIN
[0m13:47:41.372346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:41.372346 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:41.373363 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:41.951615 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:41.953733 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:41.955457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:47:42.108987 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:42.119606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025790330AF0>]}
[0m13:47:42.121607 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:42.208199 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:42.209189 [debug] [MainThread]: On master: BEGIN
[0m13:47:42.234989 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:42.236926 [debug] [MainThread]: On master: COMMIT
[0m13:47:42.238009 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:42.240011 [debug] [MainThread]: On master: COMMIT
[0m13:47:42.360560 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:42.361576 [debug] [MainThread]: On master: Close
[0m13:47:42.368145 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m13:47:42.370144 [info ] [MainThread]: 
[0m13:47:42.419241 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m13:47:42.421339 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m13:47:42.424344 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m13:47:42.426026 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m13:47:42.440539 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m13:47:42.443553 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 13:47:42.427071 => 13:47:42.442540
[0m13:47:42.446193 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m13:47:42.654874 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:42.655389 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp134742543251"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m13:47:42.655389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:42.656425 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:42.656425 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:43.157372 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:43.218064 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:43.221083 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m13:47:43.318610 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:43.320625 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:43.322691 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp134742543251'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp134742543251'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp134742543251'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:47:43.671454 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:43.705109 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:43.705623 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:47:43.920806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:43.972326 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:43.973410 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m13:47:44.134286 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:44.189102 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m13:47:44.193095 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:44.194096 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp134742543251"
            );
[0m13:47:44.370260 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:44.372292 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:44.373284 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp134742543251"
    )
[0m13:47:44.636909 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:44.698007 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m13:47:44.700022 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m13:47:44.702114 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m13:47:45.534248 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m13:47:45.539031 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 13:47:42.451119 => 13:47:45.537978
[0m13:47:45.540056 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m13:47:45.545503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d2b248-a783-4105-ac66-8f24b17d13c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257902CAC50>]}
[0m13:47:45.550541 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 3.12s]
[0m13:47:45.553070 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m13:47:45.566158 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:45.567134 [debug] [MainThread]: On master: BEGIN
[0m13:47:45.568149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:45.570150 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:47:45.571149 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:47:45.934283 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:45.935827 [debug] [MainThread]: On master: COMMIT
[0m13:47:45.937868 [debug] [MainThread]: Using redshift connection "master"
[0m13:47:45.938884 [debug] [MainThread]: On master: COMMIT
[0m13:47:46.038463 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:47:46.039551 [debug] [MainThread]: On master: Close
[0m13:47:46.041562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:46.042555 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m13:47:46.043468 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m13:47:46.046058 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m13:47:46.048061 [info ] [MainThread]: 
[0m13:47:46.049062 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m13:47:46.051793 [debug] [MainThread]: Command end result
[0m13:47:46.086139 [info ] [MainThread]: 
[0m13:47:46.088233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:46.089233 [info ] [MainThread]: 
[0m13:47:46.090242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:46.095709 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:46.094169 after 7.61 seconds
[0m13:47:46.097746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578C5DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578FC4E2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257900A11B0>]}
[0m13:47:46.099732 [debug] [MainThread]: Flushing usage events
[0m14:19:17.231454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FACFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FDABC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FDABD810>]}


============================== 14:19:17.237608 | 323bd9ed-3705-4c13-96a3-9ef060788579 ==============================
[0m14:19:17.237608 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:19:17.238696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:19:17.516712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323bd9ed-3705-4c13-96a3-9ef060788579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FDABF100>]}
[0m14:19:17.518830 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:19:17.521724 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:19:17.525820 [debug] [MainThread]: Command `dbt deps` succeeded at 14:19:17.525313 after 0.39 seconds
[0m14:19:17.526834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FACFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FDABF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FDABCAC0>]}
[0m14:19:17.527838 [debug] [MainThread]: Flushing usage events
[0m14:19:24.395077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB39EDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB67B0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB67B36A0>]}


============================== 14:19:24.400732 | cae80e9e-fadd-4665-88b6-22d69d9a0183 ==============================
[0m14:19:24.400732 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:19:24.402631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:25.627922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae80e9e-fadd-4665-88b6-22d69d9a0183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB67E1C00>]}
[0m14:19:25.901989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae80e9e-fadd-4665-88b6-22d69d9a0183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB705C9D0>]}
[0m14:19:25.906661 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:19:25.927839 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:19:26.128487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:26.128487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:26.129471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:19:26.139603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae80e9e-fadd-4665-88b6-22d69d9a0183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB74E4CA0>]}
[0m14:19:26.158720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cae80e9e-fadd-4665-88b6-22d69d9a0183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB73D6470>]}
[0m14:19:26.158720 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:19:26.159720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae80e9e-fadd-4665-88b6-22d69d9a0183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB73D6560>]}
[0m14:19:26.161719 [debug] [MainThread]: Command `dbt ls` succeeded at 14:19:26.161719 after 1.85 seconds
[0m14:19:26.161719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB39EDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB73D5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB73D6560>]}
[0m14:19:26.162719 [debug] [MainThread]: Flushing usage events
[0m14:20:36.245349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200841BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086F7C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086F7F1C0>]}


============================== 14:20:36.249398 | 425c629d-1d00-4485-8013-73e53327a516 ==============================
[0m14:20:36.249398 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:20:36.250400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:20:36.438739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '425c629d-1d00-4485-8013-73e53327a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086F7FAF0>]}
[0m14:20:36.439822 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:20:36.441738 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:20:36.442813 [debug] [MainThread]: Command `dbt deps` succeeded at 14:20:36.442813 after 0.28 seconds
[0m14:20:36.442813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200841BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086F7E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086FE7220>]}
[0m14:20:36.443822 [debug] [MainThread]: Flushing usage events
[0m14:20:41.716091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025429F3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542CD026B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542CD00BB0>]}


============================== 14:20:41.720092 | d950fb07-13a9-467c-9a63-26d4bf06a291 ==============================
[0m14:20:41.720092 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:20:41.721187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:42.407946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd950fb07-13a9-467c-9a63-26d4bf06a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542CD308B0>]}
[0m14:20:42.556639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd950fb07-13a9-467c-9a63-26d4bf06a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542D7DCD30>]}
[0m14:20:42.558644 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:20:42.572429 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:20:42.650589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:42.650589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:42.651587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:20:42.658126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd950fb07-13a9-467c-9a63-26d4bf06a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542DA34C10>]}
[0m14:20:42.670821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd950fb07-13a9-467c-9a63-26d4bf06a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542D9264A0>]}
[0m14:20:42.671822 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:20:42.672921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd950fb07-13a9-467c-9a63-26d4bf06a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542D926470>]}
[0m14:20:42.675482 [debug] [MainThread]: Command `dbt ls` succeeded at 14:20:42.674898 after 1.04 seconds
[0m14:20:42.675482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025429F3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542D925CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542D926470>]}
[0m14:20:42.675482 [debug] [MainThread]: Flushing usage events
[0m14:23:31.759542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C857DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB34A230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB34B250>]}


============================== 14:23:31.766054 | b774ee00-bc27-409a-87b1-bd9b409539bd ==============================
[0m14:23:31.766054 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:23:31.767057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:31.958124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b774ee00-bc27-409a-87b1-bd9b409539bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB38B700>]}
[0m14:23:31.959141 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:23:31.961082 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:23:31.962135 [debug] [MainThread]: Command `dbt deps` succeeded at 14:23:31.962135 after 0.28 seconds
[0m14:23:31.962135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C857DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB34A1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB34A710>]}
[0m14:23:31.963128 [debug] [MainThread]: Flushing usage events
[0m14:23:36.833484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A4419E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A71E34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A71E02B0>]}


============================== 14:23:36.838563 | 921bca7b-1539-41b5-a329-9470bb96521c ==============================
[0m14:23:36.838563 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:23:36.839567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:37.581457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '921bca7b-1539-41b5-a329-9470bb96521c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A34C6BF0>]}
[0m14:23:37.735676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '921bca7b-1539-41b5-a329-9470bb96521c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7CBF400>]}
[0m14:23:37.737722 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:23:37.750025 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:23:37.831870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:37.831870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:37.832871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:23:37.838148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '921bca7b-1539-41b5-a329-9470bb96521c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7F14B80>]}
[0m14:23:37.851127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '921bca7b-1539-41b5-a329-9470bb96521c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7E06410>]}
[0m14:23:37.852140 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:23:37.853126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '921bca7b-1539-41b5-a329-9470bb96521c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7E063E0>]}
[0m14:23:37.854745 [debug] [MainThread]: Command `dbt ls` succeeded at 14:23:37.854745 after 1.10 seconds
[0m14:23:37.855637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A4419E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7E05C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7E063E0>]}
[0m14:23:37.855637 [debug] [MainThread]: Flushing usage events
[0m14:26:56.891547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB90069E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB92E2C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB92E2CFD0>]}


============================== 14:26:56.902156 | 3e22e39c-eff3-480f-83a8-705587753653 ==============================
[0m14:26:56.902156 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:26:56.902156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:26:57.171085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e22e39c-eff3-480f-83a8-705587753653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB92E2FAC0>]}
[0m14:26:57.171085 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:26:57.173683 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:26:57.173683 [debug] [MainThread]: Command `dbt deps` succeeded at 14:26:57.173683 after 0.40 seconds
[0m14:26:57.175466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB90069E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB92E2ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB92E971F0>]}
[0m14:26:57.175466 [debug] [MainThread]: Flushing usage events
[0m14:27:03.977611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E5C69E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E8A36E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E8A35360>]}


============================== 14:27:03.983743 | 56e7a3ea-e371-49eb-915a-d2f731daef2a ==============================
[0m14:27:03.983743 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:27:03.985293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:05.021415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E8A6D780>]}
[0m14:27:05.270429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E950AD40>]}
[0m14:27:05.278009 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:27:05.295976 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:27:05.416628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:05.416628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:05.417639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:27:05.428863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E9767EB0>]}
[0m14:27:05.447928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E9732200>]}
[0m14:27:05.449013 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:27:05.449013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E97321D0>]}
[0m14:27:05.450009 [info ] [MainThread]: 
[0m14:27:05.450996 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:27:05.452926 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:27:05.477661 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:27:05.478708 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:27:05.478708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:05.483758 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:05.483758 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:06.673109 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:06.680296 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:27:06.692235 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:27:06.713329 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:06.714987 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:27:06.714987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:06.715848 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:06.716849 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:07.050158 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:07.051254 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:07.052274 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:27:07.193688 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:07.209815 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:27:07.416861 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:27:07.525997 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:07.527027 [debug] [MainThread]: On master: BEGIN
[0m14:27:07.527027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:07.529086 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:07.530088 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:07.880765 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:07.882868 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:07.883868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:27:08.062856 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:08.068197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E99C09D0>]}
[0m14:27:08.074127 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:08.147247 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:08.148252 [debug] [MainThread]: On master: BEGIN
[0m14:27:08.183257 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:08.184853 [debug] [MainThread]: On master: COMMIT
[0m14:27:08.190387 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:08.192388 [debug] [MainThread]: On master: COMMIT
[0m14:27:08.243418 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:08.245979 [debug] [MainThread]: On master: Close
[0m14:27:08.248987 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:27:08.249976 [info ] [MainThread]: 
[0m14:27:08.293632 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m14:27:08.295202 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m14:27:08.297170 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m14:27:08.298172 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m14:27:08.311767 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m14:27:08.316380 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 14:27:08.299168 => 14:27:08.315344
[0m14:27:08.317357 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m14:27:08.466121 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:08.466121 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp142708393718"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m14:27:08.467114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:08.469097 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:08.472128 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:09.111686 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:09.164011 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:09.165017 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m14:27:09.225124 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:09.227219 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:09.228220 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp142708393718'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp142708393718'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp142708393718'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:27:09.457764 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:09.496409 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:09.498420 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:09.695564 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:09.757759 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:09.760769 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:09.916813 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:09.990187 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m14:27:09.999887 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:10.001805 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp142708393718"
            );
[0m14:27:10.215946 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:10.216940 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:10.219860 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp142708393718"
    )
[0m14:27:10.460213 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:10.521974 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m14:27:10.524000 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:27:10.525052 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m14:27:10.968053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:10.976613 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 14:27:08.317357 => 14:27:10.975589
[0m14:27:10.978611 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m14:27:10.983607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7a3ea-e371-49eb-915a-d2f731daef2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E99568C0>]}
[0m14:27:10.989150 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.69s]
[0m14:27:10.991159 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m14:27:10.995088 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:10.996103 [debug] [MainThread]: On master: BEGIN
[0m14:27:10.997191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:10.999201 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:11.000193 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:11.355569 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:11.356609 [debug] [MainThread]: On master: COMMIT
[0m14:27:11.358654 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:11.359625 [debug] [MainThread]: On master: COMMIT
[0m14:27:11.415195 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:11.416979 [debug] [MainThread]: On master: Close
[0m14:27:11.422991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:11.425080 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:27:11.426126 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:27:11.428244 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m14:27:11.429245 [info ] [MainThread]: 
[0m14:27:11.430253 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m14:27:11.433182 [debug] [MainThread]: Command end result
[0m14:27:11.474973 [info ] [MainThread]: 
[0m14:27:11.476862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:11.478873 [info ] [MainThread]: 
[0m14:27:11.479865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:11.483778 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:11.482863 after 7.62 seconds
[0m14:27:11.488797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E5C69E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E9423700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176E999B670>]}
[0m14:27:11.490781 [debug] [MainThread]: Flushing usage events
[0m14:27:18.737280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAC6DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAF49E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAF49F250>]}


============================== 14:27:18.741288 | f10dde4a-f479-4cc8-ab88-e0f51bddbdfe ==============================
[0m14:27:18.741288 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:27:18.742288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:19.033409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f10dde4a-f479-4cc8-ab88-e0f51bddbdfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAF4DB700>]}
[0m14:27:19.033409 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:19.036042 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:19.037101 [debug] [MainThread]: Command `dbt deps` succeeded at 14:27:19.037101 after 0.41 seconds
[0m14:27:19.038114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAC6DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAF49E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAF49E710>]}
[0m14:27:19.038114 [debug] [MainThread]: Flushing usage events
[0m14:27:25.729978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E13F4FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1422C6F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1422C5630>]}


============================== 14:27:25.735909 | 87853194-5b03-4809-b39a-9714d35efe5a ==============================
[0m14:27:25.735909 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:27:25.736970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:27:26.707961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1422F4CD0>]}
[0m14:27:26.925157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E142B46E90>]}
[0m14:27:26.928027 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:27:26.946158 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:27:27.074994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:27.076625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:27.076625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:27:27.082713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E142FF0A90>]}
[0m14:27:27.099978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E142FC2350>]}
[0m14:27:27.099978 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:27:27.101067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E142FC23B0>]}
[0m14:27:27.102046 [info ] [MainThread]: 
[0m14:27:27.103050 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:27:27.111116 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:27:27.131447 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:27:27.131447 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:27:27.132453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:27.143084 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:27.144042 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:27.964768 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:27.968828 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:27:27.980439 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:27:28.007047 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:28.009043 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:27:28.010558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:28.011573 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:28.011573 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:28.391002 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:28.392987 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:28.394986 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:27:28.484855 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:28.500580 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:27:28.582864 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:27:28.723630 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:28.725240 [debug] [MainThread]: On master: BEGIN
[0m14:27:28.726159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:28.727159 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:28.727159 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:29.200216 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:29.201215 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:29.205792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:27:29.530022 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:29.538273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E143250AF0>]}
[0m14:27:29.541291 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:29.728841 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:29.730782 [debug] [MainThread]: On master: BEGIN
[0m14:27:29.761646 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:29.762668 [debug] [MainThread]: On master: COMMIT
[0m14:27:29.764645 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:29.765172 [debug] [MainThread]: On master: COMMIT
[0m14:27:29.891046 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:29.892073 [debug] [MainThread]: On master: Close
[0m14:27:29.895670 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:27:29.896698 [info ] [MainThread]: 
[0m14:27:29.939745 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m14:27:29.941740 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m14:27:29.944901 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m14:27:29.945905 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m14:27:29.957442 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m14:27:29.963623 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 14:27:29.945905 => 14:27:29.961444
[0m14:27:29.965308 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m14:27:30.179092 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:30.180099 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp142730062448"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m14:27:30.181113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:30.183022 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:30.184017 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:30.823881 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:30.877684 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:30.878676 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m14:27:30.939771 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:30.940770 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:30.941772 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp142730062448'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp142730062448'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp142730062448'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:27:31.164781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:31.227424 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:31.229423 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:31.439923 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:31.506302 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:31.508353 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:31.659272 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:31.727569 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m14:27:31.741122 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:31.743173 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp142730062448"
            );
[0m14:27:35.726508 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m14:27:35.728588 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:35.729594 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp142730062448"
    )
[0m14:27:37.109009 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:37.168936 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m14:27:37.170950 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:27:37.171949 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m14:27:37.607754 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:37.613789 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 14:27:29.966300 => 14:27:37.611767
[0m14:27:37.618328 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m14:27:37.622859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87853194-5b03-4809-b39a-9714d35efe5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1431EAD40>]}
[0m14:27:37.629709 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 7.68s]
[0m14:27:37.635316 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m14:27:37.638879 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:37.639897 [debug] [MainThread]: On master: BEGIN
[0m14:27:37.640890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:37.642891 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:37.643900 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:37.953626 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:37.955204 [debug] [MainThread]: On master: COMMIT
[0m14:27:37.956224 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:37.957317 [debug] [MainThread]: On master: COMMIT
[0m14:27:38.024787 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:38.026348 [debug] [MainThread]: On master: Close
[0m14:27:38.031339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:38.033336 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:27:38.033336 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:27:38.034949 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m14:27:38.035918 [info ] [MainThread]: 
[0m14:27:38.037015 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m14:27:38.038980 [debug] [MainThread]: Command end result
[0m14:27:38.075201 [info ] [MainThread]: 
[0m14:27:38.077214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:38.078220 [info ] [MainThread]: 
[0m14:27:38.082218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:38.084723 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:38.084723 after 12.49 seconds
[0m14:27:38.086022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E13F4FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E142BFF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14322B940>]}
[0m14:27:38.087031 [debug] [MainThread]: Flushing usage events
[0m14:27:45.630702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F666D9DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F669B6E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F669B6F250>]}


============================== 14:27:45.635233 | 0b8fde34-7e38-4c5d-93ba-0de05cee5402 ==============================
[0m14:27:45.635233 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:27:45.636114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:45.915616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b8fde34-7e38-4c5d-93ba-0de05cee5402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F669BAB700>]}
[0m14:27:45.916713 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:45.918624 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:45.919726 [debug] [MainThread]: Command `dbt deps` succeeded at 14:27:45.919726 after 0.41 seconds
[0m14:27:45.919726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F666D9DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F669B6E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F669B6E710>]}
[0m14:27:45.920715 [debug] [MainThread]: Flushing usage events
[0m14:27:52.459204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437659DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024379366F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024379365630>]}


============================== 14:27:52.463286 | c37fd990-97c5-4342-9e6b-9238a0e0574e ==============================
[0m14:27:52.463286 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:27:52.464935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:53.545515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243793941C0>]}
[0m14:27:53.776639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024379BE6E90>]}
[0m14:27:53.778640 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:27:53.803855 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:27:53.929607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:53.930617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:53.931624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:27:53.942596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A090A90>]}
[0m14:27:53.961687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A062350>]}
[0m14:27:53.961687 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:27:53.962753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A0623B0>]}
[0m14:27:53.963756 [info ] [MainThread]: 
[0m14:27:53.964761 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:27:53.972536 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:27:54.003802 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:27:54.004780 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:27:54.005943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:54.010937 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:54.012024 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:54.845276 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:54.853040 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:27:54.861605 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:27:54.881733 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:54.886286 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:27:54.887256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:54.888264 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:54.888264 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:55.161988 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:55.162985 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:27:55.169065 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:27:55.286531 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:55.295103 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:27:55.353155 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:27:55.424776 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:55.425782 [debug] [MainThread]: On master: BEGIN
[0m14:27:55.425782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:55.426886 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:55.426886 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:55.721207 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:55.722248 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:55.723201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:27:55.853265 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:55.860787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A2F0B20>]}
[0m14:27:55.861910 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:55.926809 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:55.928765 [debug] [MainThread]: On master: BEGIN
[0m14:27:55.954997 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:55.956008 [debug] [MainThread]: On master: COMMIT
[0m14:27:55.958006 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:55.959010 [debug] [MainThread]: On master: COMMIT
[0m14:27:56.005872 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:56.005872 [debug] [MainThread]: On master: Close
[0m14:27:56.007952 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:27:56.008947 [info ] [MainThread]: 
[0m14:27:56.039297 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m14:27:56.040918 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m14:27:56.043831 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m14:27:56.045343 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m14:27:56.055885 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m14:27:56.058887 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 14:27:56.046355 => 14:27:56.058887
[0m14:27:56.059887 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m14:27:56.221971 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:56.221971 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp142756135958"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m14:27:56.224903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:56.225911 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:56.226911 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:56.603264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:56.636638 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:56.637656 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m14:27:56.688670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:56.690119 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:56.690119 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp142756135958'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp142756135958'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp142756135958'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:27:56.943767 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:57.004632 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:57.006603 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:57.200893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:57.233847 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:57.235345 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:27:57.384698 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:57.436900 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m14:27:57.451164 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:57.453164 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp142756135958"
            );
[0m14:27:57.683383 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:57.685902 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:57.686906 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp142756135958"
    )
[0m14:27:57.902731 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:57.946939 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m14:27:57.951949 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:27:57.953946 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m14:27:59.183686 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:27:59.186861 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 14:27:56.060885 => 14:27:59.186861
[0m14:27:59.187867 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m14:27:59.188956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c37fd990-97c5-4342-9e6b-9238a0e0574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A28AD40>]}
[0m14:27:59.190958 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 3.15s]
[0m14:27:59.192957 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m14:27:59.202199 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:59.203206 [debug] [MainThread]: On master: BEGIN
[0m14:27:59.203206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:59.204812 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:27:59.204812 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:27:59.533030 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:59.534029 [debug] [MainThread]: On master: COMMIT
[0m14:27:59.535535 [debug] [MainThread]: Using redshift connection "master"
[0m14:27:59.536543 [debug] [MainThread]: On master: COMMIT
[0m14:27:59.592063 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:27:59.594817 [debug] [MainThread]: On master: Close
[0m14:27:59.600743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:59.601746 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:27:59.601746 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:27:59.601746 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m14:27:59.603144 [info ] [MainThread]: 
[0m14:27:59.603657 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m14:27:59.604672 [debug] [MainThread]: Command end result
[0m14:27:59.627023 [info ] [MainThread]: 
[0m14:27:59.634101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:59.635621 [info ] [MainThread]: 
[0m14:27:59.635621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:59.637621 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:59.637621 after 7.31 seconds
[0m14:27:59.638619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437659DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A2CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437A2CBD60>]}
[0m14:27:59.638619 [debug] [MainThread]: Flushing usage events
[0m14:28:07.128244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333E57DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334133E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334133F250>]}


============================== 14:28:07.133337 | 8f2935ed-8361-4760-8714-1ba97558c3d6 ==============================
[0m14:28:07.133337 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:28:07.133337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:07.446050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f2935ed-8361-4760-8714-1ba97558c3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334137B700>]}
[0m14:28:07.447153 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:28:07.448161 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:28:07.449110 [debug] [MainThread]: Command `dbt deps` succeeded at 14:28:07.449110 after 0.44 seconds
[0m14:28:07.449110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333E57DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334133E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334133E710>]}
[0m14:28:07.450705 [debug] [MainThread]: Flushing usage events
[0m14:28:13.891554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED892DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8C0A2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8C0A0790>]}


============================== 14:28:13.896077 | 4cccce4a-3ded-4c53-bc48-a80ddc2c78ca ==============================
[0m14:28:13.896077 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:28:13.897087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:14.896403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8C0D6830>]}
[0m14:28:15.133608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8C894910>]}
[0m14:28:15.138129 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:28:15.154663 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:28:15.268947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:15.269951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:15.270954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:28:15.275445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CDD0A00>]}
[0m14:28:15.293036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CDA2290>]}
[0m14:28:15.294025 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:28:15.294025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CDA2260>]}
[0m14:28:15.295580 [info ] [MainThread]: 
[0m14:28:15.297587 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:28:15.305102 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:28:15.325192 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:28:15.325192 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:28:15.326221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:15.335770 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:15.336771 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:16.293272 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:28:16.298912 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:28:16.308110 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:28:16.331353 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:28:16.333313 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:28:16.335842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:16.337877 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:16.337877 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:17.036842 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:28:17.039068 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:28:17.040082 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:28:17.365412 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:17.384169 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:28:17.455164 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:28:17.602462 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:17.603455 [debug] [MainThread]: On master: BEGIN
[0m14:28:17.603455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:17.606021 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:17.607101 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:18.027258 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:18.029187 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:18.031191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:28:18.269923 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:18.276733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8D030AF0>]}
[0m14:28:18.278628 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:18.358835 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:18.360392 [debug] [MainThread]: On master: BEGIN
[0m14:28:18.388932 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:18.389856 [debug] [MainThread]: On master: COMMIT
[0m14:28:18.391818 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:18.392817 [debug] [MainThread]: On master: COMMIT
[0m14:28:18.697054 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:18.702050 [debug] [MainThread]: On master: Close
[0m14:28:18.705699 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:28:18.707824 [info ] [MainThread]: 
[0m14:28:18.755586 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m14:28:18.756640 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m14:28:18.758702 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m14:28:18.761313 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m14:28:18.774925 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m14:28:18.780940 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 14:28:18.761313 => 14:28:18.778934
[0m14:28:18.785483 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m14:28:19.010141 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:19.012051 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp142818880794"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m14:28:19.013109 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:19.014056 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:19.018420 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:19.727231 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:28:19.788494 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:19.790502 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m14:28:19.869893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:19.871892 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:19.873896 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp142818880794'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp142818880794'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp142818880794'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:28:20.262352 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:20.285943 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:20.286949 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:28:20.537528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:20.586992 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:20.588004 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:28:20.818879 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:20.879098 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m14:28:20.903356 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:20.905040 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp142818880794"
            );
[0m14:28:21.095153 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:21.097120 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:21.099464 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp142818880794"
    )
[0m14:28:21.340270 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:21.389530 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m14:28:21.391528 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:28:21.392412 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m14:28:22.151304 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:28:22.154994 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 14:28:18.786511 => 14:28:22.153383
[0m14:28:22.156009 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m14:28:22.159012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccce4a-3ded-4c53-bc48-a80ddc2c78ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CFCEAD0>]}
[0m14:28:22.161592 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 3.40s]
[0m14:28:22.166340 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m14:28:22.173382 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:22.176008 [debug] [MainThread]: On master: BEGIN
[0m14:28:22.176008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:22.177006 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:28:22.179014 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:28:22.627184 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:22.631123 [debug] [MainThread]: On master: COMMIT
[0m14:28:22.633207 [debug] [MainThread]: Using redshift connection "master"
[0m14:28:22.633207 [debug] [MainThread]: On master: COMMIT
[0m14:28:22.685033 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:28:22.686896 [debug] [MainThread]: On master: Close
[0m14:28:22.689869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:22.690868 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:28:22.692803 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:28:22.693795 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m14:28:22.695928 [info ] [MainThread]: 
[0m14:28:22.699926 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m14:28:22.701922 [debug] [MainThread]: Command end result
[0m14:28:22.743142 [info ] [MainThread]: 
[0m14:28:22.748783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:22.749732 [info ] [MainThread]: 
[0m14:28:22.750831 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:28:22.753833 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:22.753833 after 8.99 seconds
[0m14:28:22.754759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED892DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CA9BF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8CDA10F0>]}
[0m14:28:22.756219 [debug] [MainThread]: Flushing usage events
[0m10:33:13.001838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06CAEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F8AC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F8AF1C0>]}


============================== 10:33:13.009859 | 694525f0-b423-49c8-ad3b-f94de53fd4db ==============================
[0m10:33:13.009859 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:33:13.009859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:33:13.247961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '694525f0-b423-49c8-ad3b-f94de53fd4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F8AFAF0>]}
[0m10:33:13.249041 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:33:13.250060 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:33:13.250997 [debug] [MainThread]: Command `dbt deps` succeeded at 10:33:13.250997 after 0.35 seconds
[0m10:33:13.252041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06CAEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F8AF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F917220>]}
[0m10:33:13.252041 [debug] [MainThread]: Flushing usage events
[0m10:33:18.771108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826C149E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826EF13490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826EF10250>]}


============================== 10:33:18.777118 | 201f7353-ffc9-4064-9f2b-11734074c560 ==============================
[0m10:33:18.777118 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:33:18.777118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:19.515539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '201f7353-ffc9-4064-9f2b-11734074c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826B1F2B90>]}
[0m10:33:19.671031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '201f7353-ffc9-4064-9f2b-11734074c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826EF13B50>]}
[0m10:33:19.673030 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:33:19.697363 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:33:21.262094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:21.263095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:21.264101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:33:21.272095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '201f7353-ffc9-4064-9f2b-11734074c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826FC34B20>]}
[0m10:33:21.294593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '201f7353-ffc9-4064-9f2b-11734074c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826FB263B0>]}
[0m10:33:21.295609 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:33:21.296598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '201f7353-ffc9-4064-9f2b-11734074c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826FB26380>]}
[0m10:33:21.298600 [debug] [MainThread]: Command `dbt ls` succeeded at 10:33:21.298600 after 2.60 seconds
[0m10:33:21.299620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826C149E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826FB25C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826FB26380>]}
[0m10:33:21.299620 [debug] [MainThread]: Flushing usage events
[0m11:07:58.989276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B5FEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B8DAC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B8DAF1C0>]}


============================== 11:07:58.998317 | 0b4ad270-a9f0-422c-9715-657c97a9b237 ==============================
[0m11:07:58.998317 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:07:58.999358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:59.462595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b4ad270-a9f0-422c-9715-657c97a9b237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B8DAFAF0>]}
[0m11:07:59.463581 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:07:59.466587 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:07:59.468679 [debug] [MainThread]: Command `dbt deps` succeeded at 11:07:59.467736 after 0.56 seconds
[0m11:07:59.468679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B5FEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B8DAF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B8E17220>]}
[0m11:07:59.468679 [debug] [MainThread]: Flushing usage events
[0m11:08:05.097710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E8E5CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E913A0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E913A3670>]}


============================== 11:08:05.104796 | 5d248e77-89a5-400b-b2ff-406845e2de7b ==============================
[0m11:08:05.104796 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:08:05.104796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:05.945087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d248e77-89a5-400b-b2ff-406845e2de7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E913C9360>]}
[0m11:08:06.127643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d248e77-89a5-400b-b2ff-406845e2de7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E913A16F0>]}
[0m11:08:06.130594 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:08:06.150735 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:08:06.325338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:08:06.325338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:08:06.326339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:08:06.332338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d248e77-89a5-400b-b2ff-406845e2de7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E920D4C70>]}
[0m11:08:06.349356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d248e77-89a5-400b-b2ff-406845e2de7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E91FC6440>]}
[0m11:08:06.350350 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:08:06.350350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d248e77-89a5-400b-b2ff-406845e2de7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E91FC6530>]}
[0m11:08:06.352354 [debug] [MainThread]: Command `dbt ls` succeeded at 11:08:06.352354 after 1.34 seconds
[0m11:08:06.353355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E8E5CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E91FC5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E91FC6530>]}
[0m11:08:06.354407 [debug] [MainThread]: Flushing usage events
[0m11:10:43.869218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33414DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F336F0C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F336F0D870>]}


============================== 11:10:43.875599 | d9540a16-5324-4610-acda-a4d9b7c37373 ==============================
[0m11:10:43.875599 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:10:43.875599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:44.071154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9540a16-5324-4610-acda-a4d9b7c37373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F336F4F340>]}
[0m11:10:44.072167 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:10:44.074169 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:10:44.075222 [debug] [MainThread]: Command `dbt deps` succeeded at 11:10:44.075222 after 0.29 seconds
[0m11:10:44.076167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33414DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F336F0F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F336F0FB50>]}
[0m11:10:44.076167 [debug] [MainThread]: Flushing usage events
[0m11:10:49.492528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF11FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF3FC26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF3FC0BB0>]}


============================== 11:10:49.498214 | 5d7484eb-dfc3-4947-851d-cfaee85dcd5c ==============================
[0m11:10:49.498214 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:10:49.499189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:10:50.420056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d7484eb-dfc3-4947-851d-cfaee85dcd5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF3FEB220>]}
[0m11:10:50.579874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d7484eb-dfc3-4947-851d-cfaee85dcd5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4A9CFA0>]}
[0m11:10:50.581875 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:10:50.594980 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:10:50.681677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:50.681677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:50.682675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:10:50.687602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d7484eb-dfc3-4947-851d-cfaee85dcd5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4CF4C10>]}
[0m11:10:50.702314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d7484eb-dfc3-4947-851d-cfaee85dcd5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4BE64A0>]}
[0m11:10:50.702314 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:10:50.703414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7484eb-dfc3-4947-851d-cfaee85dcd5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4BE6470>]}
[0m11:10:50.706402 [debug] [MainThread]: Command `dbt ls` succeeded at 11:10:50.706402 after 1.29 seconds
[0m11:10:50.706402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF11FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4BE5CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4BE6470>]}
[0m11:10:50.707404 [debug] [MainThread]: Flushing usage events
[0m11:14:03.217121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161BDDA9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161C0B5C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161C0B5CFD0>]}


============================== 11:14:03.225473 | 7a003d5e-37f5-4b49-938b-a420cce104cd ==============================
[0m11:14:03.225473 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:14:03.225473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:14:03.451832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a003d5e-37f5-4b49-938b-a420cce104cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161C0B5FAC0>]}
[0m11:14:03.452931 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:03.453918 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:03.455911 [debug] [MainThread]: Command `dbt deps` succeeded at 11:14:03.455911 after 0.33 seconds
[0m11:14:03.456920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161BDDA9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161C0B5C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161C0BC71F0>]}
[0m11:14:03.456920 [debug] [MainThread]: Flushing usage events
[0m11:14:11.645449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66F39DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672166F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6721655A0>]}


============================== 11:14:11.654577 | 8e1b933f-40ae-411d-b181-cc0c3125e809 ==============================
[0m11:14:11.654577 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:14:11.654577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m11:14:13.149594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672196020>]}
[0m11:14:13.384534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672167340>]}
[0m11:14:13.387386 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:14:13.405493 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:14:13.594570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:13.595500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:13.596552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:14:13.602563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672E90A60>]}
[0m11:14:13.621474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672E62320>]}
[0m11:14:13.622544 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:14:13.622544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672E62380>]}
[0m11:14:13.624471 [info ] [MainThread]: 
[0m11:14:13.629501 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:14:13.633475 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:14:13.664473 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:14:13.665472 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:14:13.666478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:13.672941 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:13.673955 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:15.116544 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:14:15.119643 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:14:15.129550 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:14:15.158689 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:14:15.161551 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:14:15.162549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:15.164545 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:15.166557 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:15.505079 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:15.507016 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:14:15.512020 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:14:15.634738 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:15.648927 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:14:15.716219 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:14:15.857996 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:15.860869 [debug] [MainThread]: On master: BEGIN
[0m11:14:15.861867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:15.863952 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:15.865855 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:16.519926 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m11:14:16.522008 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:16.524048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:14:16.694184 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:16.701166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6730F0B20>]}
[0m11:14:16.703264 [debug] [MainThread]: On master: ROLLBACK
[0m11:14:16.766548 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:16.767572 [debug] [MainThread]: On master: BEGIN
[0m11:14:16.798122 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:16.799118 [debug] [MainThread]: On master: COMMIT
[0m11:14:16.801116 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:16.804111 [debug] [MainThread]: On master: COMMIT
[0m11:14:16.855259 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:16.857243 [debug] [MainThread]: On master: Close
[0m11:14:16.861207 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:14:16.862157 [info ] [MainThread]: 
[0m11:14:16.899799 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m11:14:16.901877 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m11:14:16.904890 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m11:14:16.905917 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m11:14:16.918881 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m11:14:16.929814 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 11:14:16.907845 => 11:14:16.928805
[0m11:14:16.931886 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m11:14:17.166795 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:17.167796 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp111417037129"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m11:14:17.168797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:14:17.169797 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:17.170794 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:17.662545 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:17.698098 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:17.699102 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m11:14:17.752619 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:17.754700 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:17.757692 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp111417037129'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp111417037129'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp111417037129'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:14:17.982050 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:18.028856 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.029905 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:14:18.292524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:18.336558 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.337541 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:14:18.532480 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:18.579578 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.586652 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.587662 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp111417037129"
            );
[0m11:14:18.725456 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:18.727452 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.729540 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp111417037129"
    )
[0m11:14:18.827200 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:18.878209 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m11:14:18.880207 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m11:14:18.881304 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m11:14:19.312739 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:19.315854 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 11:14:16.933786 => 11:14:19.314840
[0m11:14:19.317840 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m11:14:19.320738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1b933f-40ae-411d-b181-cc0c3125e809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67308ACE0>]}
[0m11:14:19.324818 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.42s]
[0m11:14:19.326739 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m11:14:19.333841 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:19.334864 [debug] [MainThread]: On master: BEGIN
[0m11:14:19.335843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:19.340750 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:19.344745 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:19.625213 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:19.626220 [debug] [MainThread]: On master: COMMIT
[0m11:14:19.628312 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:19.629299 [debug] [MainThread]: On master: COMMIT
[0m11:14:19.695548 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:19.696505 [debug] [MainThread]: On master: Close
[0m11:14:19.698506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:19.698506 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:14:19.699505 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:14:19.700505 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m11:14:19.700505 [info ] [MainThread]: 
[0m11:14:19.701516 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m11:14:19.703518 [debug] [MainThread]: Command end result
[0m11:14:19.734509 [info ] [MainThread]: 
[0m11:14:19.735505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:19.735505 [info ] [MainThread]: 
[0m11:14:19.736513 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:19.741508 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:19.741508 after 8.20 seconds
[0m11:14:19.743512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66F39DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6730CBF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6730CB7C0>]}
[0m11:14:19.743512 [debug] [MainThread]: Flushing usage events
[0m11:14:29.333208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D21F86DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22262C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22262F1C0>]}


============================== 11:14:29.341121 | d5d512e4-417d-455d-b151-f5d41ef81623 ==============================
[0m11:14:29.341121 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:14:29.342136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:14:29.601330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5d512e4-417d-455d-b151-f5d41ef81623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22262FAF0>]}
[0m11:14:29.603392 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:29.605329 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:29.606371 [debug] [MainThread]: Command `dbt deps` succeeded at 11:14:29.606371 after 0.39 seconds
[0m11:14:29.607418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D21F86DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22262F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D222697220>]}
[0m11:14:29.608431 [debug] [MainThread]: Flushing usage events
[0m11:14:37.118208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148EC93DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148EF6FEF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148EF6FD540>]}


============================== 11:14:37.128763 | 3b3d2510-54fc-48f4-9ec6-5f941444db26 ==============================
[0m11:14:37.128763 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:14:37.129759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:14:38.233288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148EF7360B0>]}
[0m11:14:38.465006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F01DA500>]}
[0m11:14:38.467030 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:14:38.486001 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:14:38.595896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:38.596954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:38.596954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:14:38.602010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F0430A30>]}
[0m11:14:38.618038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F04022C0>]}
[0m11:14:38.619006 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:14:38.619006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F0402290>]}
[0m11:14:38.619992 [info ] [MainThread]: 
[0m11:14:38.625435 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:14:38.629959 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:14:38.651987 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:14:38.652985 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:14:38.653993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:38.663989 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:38.663989 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:39.592886 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:14:39.596743 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:14:39.602739 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:14:39.625936 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:14:39.628449 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:14:39.628449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:39.629563 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:39.630584 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:39.964475 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:39.966432 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:14:39.966432 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:14:40.061030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:40.069093 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:14:40.202923 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:14:40.291954 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:40.292947 [debug] [MainThread]: On master: BEGIN
[0m11:14:40.293952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:40.293952 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:40.294952 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:40.662520 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:40.663586 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:40.664614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:14:40.800822 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:40.809800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F0690A30>]}
[0m11:14:40.810806 [debug] [MainThread]: On master: ROLLBACK
[0m11:14:40.892013 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:40.893013 [debug] [MainThread]: On master: BEGIN
[0m11:14:40.924065 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:40.926021 [debug] [MainThread]: On master: COMMIT
[0m11:14:40.928092 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:40.929647 [debug] [MainThread]: On master: COMMIT
[0m11:14:41.029210 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:41.030809 [debug] [MainThread]: On master: Close
[0m11:14:41.032807 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:14:41.034804 [info ] [MainThread]: 
[0m11:14:41.074045 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m11:14:41.075045 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m11:14:41.077244 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m11:14:41.078226 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m11:14:41.087229 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m11:14:41.095222 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 11:14:41.079225 => 11:14:41.095222
[0m11:14:41.096226 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m11:14:41.296664 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:41.297757 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp111441178593"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m11:14:41.298775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:14:41.300757 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:41.301755 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:41.757538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:41.798619 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:41.799621 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m11:14:41.891929 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:41.892919 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:41.894965 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp111441178593'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp111441178593'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp111441178593'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:14:42.115533 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:42.159076 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:42.161081 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:14:42.364067 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:42.415523 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:42.416503 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:14:42.576094 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:42.611065 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m11:14:42.620726 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:42.624703 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp111441178593"
            );
[0m11:14:42.814319 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:42.814319 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:42.815318 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp111441178593"
    )
[0m11:14:42.909399 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:42.947058 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m11:14:42.948057 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m11:14:42.949057 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m11:14:43.358125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:43.361182 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 11:14:41.097225 => 11:14:43.361182
[0m11:14:43.363194 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m11:14:43.366181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b3d2510-54fc-48f4-9ec6-5f941444db26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F062ABF0>]}
[0m11:14:43.368216 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 2.29s]
[0m11:14:43.372089 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m11:14:43.377171 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:43.378214 [debug] [MainThread]: On master: BEGIN
[0m11:14:43.380185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:43.381202 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:14:43.382182 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:14:45.121344 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m11:14:45.123358 [debug] [MainThread]: On master: COMMIT
[0m11:14:45.124356 [debug] [MainThread]: Using redshift connection "master"
[0m11:14:45.126477 [debug] [MainThread]: On master: COMMIT
[0m11:14:45.175651 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:45.176774 [debug] [MainThread]: On master: Close
[0m11:14:45.179770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:45.180773 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:14:45.181746 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:14:45.184661 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m11:14:45.188654 [info ] [MainThread]: 
[0m11:14:45.189658 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m11:14:45.191651 [debug] [MainThread]: Command end result
[0m11:14:45.225687 [info ] [MainThread]: 
[0m11:14:45.226716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:45.226716 [info ] [MainThread]: 
[0m11:14:45.227688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:45.229691 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:45.229691 after 8.23 seconds
[0m11:14:45.230690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148EC93DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F066B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148F066B940>]}
[0m11:14:45.231690 [debug] [MainThread]: Flushing usage events
[0m11:14:53.557006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E698EDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6C6AC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6C6AF1C0>]}


============================== 11:14:53.571031 | d12cbf79-3422-47e1-9a89-acb224a24d6e ==============================
[0m11:14:53.571031 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:14:53.572023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:53.863311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12cbf79-3422-47e1-9a89-acb224a24d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6C6AFAF0>]}
[0m11:14:53.865305 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:53.867313 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:14:53.869311 [debug] [MainThread]: Command `dbt deps` succeeded at 11:14:53.869311 after 0.43 seconds
[0m11:14:53.870316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E698EDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6C6AF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6C717220>]}
[0m11:14:53.870316 [debug] [MainThread]: Flushing usage events
[0m11:15:02.031677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F680DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F95D6F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F95D5630>]}


============================== 11:15:02.042710 | 19ed4b73-f882-4c65-8651-95c204d1302b ==============================
[0m11:15:02.042710 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:15:02.043685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:15:03.221143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F95FC1C0>]}
[0m11:15:03.480963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F9E5AE90>]}
[0m11:15:03.482976 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:15:03.505984 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:15:03.693487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:03.695488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:03.698487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:15:03.716518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA300A90>]}
[0m11:15:03.755816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA2D2350>]}
[0m11:15:03.756918 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:15:03.758920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA2D23B0>]}
[0m11:15:03.761949 [info ] [MainThread]: 
[0m11:15:03.763929 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:15:03.771605 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:15:03.829221 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:15:03.831223 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:15:03.832224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:03.852230 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:03.856223 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:05.356110 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m11:15:05.360074 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:15:05.367085 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:15:05.390966 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:15:05.391969 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:15:05.392983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:05.393960 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:05.394966 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:05.746028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:05.747028 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:15:05.748029 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:15:05.838316 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:05.846313 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:15:05.908117 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:15:05.989849 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:05.990845 [debug] [MainThread]: On master: BEGIN
[0m11:15:05.991845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:05.991845 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:05.992956 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:06.295093 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:06.296149 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:06.296149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:15:06.435554 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:06.441551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA560B50>]}
[0m11:15:06.442579 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:06.520021 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:06.521002 [debug] [MainThread]: On master: BEGIN
[0m11:15:06.552593 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:06.554497 [debug] [MainThread]: On master: COMMIT
[0m11:15:06.555532 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:06.555532 [debug] [MainThread]: On master: COMMIT
[0m11:15:06.628961 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:06.629998 [debug] [MainThread]: On master: Close
[0m11:15:06.634125 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:15:06.636972 [info ] [MainThread]: 
[0m11:15:06.674525 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m11:15:06.676154 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m11:15:06.679288 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m11:15:06.680302 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m11:15:06.702167 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m11:15:06.709748 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 11:15:06.681263 => 11:15:06.708749
[0m11:15:06.710802 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m11:15:06.871056 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:06.871056 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp111506773300"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m11:15:06.873526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:15:06.874570 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:06.875671 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:07.272203 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:07.316816 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:07.318732 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m11:15:07.371562 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:07.372553 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:07.373550 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp111506773300'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp111506773300'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp111506773300'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:15:07.597392 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:07.635337 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:07.637293 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:15:07.837065 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:07.876253 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:07.878161 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:15:08.056885 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:08.114011 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m11:15:08.126020 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:08.127022 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp111506773300"
            );
[0m11:15:08.265762 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:08.269645 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:08.271643 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp111506773300"
    )
[0m11:15:14.485048 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m11:15:14.548583 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m11:15:14.549592 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m11:15:14.551598 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m11:15:14.982633 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:14.986633 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 11:15:06.712805 => 11:15:14.986633
[0m11:15:14.988632 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m11:15:14.993154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19ed4b73-f882-4c65-8651-95c204d1302b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA4FAD10>]}
[0m11:15:14.998168 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 8.31s]
[0m11:15:15.000176 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m11:15:15.013193 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:15.014177 [debug] [MainThread]: On master: BEGIN
[0m11:15:15.016271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:15.018262 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:15.019264 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:15.457869 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:15.462876 [debug] [MainThread]: On master: COMMIT
[0m11:15:15.465877 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:15.466890 [debug] [MainThread]: On master: COMMIT
[0m11:15:15.533220 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:15.535316 [debug] [MainThread]: On master: Close
[0m11:15:15.537324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:15.538325 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:15:15.539319 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:15:15.540325 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m11:15:15.542290 [info ] [MainThread]: 
[0m11:15:15.545243 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m11:15:15.549780 [debug] [MainThread]: Command end result
[0m11:15:15.590225 [info ] [MainThread]: 
[0m11:15:15.596672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:15.598672 [info ] [MainThread]: 
[0m11:15:15.599670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:15.601670 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:15.601670 after 13.71 seconds
[0m11:15:15.603717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159F680DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA5388E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159FA53BB20>]}
[0m11:15:15.604669 [debug] [MainThread]: Flushing usage events
[0m11:15:23.371866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AC0DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AEE9E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AEE9F250>]}


============================== 11:15:23.379230 | da875894-04b6-4e65-af42-c2d8207b5dea ==============================
[0m11:15:23.379230 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:15:23.380477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m11:15:23.650639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da875894-04b6-4e65-af42-c2d8207b5dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AEECC850>]}
[0m11:15:23.657542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:15:23.660545 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:15:23.661635 [debug] [MainThread]: Command `dbt deps` succeeded at 11:15:23.661635 after 0.41 seconds
[0m11:15:23.662635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AC0DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AEE9FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7AEE9E710>]}
[0m11:15:23.662635 [debug] [MainThread]: Flushing usage events
[0m11:15:30.554904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019609D09E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960CAD2EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960CAD1330>]}


============================== 11:15:30.559920 | 628501da-05a4-4936-b13e-40b7b3008c85 ==============================
[0m11:15:30.559920 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:15:30.560923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:15:31.560945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D342470>]}
[0m11:15:31.870093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960CA8DE10>]}
[0m11:15:31.872010 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:15:31.892125 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:15:32.028636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:32.030629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:32.032630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:15:32.038646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D8009D0>]}
[0m11:15:32.059635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D7D21A0>]}
[0m11:15:32.060638 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:15:32.062644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D7D2290>]}
[0m11:15:32.066631 [info ] [MainThread]: 
[0m11:15:32.067632 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:15:32.070635 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m11:15:32.094641 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m11:15:32.097640 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m11:15:32.098641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:32.104635 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:32.104635 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:32.931243 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:15:32.935323 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m11:15:32.939268 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m11:15:32.956315 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:15:32.956315 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m11:15:32.957311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:32.957311 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:32.957311 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:33.248740 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:33.250753 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m11:15:33.251830 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m11:15:33.352012 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:33.365065 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m11:15:33.464922 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m11:15:33.601596 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:33.603606 [debug] [MainThread]: On master: BEGIN
[0m11:15:33.605653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:33.607706 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:33.609664 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:33.948586 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:33.950584 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:33.952709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:15:34.097420 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:34.107429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960DA60A30>]}
[0m11:15:34.114480 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:34.233533 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:34.235639 [debug] [MainThread]: On master: BEGIN
[0m11:15:34.271688 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:34.273780 [debug] [MainThread]: On master: COMMIT
[0m11:15:34.275691 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:34.277696 [debug] [MainThread]: On master: COMMIT
[0m11:15:34.355496 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:34.357494 [debug] [MainThread]: On master: Close
[0m11:15:34.361496 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m11:15:34.364491 [info ] [MainThread]: 
[0m11:15:34.414608 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m11:15:34.416588 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m11:15:34.418653 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m11:15:34.420682 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m11:15:34.433349 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m11:15:34.440581 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 11:15:34.421656 => 11:15:34.438570
[0m11:15:34.446608 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m11:15:34.652243 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:34.653190 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp111534531517"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m11:15:34.654189 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:15:34.655219 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:34.655219 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:35.202397 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:15:35.250782 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:35.251804 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m11:15:35.301655 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:35.302648 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:35.303654 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp111534531517'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp111534531517'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp111534531517'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m11:15:35.536222 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:35.579249 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:35.582582 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:15:35.784114 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:35.834904 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:35.836858 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m11:15:36.014941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:36.071183 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m11:15:36.086170 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:36.088188 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp111534531517"
            );
[0m11:15:36.258866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:36.263862 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:36.265888 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp111534531517"
    )
[0m11:15:44.123191 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m11:15:44.190070 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m11:15:44.192070 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m11:15:44.193069 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m11:15:45.055774 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:15:45.060760 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 11:15:34.449621 => 11:15:45.059765
[0m11:15:45.061848 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m11:15:45.064859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628501da-05a4-4936-b13e-40b7b3008c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D9FAB30>]}
[0m11:15:45.068758 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 10.65s]
[0m11:15:45.073770 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m11:15:45.082803 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:45.087854 [debug] [MainThread]: On master: BEGIN
[0m11:15:45.088765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:45.089755 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:15:45.091859 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:15:45.377248 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:45.378378 [debug] [MainThread]: On master: COMMIT
[0m11:15:45.380326 [debug] [MainThread]: Using redshift connection "master"
[0m11:15:45.381236 [debug] [MainThread]: On master: COMMIT
[0m11:15:45.437741 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:15:45.439753 [debug] [MainThread]: On master: Close
[0m11:15:45.443987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:45.445994 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m11:15:45.447564 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m11:15:45.448577 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m11:15:45.451557 [info ] [MainThread]: 
[0m11:15:45.455548 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.38 seconds (13.38s).
[0m11:15:45.457555 [debug] [MainThread]: Command end result
[0m11:15:45.491570 [info ] [MainThread]: 
[0m11:15:45.493581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:45.495580 [info ] [MainThread]: 
[0m11:15:45.496580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:45.503559 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:45.500560 after 15.06 seconds
[0m11:15:45.505555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019609D09E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D40EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960D7D0FA0>]}
[0m11:15:45.506548 [debug] [MainThread]: Flushing usage events
[0m14:58:08.553905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF712BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF7407C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF7407D870>]}


============================== 14:58:08.563459 | 4aeb59a3-928a-40d7-933e-c3306e29730a ==============================
[0m14:58:08.563459 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:58:08.564459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:08.925785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aeb59a3-928a-40d7-933e-c3306e29730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF740BF340>]}
[0m14:58:08.926728 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:08.929731 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:08.931763 [debug] [MainThread]: Command `dbt deps` succeeded at 14:58:08.930654 after 0.48 seconds
[0m14:58:08.932795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF712BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF7407F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF7407FB50>]}
[0m14:58:08.932795 [debug] [MainThread]: Flushing usage events
[0m14:58:17.118441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378CAEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378F8B2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378F8B0BE0>]}


============================== 14:58:17.130818 | f9075d17-b3cd-40be-bdce-67b3b60fba68 ==============================
[0m14:58:17.130818 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:58:17.132262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:18.266323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9075d17-b3cd-40be-bdce-67b3b60fba68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378F8D8070>]}
[0m14:58:18.517035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9075d17-b3cd-40be-bdce-67b3b60fba68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378F8D9A50>]}
[0m14:58:18.518757 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:58:18.540514 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:58:18.748418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:18.748418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:18.750009 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:58:18.759895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9075d17-b3cd-40be-bdce-67b3b60fba68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237905E4BE0>]}
[0m14:58:18.775956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9075d17-b3cd-40be-bdce-67b3b60fba68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237904D64A0>]}
[0m14:58:18.776950 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:58:18.776950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9075d17-b3cd-40be-bdce-67b3b60fba68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237904D6500>]}
[0m14:58:18.778972 [debug] [MainThread]: Command `dbt ls` succeeded at 14:58:18.778972 after 1.78 seconds
[0m14:58:18.780055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378CAEDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237904D5C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237904D6500>]}
[0m14:58:18.780654 [debug] [MainThread]: Flushing usage events
[0m15:04:05.140707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222111CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022213F8E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022213F8F250>]}


============================== 15:04:05.147734 | 00c9e3de-2e3c-455a-ae54-359c437ae03a ==============================
[0m15:04:05.147734 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:04:05.148716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:05.398696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c9e3de-2e3c-455a-ae54-359c437ae03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022213FCF700>]}
[0m15:04:05.400399 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:04:05.402409 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:04:05.403482 [debug] [MainThread]: Command `dbt deps` succeeded at 15:04:05.403482 after 0.35 seconds
[0m15:04:05.404497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222111CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022213F8FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022213F8E710>]}
[0m15:04:05.404497 [debug] [MainThread]: Flushing usage events
[0m15:04:11.131282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB634F9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB662C3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB662C02B0>]}


============================== 15:04:11.136294 | 4b4a07a1-a6f8-459c-9db4-fda16fafe7ea ==============================
[0m15:04:11.136294 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:04:11.138319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:11.885342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4a07a1-a6f8-459c-9db4-fda16fafe7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB625A2C20>]}
[0m15:04:12.064717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b4a07a1-a6f8-459c-9db4-fda16fafe7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB662E9A20>]}
[0m15:04:12.066755 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:04:12.080695 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:04:12.221674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:12.222675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:12.222675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:04:12.227669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b4a07a1-a6f8-459c-9db4-fda16fafe7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB66FF4BB0>]}
[0m15:04:12.240806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b4a07a1-a6f8-459c-9db4-fda16fafe7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB66EE6440>]}
[0m15:04:12.240806 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:04:12.241908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4a07a1-a6f8-459c-9db4-fda16fafe7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB66EE6410>]}
[0m15:04:12.243814 [debug] [MainThread]: Command `dbt ls` succeeded at 15:04:12.243814 after 1.19 seconds
[0m15:04:12.244904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB634F9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB66EE5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB66EE6410>]}
[0m15:04:12.244904 [debug] [MainThread]: Flushing usage events
[0m15:07:45.135763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175196FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751C4BE230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751C4BF250>]}


============================== 15:07:45.162632 | 278a6ddb-183e-4b00-9165-4559c8fb70c2 ==============================
[0m15:07:45.162632 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:07:45.164670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:46.210772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '278a6ddb-183e-4b00-9165-4559c8fb70c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751C4EC850>]}
[0m15:07:46.216304 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:07:46.222661 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:07:46.232650 [debug] [MainThread]: Command `dbt deps` succeeded at 15:07:46.231673 after 1.48 seconds
[0m15:07:46.234664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175196FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751C4BFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001751C4BE710>]}
[0m15:07:46.236668 [debug] [MainThread]: Flushing usage events
[0m15:07:58.090754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DED89E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E1B52EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E1B51330>]}


============================== 15:07:58.107192 | effcad10-65f4-4095-b76c-1d347253eef6 ==============================
[0m15:07:58.107192 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:07:58.109187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:01.795680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E23C2470>]}
[0m15:08:02.763943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E1B0DE10>]}
[0m15:08:02.768955 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:08:02.831706 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:08:03.345954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:03.347922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:03.349961 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:03.370395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E28809D0>]}
[0m15:08:03.421704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E28521A0>]}
[0m15:08:03.423723 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:08:03.427750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E2852290>]}
[0m15:08:03.434020 [info ] [MainThread]: 
[0m15:08:03.437060 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:03.445000 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:03.521000 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:03.523563 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:03.529863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:03.557607 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:03.566765 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:06.121617 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m15:08:06.130876 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:06.137885 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:06.168742 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:06.174716 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:06.177625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:06.178604 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:06.180675 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:06.480410 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:06.481442 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:06.483426 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:06.580064 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:06.598343 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:06.648949 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:06.846809 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:06.847809 [debug] [MainThread]: On master: BEGIN
[0m15:08:06.848812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:06.850510 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:06.852428 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:07.187440 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:07.191615 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:07.195153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:07.329772 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:07.345642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E2AE0A30>]}
[0m15:08:07.348646 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:07.402721 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:07.404702 [debug] [MainThread]: On master: BEGIN
[0m15:08:07.428457 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:07.429993 [debug] [MainThread]: On master: COMMIT
[0m15:08:07.432171 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:07.432568 [debug] [MainThread]: On master: COMMIT
[0m15:08:07.472769 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:07.478206 [debug] [MainThread]: On master: Close
[0m15:08:07.481807 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:07.482806 [info ] [MainThread]: 
[0m15:08:07.534886 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m15:08:07.536867 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m15:08:07.541415 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m15:08:07.545429 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m15:08:07.563600 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m15:08:07.572513 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 15:08:07.547430 => 15:08:07.568397
[0m15:08:07.577651 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m15:08:07.917650 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:07.918654 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp150807716710"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m15:08:07.921755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:07.928740 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:07.931861 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:08.315642 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:08.399353 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:08.400863 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m15:08:08.444903 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:08.446918 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:08.449919 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp150807716710'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp150807716710'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp150807716710'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:08:08.663844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:08.742565 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:08.744593 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:08.928512 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:09.008705 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:09.012044 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:09.165266 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:09.247597 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m15:08:09.265597 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:09.266595 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp150807716710"
            );
[0m15:08:09.394172 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:09.395194 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:09.396236 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp150807716710"
    )
[0m15:08:09.476873 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:09.552768 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:08:09.560336 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:08:09.562034 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:08:10.018136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:10.025779 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 15:08:07.580185 => 15:08:10.022878
[0m15:08:10.029767 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m15:08:10.033333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effcad10-65f4-4095-b76c-1d347253eef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E2A7AC80>]}
[0m15:08:10.037441 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.49s]
[0m15:08:10.044986 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m15:08:10.056806 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:10.061617 [debug] [MainThread]: On master: BEGIN
[0m15:08:10.063679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:10.065794 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:10.068638 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:10.334003 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:10.335912 [debug] [MainThread]: On master: COMMIT
[0m15:08:10.336899 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:10.339005 [debug] [MainThread]: On master: COMMIT
[0m15:08:10.381424 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:10.384456 [debug] [MainThread]: On master: Close
[0m15:08:10.392697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:10.394993 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:08:10.396113 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:08:10.397111 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m15:08:10.398117 [info ] [MainThread]: 
[0m15:08:10.399719 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m15:08:10.402874 [debug] [MainThread]: Command end result
[0m15:08:10.451436 [info ] [MainThread]: 
[0m15:08:10.454423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:10.458447 [info ] [MainThread]: 
[0m15:08:10.460608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:10.465178 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:10.464155 after 12.78 seconds
[0m15:08:10.467190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DED89E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E2ABBEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164E2ABB9D0>]}
[0m15:08:10.468085 [debug] [MainThread]: Flushing usage events
[0m15:08:19.522461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF438DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF714C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF714D810>]}


============================== 15:08:19.528570 | b272d2db-17ec-42b2-8d0a-68a55fa5bee3 ==============================
[0m15:08:19.528570 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:08:19.530092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:19.756620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b272d2db-17ec-42b2-8d0a-68a55fa5bee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF714F100>]}
[0m15:08:19.757618 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:19.760142 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:19.761859 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:19.760760 after 0.34 seconds
[0m15:08:19.762277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF438DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF714F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF714FB50>]}
[0m15:08:19.762277 [debug] [MainThread]: Flushing usage events
[0m15:08:26.123518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD3A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD6856F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD68555A0>]}


============================== 15:08:26.128516 | 8cfa05f3-8f85-4c27-bcf7-f404be0ab70e ==============================
[0m15:08:26.128516 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:08:26.130041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:26.915283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD6886020>]}
[0m15:08:27.112872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD6857340>]}
[0m15:08:27.115779 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:08:27.136551 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:08:27.237172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:27.237172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:27.238172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:27.244569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD7580A60>]}
[0m15:08:27.257893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD7552230>]}
[0m15:08:27.257893 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:08:27.258870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD7552320>]}
[0m15:08:27.259869 [info ] [MainThread]: 
[0m15:08:27.260471 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:27.262543 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:27.278288 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:27.279878 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:27.279878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:27.284565 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:27.285566 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:27.987809 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:27.992241 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:27.996842 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:28.008978 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:28.010490 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:28.011504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:28.012509 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:28.012509 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:28.232737 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.233767 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:28.234771 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:28.323533 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.334474 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:28.440776 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:28.503807 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:28.504810 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.504810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:28.505810 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:28.506810 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:28.724768 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.726763 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:28.727763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:28.852497 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.857500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD77DCB20>]}
[0m15:08:28.858480 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:28.922527 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:28.923522 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.942786 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.943894 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.944885 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:28.946886 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.989123 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:28.990220 [debug] [MainThread]: On master: Close
[0m15:08:28.991964 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:28.993856 [info ] [MainThread]: 
[0m15:08:29.032771 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m15:08:29.034871 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m15:08:29.036854 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m15:08:29.037785 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m15:08:29.042697 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m15:08:29.045756 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 15:08:29.037785 => 15:08:29.044750
[0m15:08:29.047715 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m15:08:29.135825 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:29.135825 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp150829092097"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m15:08:29.136822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:29.136822 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:29.137828 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:29.469082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:29.490707 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:29.492140 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m15:08:29.537790 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:29.539779 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:29.541567 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp150829092097'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp150829092097'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp150829092097'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:08:29.744213 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:29.763778 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:29.763778 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:29.953159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:29.980752 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:29.982179 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:30.135885 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.158444 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m15:08:30.163573 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:30.164575 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp150829092097"
            );
[0m15:08:30.395741 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.396769 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:30.396769 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp150829092097"
    )
[0m15:08:30.482248 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.505594 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:08:30.505594 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:30.506596 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:08:30.890503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.894266 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 15:08:29.047715 => 15:08:30.893266
[0m15:08:30.895263 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m15:08:30.897252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cfa05f3-8f85-4c27-bcf7-f404be0ab70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD777AA70>]}
[0m15:08:30.898258 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 1.86s]
[0m15:08:30.898258 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m15:08:30.903393 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:30.904408 [debug] [MainThread]: On master: BEGIN
[0m15:08:30.904408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:30.905423 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:30.906494 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:31.117522 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.118519 [debug] [MainThread]: On master: COMMIT
[0m15:08:31.118519 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:31.120539 [debug] [MainThread]: On master: COMMIT
[0m15:08:31.156725 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.157743 [debug] [MainThread]: On master: Close
[0m15:08:31.158739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:31.158739 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:08:31.159738 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:08:31.159738 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m15:08:31.160357 [info ] [MainThread]: 
[0m15:08:31.160862 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m15:08:31.160862 [debug] [MainThread]: Command end result
[0m15:08:31.175513 [info ] [MainThread]: 
[0m15:08:31.176518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:31.176518 [info ] [MainThread]: 
[0m15:08:31.177535 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:31.178521 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:31.178521 after 5.14 seconds
[0m15:08:31.178521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD3A8DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD77BBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCD77BBA30>]}
[0m15:08:31.178521 [debug] [MainThread]: Flushing usage events
[0m15:08:37.742743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91A49DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91D25C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91D25F1C0>]}


============================== 15:08:37.748731 | c6bbd78d-e485-48ba-a199-9b6883c08b43 ==============================
[0m15:08:37.748731 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:08:37.749728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:37.997879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6bbd78d-e485-48ba-a199-9b6883c08b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91D25FAF0>]}
[0m15:08:37.999868 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:38.001403 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:38.002889 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:38.002889 after 0.35 seconds
[0m15:08:38.003870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91A49DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91D25F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C91D2C7220>]}
[0m15:08:38.003870 [debug] [MainThread]: Flushing usage events
[0m15:08:43.877118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA60ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8E6AF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8E69540>]}


============================== 15:08:43.882568 | 75cbe563-1b48-4d24-ad33-2dbc1ac8c646 ==============================
[0m15:08:43.882568 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:08:43.883558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:44.653638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA8EA60B0>]}
[0m15:08:44.848046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9942500>]}
[0m15:08:44.850040 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:08:44.865573 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:08:44.965574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:44.966558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:44.966558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:44.973683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9BA0A30>]}
[0m15:08:44.986962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9B722C0>]}
[0m15:08:44.988955 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:08:44.988955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9B72290>]}
[0m15:08:44.990631 [info ] [MainThread]: 
[0m15:08:44.991692 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:44.993797 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:45.010689 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:45.011778 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:45.011778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:45.016701 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:45.017789 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:45.668633 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:45.672964 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:45.678949 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:45.690535 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:45.690535 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:45.691546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:45.692569 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:45.692569 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:45.914695 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:45.914695 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:45.915794 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:46.012722 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:46.025396 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:46.076058 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:46.177527 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:46.178516 [debug] [MainThread]: On master: BEGIN
[0m15:08:46.178516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:46.180760 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:46.181867 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:46.515722 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:46.516719 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:46.517738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:46.668456 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:46.675560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9E00B20>]}
[0m15:08:46.676562 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:46.749972 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:46.751581 [debug] [MainThread]: On master: BEGIN
[0m15:08:46.778735 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:46.779760 [debug] [MainThread]: On master: COMMIT
[0m15:08:46.781388 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:46.782400 [debug] [MainThread]: On master: COMMIT
[0m15:08:46.826835 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:46.828837 [debug] [MainThread]: On master: Close
[0m15:08:46.830848 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:46.831856 [info ] [MainThread]: 
[0m15:08:46.857969 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m15:08:46.859997 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m15:08:46.861557 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m15:08:46.862559 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m15:08:46.871611 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m15:08:46.874626 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 15:08:46.863549 => 15:08:46.874626
[0m15:08:46.875625 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m15:08:46.958609 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:46.958609 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp150846922013"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m15:08:46.958609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:46.960121 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:46.960647 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:47.256583 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:47.286076 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:47.287084 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m15:08:47.329747 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:47.330764 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:47.331776 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp150846922013'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp150846922013'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp150846922013'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:08:47.541654 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:47.573852 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:47.574833 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:47.756435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:47.788633 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:47.789655 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:47.948794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:47.980805 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m15:08:48.047490 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:48.048487 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp150846922013"
            );
[0m15:08:48.173689 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:48.174669 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:48.176668 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp150846922013"
    )
[0m15:08:48.248375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:48.268300 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:08:48.268300 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:48.269810 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:08:48.730647 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:48.733800 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 15:08:46.876624 => 15:08:48.732681
[0m15:08:48.734800 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m15:08:48.738332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cbe563-1b48-4d24-ad33-2dbc1ac8c646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9D9ABC0>]}
[0m15:08:48.739924 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 1.88s]
[0m15:08:48.741562 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m15:08:48.747048 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:48.748058 [debug] [MainThread]: On master: BEGIN
[0m15:08:48.750059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:48.750584 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:48.752608 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:48.972684 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:48.973674 [debug] [MainThread]: On master: COMMIT
[0m15:08:48.974674 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:48.974674 [debug] [MainThread]: On master: COMMIT
[0m15:08:49.028550 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:49.030064 [debug] [MainThread]: On master: Close
[0m15:08:49.032718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:49.033748 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:08:49.033748 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:08:49.034746 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m15:08:49.035744 [info ] [MainThread]: 
[0m15:08:49.036746 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m15:08:49.038753 [debug] [MainThread]: Command end result
[0m15:08:49.073149 [info ] [MainThread]: 
[0m15:08:49.074146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:49.075621 [info ] [MainThread]: 
[0m15:08:49.076640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:49.077640 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:49.077640 after 5.29 seconds
[0m15:08:49.078638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA60ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9DDBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA9DDBB50>]}
[0m15:08:49.078638 [debug] [MainThread]: Flushing usage events
[0m15:08:55.347947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63379DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63656E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63656F250>]}


============================== 15:08:55.353475 | ff3cad2f-b392-41fe-8efd-e96359e4c8af ==============================
[0m15:08:55.353475 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:08:55.353475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:55.568165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff3cad2f-b392-41fe-8efd-e96359e4c8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6365AF700>]}
[0m15:08:55.569670 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:55.571180 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:55.572185 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:55.572185 after 0.31 seconds
[0m15:08:55.573185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63379DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63656FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63656E710>]}
[0m15:08:55.573185 [debug] [MainThread]: Flushing usage events
[0m15:09:00.980687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B193A0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1967CAF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1967C9540>]}


============================== 15:09:00.988786 | 772ba8ca-9775-4bef-a34f-b093307de6c1 ==============================
[0m15:09:00.988786 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:09:00.990810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:01.766263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1942FAEC0>]}
[0m15:09:01.960684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1967CBEB0>]}
[0m15:09:01.963233 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:09:01.980869 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:09:02.090605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:02.091675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:02.092628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:09:02.103708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B197500A30>]}
[0m15:09:02.116927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1974D6200>]}
[0m15:09:02.116927 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:09:02.117928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1974D62F0>]}
[0m15:09:02.118927 [info ] [MainThread]: 
[0m15:09:02.119927 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:09:02.122526 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:09:02.138332 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:09:02.138332 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:09:02.138332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:02.146801 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:02.147816 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:02.807677 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:09:02.810747 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:09:02.815892 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:09:02.830504 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:09:02.832219 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:09:02.832746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:02.833781 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:02.834795 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:03.070034 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.071579 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:09:03.073591 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:09:03.161432 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.168328 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:09:03.212605 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:09:03.262657 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:03.262657 [debug] [MainThread]: On master: BEGIN
[0m15:09:03.262657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:03.263749 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:03.263749 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:03.475919 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.478005 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:03.478996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:09:03.603285 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.611530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B197760AC0>]}
[0m15:09:03.612533 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:03.664547 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:03.665577 [debug] [MainThread]: On master: BEGIN
[0m15:09:03.686031 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.687111 [debug] [MainThread]: On master: COMMIT
[0m15:09:03.688110 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:03.689159 [debug] [MainThread]: On master: COMMIT
[0m15:09:03.732875 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:03.733808 [debug] [MainThread]: On master: Close
[0m15:09:03.737825 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:09:03.739824 [info ] [MainThread]: 
[0m15:09:03.774004 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m15:09:03.774979 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m15:09:03.775979 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m15:09:03.776978 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m15:09:03.779980 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m15:09:03.783497 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 15:09:03.776978 => 15:09:03.782501
[0m15:09:03.784497 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m15:09:03.860808 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:03.862363 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp150903816661"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m15:09:03.862363 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:03.863374 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:03.863374 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:04.189723 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:04.208258 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:04.209764 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m15:09:04.248642 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:04.248642 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:04.250878 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp150903816661'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp150903816661'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp150903816661'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:09:04.465599 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:04.492656 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:04.493659 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:09:04.688553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:04.712832 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:04.712832 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:09:04.867979 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:04.895530 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m15:09:04.900602 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:04.901618 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp150903816661"
            );
[0m15:09:05.034600 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:05.034600 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:05.035696 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp150903816661"
    )
[0m15:09:05.318328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:05.340755 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:09:05.342113 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:05.342113 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:09:06.242867 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:09:06.245895 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 15:09:03.784497 => 15:09:06.244898
[0m15:09:06.246891 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m15:09:06.247892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772ba8ca-9775-4bef-a34f-b093307de6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1976FE9E0>]}
[0m15:09:06.248905 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 2.47s]
[0m15:09:06.250398 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m15:09:06.254527 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:06.255407 [debug] [MainThread]: On master: BEGIN
[0m15:09:06.256509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:06.257498 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:06.258497 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:06.519997 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:06.521688 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.522820 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:06.524800 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.566851 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:06.568849 [debug] [MainThread]: On master: Close
[0m15:09:06.572414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:06.573412 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:09:06.574411 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:09:06.574411 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m15:09:06.575407 [info ] [MainThread]: 
[0m15:09:06.576408 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m15:09:06.577407 [debug] [MainThread]: Command end result
[0m15:09:06.589988 [info ] [MainThread]: 
[0m15:09:06.590558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:06.591518 [info ] [MainThread]: 
[0m15:09:06.591518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:06.592705 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:06.592705 after 5.71 seconds
[0m15:09:06.592705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B193A0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19710CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1974D6440>]}
[0m15:09:06.593719 [debug] [MainThread]: Flushing usage events
[0m17:36:21.624671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FB8BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FE67C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FE67D810>]}


============================== 17:36:21.634665 | 1422a164-8502-4035-a96d-a6a81e3626f2 ==============================
[0m17:36:21.634665 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:36:21.635667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:36:22.672784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1422a164-8502-4035-a96d-a6a81e3626f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FE67F100>]}
[0m17:36:22.675799 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:36:22.678777 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:36:22.684800 [debug] [MainThread]: Command `dbt deps` succeeded at 17:36:22.684800 after 1.20 seconds
[0m17:36:22.685803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FB8BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FE67F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141FE67FB50>]}
[0m17:36:22.685803 [debug] [MainThread]: Flushing usage events
[0m17:36:31.372153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE98AFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9B8C2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9B8C14E0>]}


============================== 17:36:31.378154 | af7acbda-f714-46a6-a612-91ec0e31077e ==============================
[0m17:36:31.378154 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:36:31.379154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:32.797254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af7acbda-f714-46a6-a612-91ec0e31077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9B8E3520>]}
[0m17:36:33.024280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af7acbda-f714-46a6-a612-91ec0e31077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C14C8B0>]}
[0m17:36:33.033298 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:36:33.074288 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:36:33.500075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:33.501070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:33.502068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:36:33.510588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af7acbda-f714-46a6-a612-91ec0e31077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C5F4C40>]}
[0m17:36:33.536228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af7acbda-f714-46a6-a612-91ec0e31077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C4E64D0>]}
[0m17:36:33.537229 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:36:33.538227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af7acbda-f714-46a6-a612-91ec0e31077e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C4E64A0>]}
[0m17:36:33.545228 [debug] [MainThread]: Command `dbt ls` succeeded at 17:36:33.544226 after 2.26 seconds
[0m17:36:33.546228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE98AFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C4E5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9C4E64A0>]}
[0m17:36:33.547228 [debug] [MainThread]: Flushing usage events
[0m17:38:21.609098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803BEF9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803ECBC910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803ECBCFD0>]}


============================== 17:38:21.619121 | 3bfb0805-6bc7-4ba4-9462-4c5f1b16e3ed ==============================
[0m17:38:21.619121 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:38:21.620112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:21.856416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bfb0805-6bc7-4ba4-9462-4c5f1b16e3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803ECBFAC0>]}
[0m17:38:21.857422 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:38:21.858406 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:38:21.859551 [debug] [MainThread]: Command `dbt deps` succeeded at 17:38:21.859551 after 0.35 seconds
[0m17:38:21.860651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803BEF9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803ECBC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001803ED271F0>]}
[0m17:38:21.860651 [debug] [MainThread]: Flushing usage events
[0m17:38:27.340784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD2F6FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD324C0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD324C36A0>]}


============================== 17:38:27.347828 | 75779f57-2423-45be-b9ea-d9f87e928092 ==============================
[0m17:38:27.347828 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:38:27.348830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:28.126588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75779f57-2423-45be-b9ea-d9f87e928092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD324E9060>]}
[0m17:38:28.307605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75779f57-2423-45be-b9ea-d9f87e928092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD32D6C9D0>]}
[0m17:38:28.309646 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:38:28.325515 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:38:28.458661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:28.458661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:28.459661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:38:28.465187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75779f57-2423-45be-b9ea-d9f87e928092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD331F4CA0>]}
[0m17:38:28.478186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75779f57-2423-45be-b9ea-d9f87e928092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD330E6470>]}
[0m17:38:28.478186 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:38:28.479187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75779f57-2423-45be-b9ea-d9f87e928092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD330E6560>]}
[0m17:38:28.481186 [debug] [MainThread]: Command `dbt ls` succeeded at 17:38:28.481186 after 1.22 seconds
[0m17:38:28.481186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD2F6FDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD330E5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD330E6560>]}
[0m17:38:28.482187 [debug] [MainThread]: Flushing usage events
[0m17:40:44.506943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F0A5DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F382C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F382D810>]}


============================== 17:40:44.514957 | f42a3521-4a51-4d95-91de-ff4a0d9a036b ==============================
[0m17:40:44.514957 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:40:44.516050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:40:44.782464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42a3521-4a51-4d95-91de-ff4a0d9a036b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F382F100>]}
[0m17:40:44.783464 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:40:44.785458 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:40:44.785458 [debug] [MainThread]: Command `dbt deps` succeeded at 17:40:44.785458 after 0.38 seconds
[0m17:40:44.787052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F0A5DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F382F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161F382FB50>]}
[0m17:40:44.787052 [debug] [MainThread]: Flushing usage events
[0m17:40:50.975493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832874DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832B5126B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832B510BB0>]}


============================== 17:40:50.979496 | b3de54db-597b-4191-8685-e5749e6e57ff ==============================
[0m17:40:50.979496 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:40:50.979496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:51.801408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3de54db-597b-4191-8685-e5749e6e57ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832B53B220>]}
[0m17:40:51.979463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3de54db-597b-4191-8685-e5749e6e57ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832BFECFA0>]}
[0m17:40:51.981437 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:40:51.999305 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:40:52.156319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:52.156319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:52.157331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:40:52.163323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3de54db-597b-4191-8685-e5749e6e57ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832C244C10>]}
[0m17:40:52.175245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3de54db-597b-4191-8685-e5749e6e57ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832C1364A0>]}
[0m17:40:52.176316 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:40:52.176316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3de54db-597b-4191-8685-e5749e6e57ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832C136470>]}
[0m17:40:52.178244 [debug] [MainThread]: Command `dbt ls` succeeded at 17:40:52.178244 after 1.30 seconds
[0m17:40:52.179322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832874DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832C135CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832C136470>]}
[0m17:40:52.179322 [debug] [MainThread]: Flushing usage events
[0m17:43:52.633024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE59DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE879E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE879F250>]}


============================== 17:43:52.640043 | a9064e6a-63ec-4385-b455-0811572b8e4d ==============================
[0m17:43:52.640043 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:43:52.641041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:43:52.927382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9064e6a-63ec-4385-b455-0811572b8e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE87DF700>]}
[0m17:43:52.928387 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:43:52.932296 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:43:52.934290 [debug] [MainThread]: Command `dbt deps` succeeded at 17:43:52.934290 after 0.40 seconds
[0m17:43:52.934290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE59DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE879FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AE879E710>]}
[0m17:43:52.935379 [debug] [MainThread]: Flushing usage events
[0m17:43:59.461111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5CEC3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D1A026B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D1A00BB0>]}


============================== 17:43:59.467133 | 7067d871-461f-4eb1-8903-30cc6f7dafc8 ==============================
[0m17:43:59.467133 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:43:59.467133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:00.615730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7067d871-461f-4eb1-8903-30cc6f7dafc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D1A27220>]}
[0m17:44:00.804953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7067d871-461f-4eb1-8903-30cc6f7dafc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D24DCD30>]}
[0m17:44:00.808948 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:44:00.824081 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:44:01.013600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:01.013600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:01.014694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:44:01.021605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7067d871-461f-4eb1-8903-30cc6f7dafc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D2734C10>]}
[0m17:44:01.043112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7067d871-461f-4eb1-8903-30cc6f7dafc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D26264A0>]}
[0m17:44:01.044119 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:44:01.044119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7067d871-461f-4eb1-8903-30cc6f7dafc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D2626470>]}
[0m17:44:01.048132 [debug] [MainThread]: Command `dbt ls` succeeded at 17:44:01.048132 after 1.70 seconds
[0m17:44:01.049118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5CEC3DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D2625CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D2626470>]}
[0m17:44:01.050130 [debug] [MainThread]: Flushing usage events
[0m17:48:20.128938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DCD79E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DFB3EF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DFB3CDF0>]}


============================== 17:48:20.147163 | 12246675-13d3-4bf9-97c7-a56092527bbc ==============================
[0m17:48:20.147163 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:48:20.149151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:21.113663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12246675-13d3-4bf9-97c7-a56092527bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DFB3FA90>]}
[0m17:48:21.116656 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:48:21.129146 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:48:21.136371 [debug] [MainThread]: Command `dbt deps` succeeded at 17:48:21.133854 after 1.42 seconds
[0m17:48:21.138395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DCD79E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DFB3EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4DFC22D70>]}
[0m17:48:21.145667 [debug] [MainThread]: Flushing usage events
[0m17:48:32.012742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988906DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988BE32EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988BE30790>]}


============================== 17:48:32.023747 | fa9fd40e-f150-4c04-9cc3-96bac2718e29 ==============================
[0m17:48:32.023747 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:48:32.024746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:34.151336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988BE6A830>]}
[0m17:48:34.924098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988C624910>]}
[0m17:48:34.932103 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:48:34.984898 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:48:35.472165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:35.474096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:35.478090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:48:35.505746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CB60A00>]}
[0m17:48:35.556534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CB32290>]}
[0m17:48:35.559522 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:48:35.564481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CB32260>]}
[0m17:48:35.568530 [info ] [MainThread]: 
[0m17:48:35.571681 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:48:35.579583 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:48:35.658446 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:48:35.667415 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:48:35.669417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:35.692031 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:48:35.695010 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:48:38.735830 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m17:48:38.744883 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:48:38.752842 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:48:38.784964 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:48:38.786960 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:48:38.787963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:38.788961 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:48:38.791513 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:48:39.214982 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:39.215981 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:48:39.216982 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:48:39.319061 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:39.333072 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:48:39.415711 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:48:39.588945 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:39.594554 [debug] [MainThread]: On master: BEGIN
[0m17:48:39.595574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:39.597609 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:48:39.598617 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:48:40.501290 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m17:48:40.503364 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:40.506263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:48:40.661971 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:40.669043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CDC0A60>]}
[0m17:48:40.670057 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:40.764015 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:40.766029 [debug] [MainThread]: On master: BEGIN
[0m17:48:40.801933 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:40.803938 [debug] [MainThread]: On master: COMMIT
[0m17:48:40.804990 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:40.809921 [debug] [MainThread]: On master: COMMIT
[0m17:48:40.862056 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:40.864055 [debug] [MainThread]: On master: Close
[0m17:48:40.868145 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:48:40.869156 [info ] [MainThread]: 
[0m17:48:40.934923 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m17:48:40.936917 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m17:48:40.942857 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m17:48:40.944845 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m17:48:40.959833 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m17:48:40.967826 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 17:48:40.945830 => 17:48:40.965919
[0m17:48:40.968934 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m17:48:41.277108 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:41.280046 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp174841096803"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m17:48:41.282165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:41.284175 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:48:41.286162 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:48:41.831648 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:48:41.863648 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:41.864647 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m17:48:41.909759 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:41.911764 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:41.912276 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp174841096803'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp174841096803'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp174841096803'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:48:42.115994 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:42.143013 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:42.145017 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:48:42.357905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:42.432032 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:42.435037 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:48:42.594679 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:42.671168 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m17:48:42.692800 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:42.694825 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp174841096803"
            );
[0m17:48:42.832875 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:42.834962 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:42.835955 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp174841096803"
    )
[0m17:48:42.950396 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:43.027651 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m17:48:43.030308 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:48:43.031433 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m17:48:43.552962 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:48:43.560237 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 17:48:40.969900 => 17:48:43.559178
[0m17:48:43.561173 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m17:48:43.564279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa9fd40e-f150-4c04-9cc3-96bac2718e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CD5AC80>]}
[0m17:48:43.566255 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.63s]
[0m17:48:43.569169 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m17:48:43.583206 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:43.585277 [debug] [MainThread]: On master: BEGIN
[0m17:48:43.587196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:43.591897 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:48:43.592941 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:48:43.977834 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:43.978830 [debug] [MainThread]: On master: COMMIT
[0m17:48:43.980917 [debug] [MainThread]: Using redshift connection "master"
[0m17:48:43.981905 [debug] [MainThread]: On master: COMMIT
[0m17:48:44.042820 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:48:44.043813 [debug] [MainThread]: On master: Close
[0m17:48:44.046837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:44.047835 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:48:44.048835 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:48:44.049843 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m17:48:44.051837 [info ] [MainThread]: 
[0m17:48:44.053821 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m17:48:44.059818 [debug] [MainThread]: Command end result
[0m17:48:44.112095 [info ] [MainThread]: 
[0m17:48:44.113098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:44.115195 [info ] [MainThread]: 
[0m17:48:44.117709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:48:44.126082 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:44.125067 after 12.27 seconds
[0m17:48:44.128455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988906DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988C8DA020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988CD9B7C0>]}
[0m17:48:44.130456 [debug] [MainThread]: Flushing usage events
[0m17:48:54.586442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5424ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54526C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54526D900>]}


============================== 17:48:54.592555 | 7b989e8a-cd85-4742-aac3-beda13a73364 ==============================
[0m17:48:54.592555 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:48:54.593663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:55.042997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b989e8a-cd85-4742-aac3-beda13a73364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5452A7E50>]}
[0m17:48:55.050123 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:48:55.053134 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:48:55.055139 [debug] [MainThread]: Command `dbt deps` succeeded at 17:48:55.055139 after 0.62 seconds
[0m17:48:55.056126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5424ADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54526F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F54526FB50>]}
[0m17:48:55.057157 [debug] [MainThread]: Flushing usage events
[0m17:49:03.849452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548E2CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491090220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254910923B0>]}


============================== 17:49:03.863914 | 5dbb10e0-0860-45dd-be16-36986cfae635 ==============================
[0m17:49:03.863914 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:49:03.864914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:05.594474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254910B2320>]}
[0m17:49:06.362062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549191AE90>]}
[0m17:49:06.367059 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:49:06.397347 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:49:06.783349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:06.785359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:06.791690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:49:06.811775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491DC0A90>]}
[0m17:49:06.864879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491D92350>]}
[0m17:49:06.868223 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:49:06.874281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491D923B0>]}
[0m17:49:06.879277 [info ] [MainThread]: 
[0m17:49:06.883278 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:49:06.895461 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:49:06.977948 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:49:06.979986 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:49:06.981984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:07.005958 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:07.007990 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:09.221536 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m17:49:09.226534 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:49:09.235179 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:49:09.275729 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:49:09.277731 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:49:09.279618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:09.284623 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:09.289626 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:09.737483 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:09.738480 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:49:09.740480 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:49:09.857812 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:09.874391 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:49:09.935690 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:49:10.111086 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:10.113096 [debug] [MainThread]: On master: BEGIN
[0m17:49:10.114072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:10.121077 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:10.122084 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:10.521391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:10.524388 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:10.525416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:49:10.659613 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:10.674618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025492020B50>]}
[0m17:49:10.676616 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:10.743498 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:10.745592 [debug] [MainThread]: On master: BEGIN
[0m17:49:10.786303 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:10.788297 [debug] [MainThread]: On master: COMMIT
[0m17:49:10.789297 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:10.790294 [debug] [MainThread]: On master: COMMIT
[0m17:49:10.871249 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:10.872252 [debug] [MainThread]: On master: Close
[0m17:49:10.876259 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:49:10.877291 [info ] [MainThread]: 
[0m17:49:10.922504 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m17:49:10.924603 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m17:49:10.927593 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m17:49:10.928599 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m17:49:10.943188 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m17:49:10.952088 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 17:49:10.929592 => 17:49:10.947079
[0m17:49:10.955077 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m17:49:11.259796 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:11.260796 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp174911088619"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m17:49:11.262797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:11.269987 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:11.270983 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:11.789982 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:49:11.856788 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:11.858809 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m17:49:11.906710 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:11.907717 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:11.909719 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp174911088619'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp174911088619'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp174911088619'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:49:12.159123 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:12.224149 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:12.225149 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:49:12.451291 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:12.520753 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:12.522753 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:49:12.703562 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:12.785906 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m17:49:12.799982 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:12.802017 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp174911088619"
            );
[0m17:49:12.946307 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:12.951422 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:12.953787 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp174911088619"
    )
[0m17:49:13.096921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:13.172495 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m17:49:13.175493 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:49:13.176491 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m17:49:13.654370 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:13.658356 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 17:49:10.956091 => 17:49:13.657357
[0m17:49:13.659451 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m17:49:13.665346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb10e0-0860-45dd-be16-36986cfae635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491FBACE0>]}
[0m17:49:13.669346 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 2.74s]
[0m17:49:13.672365 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m17:49:13.685350 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:13.687346 [debug] [MainThread]: On master: BEGIN
[0m17:49:13.688346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:13.690396 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:13.692374 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:14.095464 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:14.100424 [debug] [MainThread]: On master: COMMIT
[0m17:49:14.103426 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:14.105529 [debug] [MainThread]: On master: COMMIT
[0m17:49:14.147725 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:14.151697 [debug] [MainThread]: On master: Close
[0m17:49:14.155722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:14.156717 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:49:14.157716 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:49:14.158717 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m17:49:14.159716 [info ] [MainThread]: 
[0m17:49:14.161714 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m17:49:14.167695 [debug] [MainThread]: Command end result
[0m17:49:14.213714 [info ] [MainThread]: 
[0m17:49:14.218892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:14.220976 [info ] [MainThread]: 
[0m17:49:14.221987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:49:14.225990 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:14.224971 after 10.56 seconds
[0m17:49:14.226972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548E2CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254919CF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025491FFBA90>]}
[0m17:49:14.228076 [debug] [MainThread]: Flushing usage events
[0m17:49:24.508691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B30DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B5E9C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B5E9F1C0>]}


============================== 17:49:24.517693 | bb5d8b46-829d-4723-8612-7cc27fd319c9 ==============================
[0m17:49:24.517693 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:49:24.520673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:24.868482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5d8b46-829d-4723-8612-7cc27fd319c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B5E9FAF0>]}
[0m17:49:24.876477 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:24.879511 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:24.882502 [debug] [MainThread]: Command `dbt deps` succeeded at 17:49:24.882502 after 0.52 seconds
[0m17:49:24.883490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B30DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B5E9F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1B5F07220>]}
[0m17:49:24.884493 [debug] [MainThread]: Flushing usage events
[0m17:49:33.323635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB5F6DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB8D30220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB8D323B0>]}


============================== 17:49:33.335548 | 92dc71ae-9acf-49e0-9c6a-0ba87ca738ef ==============================
[0m17:49:33.335548 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:49:33.337551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:34.553628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB8D5E320>]}
[0m17:49:34.799903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB95AEE90>]}
[0m17:49:34.802784 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:49:34.820889 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:49:34.960439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:34.963458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:34.968456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:49:34.975452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9A50A90>]}
[0m17:49:35.001977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9A22350>]}
[0m17:49:35.002975 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:49:35.003980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9A223B0>]}
[0m17:49:35.005001 [info ] [MainThread]: 
[0m17:49:35.005998 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:49:35.007981 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:49:35.041997 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:49:35.043003 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:49:35.043003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:35.054998 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:35.054998 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:36.950902 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m17:49:36.955918 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:49:36.968085 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:49:36.999574 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:49:37.000576 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:49:37.001598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:37.003592 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:37.004589 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:37.541673 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:49:37.543672 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:49:37.546647 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:49:37.685028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:37.699923 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:49:37.769959 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:49:37.940923 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:37.944930 [debug] [MainThread]: On master: BEGIN
[0m17:49:37.946911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:37.948932 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:37.950997 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:38.368616 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:38.370639 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:38.371634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:49:38.513906 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:38.523965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9CB0B20>]}
[0m17:49:38.529908 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:38.800763 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:38.803763 [debug] [MainThread]: On master: BEGIN
[0m17:49:38.833779 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:38.834775 [debug] [MainThread]: On master: COMMIT
[0m17:49:38.836776 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:38.837766 [debug] [MainThread]: On master: COMMIT
[0m17:49:38.920364 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:38.921384 [debug] [MainThread]: On master: Close
[0m17:49:38.925391 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:49:38.930361 [info ] [MainThread]: 
[0m17:49:38.971078 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m17:49:38.973076 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m17:49:38.978147 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m17:49:38.980076 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m17:49:38.993860 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m17:49:39.001796 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 17:49:38.982097 => 17:49:39.000816
[0m17:49:39.002881 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m17:49:39.282969 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:39.285554 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp174939116716"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m17:49:39.286551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:39.288553 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:39.290546 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:39.845599 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:49:39.920229 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:39.921223 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m17:49:40.006079 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:40.010971 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:40.014257 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp174939116716'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp174939116716'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp174939116716'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:49:40.316654 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:40.379740 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:40.383151 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:49:40.577604 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:40.637567 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:40.639564 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:49:40.834411 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:40.916654 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m17:49:40.933026 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:40.935028 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp174939116716"
            );
[0m17:49:41.076802 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:41.080808 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:41.082809 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp174939116716"
    )
[0m17:49:41.208528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:41.278624 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m17:49:41.281619 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:49:41.282618 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m17:49:41.712496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:41.715594 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 17:49:39.003910 => 17:49:41.715594
[0m17:49:41.717612 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m17:49:41.720530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92dc71ae-9acf-49e0-9c6a-0ba87ca738ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9C4AA70>]}
[0m17:49:41.724529 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 2.75s]
[0m17:49:41.730503 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m17:49:41.740502 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:41.744496 [debug] [MainThread]: On master: BEGIN
[0m17:49:41.745498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:41.747554 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:49:41.748591 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:49:42.177974 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:42.179975 [debug] [MainThread]: On master: COMMIT
[0m17:49:42.183070 [debug] [MainThread]: Using redshift connection "master"
[0m17:49:42.185069 [debug] [MainThread]: On master: COMMIT
[0m17:49:42.339475 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:49:42.343454 [debug] [MainThread]: On master: Close
[0m17:49:42.347463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:42.349450 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:49:42.350450 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:49:42.351465 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m17:49:42.352450 [info ] [MainThread]: 
[0m17:49:42.353453 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m17:49:42.359454 [debug] [MainThread]: Command end result
[0m17:49:42.408725 [info ] [MainThread]: 
[0m17:49:42.411746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:42.413734 [info ] [MainThread]: 
[0m17:49:42.415761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:49:42.419726 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:42.418755 after 9.23 seconds
[0m17:49:42.420740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB5F6DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9C8B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9C8B760>]}
[0m17:49:42.424746 [debug] [MainThread]: Flushing usage events
[0m17:49:52.089155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E99F0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E9CCDC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E9CCDF1C0>]}


============================== 17:49:52.098169 | d36cd2ed-a701-4266-a241-e07ad66d2f41 ==============================
[0m17:49:52.098169 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:49:52.102152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:49:52.420915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd36cd2ed-a701-4266-a241-e07ad66d2f41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E9CCDFAF0>]}
[0m17:49:52.422946 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:52.424919 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:52.427015 [debug] [MainThread]: Command `dbt deps` succeeded at 17:49:52.425930 after 0.50 seconds
[0m17:49:52.427015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E99F0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E9CCDF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E9CD47220>]}
[0m17:49:52.428006 [debug] [MainThread]: Flushing usage events
[0m17:50:00.872034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB2CADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB5A76F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB5A755A0>]}


============================== 17:50:00.885381 | c3e78cda-f1c6-4b17-bae6-27cc099f7ab6 ==============================
[0m17:50:00.885381 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:50:00.885381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:50:02.126464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB5A9E020>]}
[0m17:50:02.465732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB5A77340>]}
[0m17:50:02.470827 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m17:50:02.522551 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m17:50:02.900913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:02.902913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:02.910068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:50:02.930291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB67A0A60>]}
[0m17:50:02.978289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB6772320>]}
[0m17:50:02.981289 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m17:50:02.983303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB6772380>]}
[0m17:50:02.988302 [info ] [MainThread]: 
[0m17:50:02.994299 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:50:02.999910 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:50:03.076862 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:50:03.078838 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:50:03.079937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:03.100818 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:03.101805 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:05.389272 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m17:50:05.395266 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:50:05.406808 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:50:05.441026 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:50:05.444021 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:50:05.445037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.447051 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:05.448046 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:05.901673 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:05.906246 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:50:05.908240 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:50:06.051324 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:06.073305 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:50:06.141888 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:50:06.323718 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:06.325697 [debug] [MainThread]: On master: BEGIN
[0m17:50:06.326799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:06.328792 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:06.329807 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:06.661789 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:06.663753 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:06.664766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:50:06.793563 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:06.800558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB6A00AF0>]}
[0m17:50:06.806101 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:06.860486 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:06.862572 [debug] [MainThread]: On master: BEGIN
[0m17:50:06.884579 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:06.888624 [debug] [MainThread]: On master: COMMIT
[0m17:50:06.891638 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:06.892649 [debug] [MainThread]: On master: COMMIT
[0m17:50:06.945478 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:06.947543 [debug] [MainThread]: On master: Close
[0m17:50:06.951535 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:50:06.957480 [info ] [MainThread]: 
[0m17:50:07.009593 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m17:50:07.011642 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m17:50:07.014643 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m17:50:07.015655 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m17:50:07.030571 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m17:50:07.040569 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 17:50:07.016647 => 17:50:07.039553
[0m17:50:07.042570 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m17:50:07.360674 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:07.362759 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp175007185296"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m17:50:07.363760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:07.365762 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:07.366762 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:07.795231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:07.864997 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:07.866001 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m17:50:07.930785 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:07.932871 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:07.935790 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp175007185296'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp175007185296'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp175007185296'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:50:08.192000 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:08.256946 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:08.258947 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:50:08.443293 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:08.516428 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:08.521414 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:50:08.680064 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:08.757872 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m17:50:08.774775 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:08.776793 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp175007185296"
            );
[0m17:50:08.930377 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:08.932367 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:08.934374 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp175007185296"
    )
[0m17:50:09.221091 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:09.289668 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m17:50:09.292730 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:50:09.293730 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m17:50:10.255042 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:50:10.258125 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 17:50:07.043569 => 17:50:10.258125
[0m17:50:10.260125 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m17:50:10.263128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3e78cda-f1c6-4b17-bae6-27cc099f7ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB699AA40>]}
[0m17:50:10.265127 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 3.25s]
[0m17:50:10.271370 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m17:50:10.279348 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:10.280349 [debug] [MainThread]: On master: BEGIN
[0m17:50:10.283588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:10.287577 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:50:10.288574 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:50:10.675138 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:10.677168 [debug] [MainThread]: On master: COMMIT
[0m17:50:10.679134 [debug] [MainThread]: Using redshift connection "master"
[0m17:50:10.681130 [debug] [MainThread]: On master: COMMIT
[0m17:50:10.726941 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:50:10.728927 [debug] [MainThread]: On master: Close
[0m17:50:10.736930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:10.738929 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:50:10.739925 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:50:10.741935 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m17:50:10.743019 [info ] [MainThread]: 
[0m17:50:10.744028 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m17:50:10.747936 [debug] [MainThread]: Command end result
[0m17:50:10.792499 [info ] [MainThread]: 
[0m17:50:10.795521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:10.796515 [info ] [MainThread]: 
[0m17:50:10.797519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:10.812047 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:10.811053 after 10.09 seconds
[0m17:50:10.813051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB2CADDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB631D240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FCB6771EA0>]}
[0m17:50:10.814046 [debug] [MainThread]: Flushing usage events
[0m14:21:30.704384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B0C2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B39EC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B39ED810>]}


============================== 14:21:30.711346 | 57ff354f-09ac-4a8a-ac6b-5b5273bf61a1 ==============================
[0m14:21:30.711346 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:21:30.711346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:30.986245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ff354f-09ac-4a8a-ac6b-5b5273bf61a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B39EF100>]}
[0m14:21:30.987247 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:21:30.989247 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:21:30.990247 [debug] [MainThread]: Command `dbt deps` succeeded at 14:21:30.990247 after 0.38 seconds
[0m14:21:30.991247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B0C2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B39EF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B39EFB50>]}
[0m14:21:30.991247 [debug] [MainThread]: Flushing usage events
[0m14:21:37.474154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022410BA9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224139734F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224139702B0>]}


============================== 14:21:37.479245 | a9b518d2-b054-4475-9bdb-ea3e596800e3 ==============================
[0m14:21:37.479245 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:21:37.479245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:38.084990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9b518d2-b054-4475-9bdb-ea3e596800e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002240FC52BF0>]}
[0m14:21:38.224036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9b518d2-b054-4475-9bdb-ea3e596800e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241444F400>]}
[0m14:21:38.225706 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:21:38.245049 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:21:39.425659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:39.426666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:39.427670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:21:39.432661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9b518d2-b054-4475-9bdb-ea3e596800e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224146A4B80>]}
[0m14:21:39.459396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9b518d2-b054-4475-9bdb-ea3e596800e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022414596410>]}
[0m14:21:39.460413 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:21:39.460413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9b518d2-b054-4475-9bdb-ea3e596800e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224145963E0>]}
[0m14:21:39.463419 [debug] [MainThread]: Command `dbt ls` succeeded at 14:21:39.463419 after 2.06 seconds
[0m14:21:39.463419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022410BA9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022414595C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224145963E0>]}
[0m14:21:39.464415 [debug] [MainThread]: Flushing usage events
[0m14:30:50.379263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216ECD0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EFACC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EFACF1C0>]}


============================== 14:30:50.386992 | 0c84c2cc-e4c1-4241-9cd4-7cf7ac86caa5 ==============================
[0m14:30:50.386992 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:30:50.386992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:50.588611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c84c2cc-e4c1-4241-9cd4-7cf7ac86caa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EFACFAF0>]}
[0m14:30:50.589610 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:30:50.591529 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:30:50.592613 [debug] [MainThread]: Command `dbt deps` succeeded at 14:30:50.592613 after 0.29 seconds
[0m14:30:50.592613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216ECD0DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EFACF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216EFB37220>]}
[0m14:30:50.592613 [debug] [MainThread]: Flushing usage events
[0m14:30:56.732659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A85D2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A88AF26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A88AF0BB0>]}


============================== 14:30:56.737657 | bcc2406b-8445-49f8-9f2c-b45ade891ed3 ==============================
[0m14:30:56.737657 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:30:56.737657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:30:57.373374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcc2406b-8445-49f8-9f2c-b45ade891ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A88B1B220>]}
[0m14:30:57.528756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcc2406b-8445-49f8-9f2c-b45ade891ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A895CCD30>]}
[0m14:30:57.530680 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:30:57.542724 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:30:57.644788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:57.645795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:57.645795 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:30:57.650809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcc2406b-8445-49f8-9f2c-b45ade891ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A89824C10>]}
[0m14:30:57.660911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcc2406b-8445-49f8-9f2c-b45ade891ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A896B24A0>]}
[0m14:30:57.661920 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:30:57.662918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc2406b-8445-49f8-9f2c-b45ade891ed3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A896B2470>]}
[0m14:30:57.664918 [debug] [MainThread]: Command `dbt ls` succeeded at 14:30:57.664918 after 1.01 seconds
[0m14:30:57.665919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A85D2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A896B1CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A896B2470>]}
[0m14:30:57.665919 [debug] [MainThread]: Flushing usage events
[0m14:37:52.191422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D242DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D51EC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D51EF1C0>]}


============================== 14:37:52.199377 | 8745f878-d4fa-4289-98ca-3d15289238e2 ==============================
[0m14:37:52.199377 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:37:52.200329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:52.436896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8745f878-d4fa-4289-98ca-3d15289238e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D51EFAF0>]}
[0m14:37:52.440899 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:37:52.442898 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:37:52.443900 [debug] [MainThread]: Command `dbt deps` succeeded at 14:37:52.443900 after 0.35 seconds
[0m14:37:52.444899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D242DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D51EF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D5257220>]}
[0m14:37:52.444899 [debug] [MainThread]: Flushing usage events
[0m14:37:58.596833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E49DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01446F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB014455A0>]}


============================== 14:37:58.605561 | eaee3237-e193-4d04-b7c3-a05b5aa276bf ==============================
[0m14:37:58.605561 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:37:58.605561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:59.523200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01476020>]}
[0m14:37:59.691799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01447340>]}
[0m14:37:59.693840 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:37:59.710581 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:37:59.843245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:59.844244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:59.845271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:37:59.853324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB02150A60>]}
[0m14:37:59.868246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB02122320>]}
[0m14:37:59.869252 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:37:59.869252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB02122380>]}
[0m14:37:59.870243 [info ] [MainThread]: 
[0m14:37:59.871244 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:37:59.873663 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:37:59.890669 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:37:59.890669 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:37:59.891672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:59.901669 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:37:59.902672 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:00.743501 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:38:00.746448 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:38:00.752481 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:38:00.759545 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:00.761444 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:38:00.761444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:00.762445 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:00.763442 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:01.068731 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.069689 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:01.069689 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:38:01.179284 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.185361 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:38:01.250437 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:38:01.289501 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:01.290496 [debug] [MainThread]: On master: BEGIN
[0m14:38:01.290496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:01.290496 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:01.291600 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:01.667671 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.668772 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:01.668772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:38:01.814524 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.819623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB023B0B50>]}
[0m14:38:01.819623 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:01.881710 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:01.882711 [debug] [MainThread]: On master: BEGIN
[0m14:38:01.907583 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.908091 [debug] [MainThread]: On master: COMMIT
[0m14:38:01.909100 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:01.909100 [debug] [MainThread]: On master: COMMIT
[0m14:38:01.957517 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:01.957517 [debug] [MainThread]: On master: Close
[0m14:38:01.959515 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:38:01.960516 [info ] [MainThread]: 
[0m14:38:01.983416 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m14:38:01.983416 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m14:38:01.984435 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m14:38:01.984435 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m14:38:01.987436 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m14:38:01.990336 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 14:38:01.985442 => 14:38:01.989250
[0m14:38:01.990336 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m14:38:02.065875 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:02.066955 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp143802022877"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m14:38:02.066955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:02.067960 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:02.067960 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:02.462091 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:02.484083 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:02.484083 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m14:38:02.537140 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:02.538000 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:02.538998 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp143802022877'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp143802022877'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp143802022877'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:38:02.758908 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:02.790113 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:02.791115 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:02.983394 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:03.021136 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:03.023133 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:03.181263 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:03.217962 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m14:38:03.226851 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:03.227873 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp143802022877"
            );
[0m14:38:03.353086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:03.354100 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:03.355097 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "provider_id", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp143802022877"
    )
[0m14:38:03.443611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:03.472689 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m14:38:03.473689 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:38:03.474609 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m14:38:03.873911 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:03.876923 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 14:38:01.991435 => 14:38:03.875908
[0m14:38:03.876923 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m14:38:03.880914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaee3237-e193-4d04-b7c3-a05b5aa276bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0234A980>]}
[0m14:38:03.882911 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 1.90s]
[0m14:38:03.886200 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m14:38:03.891092 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:03.892085 [debug] [MainThread]: On master: BEGIN
[0m14:38:03.893086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:03.893086 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:03.894114 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:04.244711 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:04.247707 [debug] [MainThread]: On master: COMMIT
[0m14:38:04.248804 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:04.249774 [debug] [MainThread]: On master: COMMIT
[0m14:38:04.298843 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:04.299891 [debug] [MainThread]: On master: Close
[0m14:38:04.301887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:04.301887 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:38:04.302875 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:38:04.303873 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m14:38:04.304870 [info ] [MainThread]: 
[0m14:38:04.305834 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m14:38:04.306798 [debug] [MainThread]: Command end result
[0m14:38:04.333329 [info ] [MainThread]: 
[0m14:38:04.333329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:04.334429 [info ] [MainThread]: 
[0m14:38:04.334429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:04.336427 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:04.336427 after 5.83 seconds
[0m14:38:04.337440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E49DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01CCE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0238B9A0>]}
[0m14:38:04.338424 [debug] [MainThread]: Flushing usage events
[0m14:38:10.868265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019446A89E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944984EF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944984CDF0>]}


============================== 14:38:10.880193 | ee88669d-c374-4890-abee-dbb2ce0c2895 ==============================
[0m14:38:10.880193 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:38:10.880193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:11.261812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee88669d-c374-4890-abee-dbb2ce0c2895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944984FA90>]}
[0m14:38:11.262815 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:11.263812 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:11.265808 [debug] [MainThread]: Command `dbt deps` succeeded at 14:38:11.264792 after 0.52 seconds
[0m14:38:11.265808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019446A89E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944984EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944992ED70>]}
[0m14:38:11.265808 [debug] [MainThread]: Flushing usage events
[0m14:38:17.266000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5ED5DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F03B6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F03B55A0>]}


============================== 14:38:17.273086 | cc6a0301-35a2-4b0b-8df8-830fe7f823ac ==============================
[0m14:38:17.273086 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:38:17.274069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:18.144023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F03E6020>]}
[0m14:38:18.317965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F03B7340>]}
[0m14:38:18.320010 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:38:18.333520 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:38:18.418622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:18.419625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:18.419625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:38:18.424629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F10E0A60>]}
[0m14:38:18.441339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F10B2230>]}
[0m14:38:18.442417 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:38:18.442417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F10B2320>]}
[0m14:38:18.443423 [info ] [MainThread]: 
[0m14:38:18.444435 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:38:18.447339 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:38:18.469348 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:38:18.469348 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:38:18.470341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:18.475393 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:18.476344 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:19.117233 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:38:19.119231 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:38:19.121345 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:38:19.128338 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:19.129237 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:38:19.130239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:19.132236 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:19.138889 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:19.424089 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:19.425110 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:19.426107 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:38:19.538622 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:19.543621 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:38:19.635090 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:38:19.674105 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:19.674105 [debug] [MainThread]: On master: BEGIN
[0m14:38:19.675098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:19.675098 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:19.676097 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:19.950108 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:19.951189 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:19.951189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:38:20.096460 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:20.101437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F1340AC0>]}
[0m14:38:20.102456 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:20.166854 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:20.166854 [debug] [MainThread]: On master: BEGIN
[0m14:38:20.192518 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:20.192518 [debug] [MainThread]: On master: COMMIT
[0m14:38:20.193529 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:20.193529 [debug] [MainThread]: On master: COMMIT
[0m14:38:20.245805 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:20.246834 [debug] [MainThread]: On master: Close
[0m14:38:20.249820 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:38:20.250801 [info ] [MainThread]: 
[0m14:38:20.259798 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m14:38:20.260800 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m14:38:20.265812 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m14:38:20.266803 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m14:38:20.269816 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m14:38:20.272799 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 14:38:20.266803 => 14:38:20.272799
[0m14:38:20.273807 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m14:38:20.355641 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:20.355641 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp143820305885"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m14:38:20.356633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:20.356633 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:20.357663 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:20.705830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:20.728293 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:20.731282 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m14:38:20.786875 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:20.787929 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:20.787929 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp143820305885'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp143820305885'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp143820305885'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:38:21.008988 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:21.035048 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:21.036076 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:21.232237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:21.262183 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:21.265185 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:21.426105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:21.453831 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m14:38:21.458755 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:21.458755 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp143820305885"
            );
[0m14:38:21.574620 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:21.576620 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:21.577673 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp143820305885"
    )
[0m14:38:21.731885 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:21.764712 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m14:38:21.765628 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:38:21.766626 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m14:38:22.181234 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:22.184228 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 14:38:20.273807 => 14:38:22.184228
[0m14:38:22.186225 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m14:38:22.189201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6a0301-35a2-4b0b-8df8-830fe7f823ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F12DABC0>]}
[0m14:38:22.190221 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 1.93s]
[0m14:38:22.191156 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m14:38:22.198839 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:22.199859 [debug] [MainThread]: On master: BEGIN
[0m14:38:22.200860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:22.201856 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:22.202740 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:22.447071 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:22.448069 [debug] [MainThread]: On master: COMMIT
[0m14:38:22.450070 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:22.451125 [debug] [MainThread]: On master: COMMIT
[0m14:38:22.498197 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:22.498197 [debug] [MainThread]: On master: Close
[0m14:38:22.500301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:22.501323 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:38:22.502279 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:38:22.502279 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m14:38:22.503295 [info ] [MainThread]: 
[0m14:38:22.504278 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m14:38:22.506280 [debug] [MainThread]: Command end result
[0m14:38:22.526200 [info ] [MainThread]: 
[0m14:38:22.527201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:22.529273 [info ] [MainThread]: 
[0m14:38:22.530311 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:22.532296 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:22.532296 after 5.36 seconds
[0m14:38:22.532296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5ED5DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F131BA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5F131BBE0>]}
[0m14:38:22.533292 [debug] [MainThread]: Flushing usage events
[0m14:38:31.311271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E66DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202142E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202142F250>]}


============================== 14:38:31.316269 | 66034ed0-28b9-4592-9136-cb5d2c2829cb ==============================
[0m14:38:31.316269 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:38:31.316269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:31.543341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66034ed0-28b9-4592-9136-cb5d2c2829cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022021467700>]}
[0m14:38:31.544331 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:31.545330 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:31.547336 [debug] [MainThread]: Command `dbt deps` succeeded at 14:38:31.546250 after 0.33 seconds
[0m14:38:31.547336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E66DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202142FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202142E710>]}
[0m14:38:31.547336 [debug] [MainThread]: Flushing usage events
[0m14:38:37.310827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820D9DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821079AF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018210799540>]}


============================== 14:38:37.319829 | faceae7b-7259-4f2e-ab3c-e3c587856ed0 ==============================
[0m14:38:37.319829 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:38:37.320848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:38:38.116281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182107D60B0>]}
[0m14:38:38.291093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018211276500>]}
[0m14:38:38.292779 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:38:38.308101 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:38:38.406226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:38.407308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:38.407308 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:38:38.414235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182114D0A30>]}
[0m14:38:38.427228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182114A22C0>]}
[0m14:38:38.428227 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:38:38.428227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182114A2290>]}
[0m14:38:38.430254 [info ] [MainThread]: 
[0m14:38:38.433315 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:38:38.436044 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:38:38.453339 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:38:38.454341 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:38:38.454341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:38.459341 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:38.460342 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:39.226411 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:38:39.229401 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:38:39.235440 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:38:39.242396 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:39.243396 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:38:39.243396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:39.243396 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:39.244396 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:39.512139 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:39.513211 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:38:39.514132 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:38:39.623351 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:39.627360 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:38:39.688641 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:38:39.724724 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:39.724724 [debug] [MainThread]: On master: BEGIN
[0m14:38:39.725731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:39.725731 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:39.725731 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:39.989503 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:39.989503 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:39.989503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:38:40.122298 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:40.126341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018211730A30>]}
[0m14:38:40.127347 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:40.194874 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:40.195868 [debug] [MainThread]: On master: BEGIN
[0m14:38:40.223215 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:40.224221 [debug] [MainThread]: On master: COMMIT
[0m14:38:40.224221 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:40.225220 [debug] [MainThread]: On master: COMMIT
[0m14:38:40.275906 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:40.276857 [debug] [MainThread]: On master: Close
[0m14:38:40.278782 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:38:40.282783 [info ] [MainThread]: 
[0m14:38:40.299820 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m14:38:40.300822 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m14:38:40.301822 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m14:38:40.301822 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m14:38:40.304821 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m14:38:40.307826 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 14:38:40.301822 => 14:38:40.306907
[0m14:38:40.307826 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m14:38:40.387971 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:40.387971 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp143840340902"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m14:38:40.387971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:40.388976 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:40.388976 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:46.307264 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m14:38:46.340496 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:46.341481 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m14:38:46.395892 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:46.396887 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:46.398886 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp143840340902'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp143840340902'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp143840340902'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:38:46.618716 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:46.655699 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:46.657618 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:46.850881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:46.885851 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:46.886860 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:38:47.045328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:47.084116 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m14:38:47.092473 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:47.094329 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp143840340902"
            );
[0m14:38:47.239031 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:47.240340 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:47.242376 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp143840340902"
    )
[0m14:38:48.529452 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m14:38:48.564126 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m14:38:48.565126 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:38:48.566126 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m14:38:49.026670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:49.029786 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 14:38:40.308822 => 14:38:49.028784
[0m14:38:49.030783 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m14:38:49.032787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faceae7b-7259-4f2e-ab3c-e3c587856ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182116CA860>]}
[0m14:38:49.034784 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 8.73s]
[0m14:38:49.036763 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m14:38:49.044287 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:49.045341 [debug] [MainThread]: On master: BEGIN
[0m14:38:49.046356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:49.047355 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:38:49.048238 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:38:49.334461 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:49.335377 [debug] [MainThread]: On master: COMMIT
[0m14:38:49.336378 [debug] [MainThread]: Using redshift connection "master"
[0m14:38:49.337381 [debug] [MainThread]: On master: COMMIT
[0m14:38:49.388540 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:38:49.388540 [debug] [MainThread]: On master: Close
[0m14:38:49.393542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:49.394544 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:38:49.394544 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:38:49.394544 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m14:38:49.395551 [info ] [MainThread]: 
[0m14:38:49.395551 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.96 seconds (10.96s).
[0m14:38:49.396542 [debug] [MainThread]: Command end result
[0m14:38:49.420541 [info ] [MainThread]: 
[0m14:38:49.421608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:49.422546 [info ] [MainThread]: 
[0m14:38:49.425551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:49.428543 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:49.428543 after 12.20 seconds
[0m14:38:49.428543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820D9DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821170BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821170B8B0>]}
[0m14:38:49.429632 [debug] [MainThread]: Flushing usage events
[0m14:38:56.569996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6407DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD66E3E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD66E3F250>]}


============================== 14:38:56.574977 | 3502a163-b411-43af-9b02-ca82db8262f3 ==============================
[0m14:38:56.574977 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:38:56.575996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:38:56.805844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3502a163-b411-43af-9b02-ca82db8262f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD66E7F700>]}
[0m14:38:56.806851 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:56.807765 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:56.808799 [debug] [MainThread]: Command `dbt deps` succeeded at 14:38:56.808799 after 0.33 seconds
[0m14:38:56.808799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD6407DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD66E3FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD66E3E710>]}
[0m14:38:56.809842 [debug] [MainThread]: Flushing usage events
[0m14:39:02.600977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC2BFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC59C6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC59C55A0>]}


============================== 14:39:02.605580 | bf8e4160-789e-49ff-8845-216143fb025a ==============================
[0m14:39:02.605580 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:39:02.605580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:39:03.432626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC59F6020>]}
[0m14:39:03.607088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC59C7340>]}
[0m14:39:03.610127 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m14:39:03.624093 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m14:39:03.720321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:03.721324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:03.721324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:39:03.730322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC66E0A60>]}
[0m14:39:03.740240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC66B2320>]}
[0m14:39:03.740240 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m14:39:03.741327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC66B2380>]}
[0m14:39:03.746250 [info ] [MainThread]: 
[0m14:39:03.748239 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:39:03.750241 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:39:03.768325 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:39:03.768325 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:39:03.769333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:03.773319 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:03.774321 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:04.471051 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:39:04.473054 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:39:04.478076 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:39:04.487126 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:39:04.487126 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:39:04.487126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:04.488046 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:04.488046 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:04.744178 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:04.747149 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:39:04.748146 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:39:04.851119 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:04.855127 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:39:04.915170 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:39:04.961168 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:04.963210 [debug] [MainThread]: On master: BEGIN
[0m14:39:04.963210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:04.964165 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:04.964165 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:05.232531 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:05.232531 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:05.233569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:39:05.372554 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:05.377535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC6940A90>]}
[0m14:39:05.379609 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:05.446224 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:05.447306 [debug] [MainThread]: On master: BEGIN
[0m14:39:05.472658 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:05.473670 [debug] [MainThread]: On master: COMMIT
[0m14:39:05.474662 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:05.479232 [debug] [MainThread]: On master: COMMIT
[0m14:39:05.529004 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:05.530002 [debug] [MainThread]: On master: Close
[0m14:39:05.530999 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:39:05.531999 [info ] [MainThread]: 
[0m14:39:05.549085 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m14:39:05.550105 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m14:39:05.551105 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m14:39:05.551105 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m14:39:05.555087 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m14:39:05.561093 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 14:39:05.552104 => 14:39:05.559103
[0m14:39:05.563153 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m14:39:05.635839 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:05.635839 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp143905593103"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m14:39:05.636843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:05.636843 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:05.637848 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:12.545986 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m14:39:12.582073 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:12.582996 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m14:39:12.633083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:12.635100 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:12.637097 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp143905593103'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp143905593103'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp143905593103'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m14:39:12.860108 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:12.891252 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:12.892288 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:39:13.089781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:13.129427 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:13.131315 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m14:39:13.292486 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:13.340066 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m14:39:13.349312 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:13.351216 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp143905593103"
            );
[0m14:39:13.629144 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:13.630251 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:13.632245 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp143905593103"
    )
[0m14:39:15.819981 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m14:39:15.854970 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m14:39:15.856029 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:39:15.857027 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m14:39:16.333810 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:16.341813 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 14:39:05.563153 => 14:39:16.341813
[0m14:39:16.342817 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m14:39:16.344813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf8e4160-789e-49ff-8845-216143fb025a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC68DAB00>]}
[0m14:39:16.345814 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 10.79s]
[0m14:39:16.346813 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m14:39:16.353132 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:16.355072 [debug] [MainThread]: On master: BEGIN
[0m14:39:16.356072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:16.357134 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:39:16.357134 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:39:16.610739 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:16.611760 [debug] [MainThread]: On master: COMMIT
[0m14:39:16.611760 [debug] [MainThread]: Using redshift connection "master"
[0m14:39:16.612756 [debug] [MainThread]: On master: COMMIT
[0m14:39:16.665767 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:39:16.667684 [debug] [MainThread]: On master: Close
[0m14:39:16.670719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:16.672769 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:39:16.673759 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:39:16.674752 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m14:39:16.675752 [info ] [MainThread]: 
[0m14:39:16.676747 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m14:39:16.678762 [debug] [MainThread]: Command end result
[0m14:39:16.704761 [info ] [MainThread]: 
[0m14:39:16.706753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:16.707772 [info ] [MainThread]: 
[0m14:39:16.708773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:16.711768 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:16.711768 after 14.20 seconds
[0m14:39:16.713748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC2BFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC625E2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EC66B0CD0>]}
[0m14:39:16.714754 [debug] [MainThread]: Flushing usage events
[0m15:35:07.591685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C111DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C3EDC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C3EDD810>]}


============================== 15:35:07.600243 | 79617704-c985-4e03-a41e-73f0095cb7a0 ==============================
[0m15:35:07.600243 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:35:07.601251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:35:07.877093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79617704-c985-4e03-a41e-73f0095cb7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C3EDF100>]}
[0m15:35:07.879094 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:35:07.881105 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:35:07.882119 [debug] [MainThread]: Command `dbt deps` succeeded at 15:35:07.882119 after 0.36 seconds
[0m15:35:07.882119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C111DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C3EDF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C3EDFB50>]}
[0m15:35:07.883104 [debug] [MainThread]: Flushing usage events
[0m15:35:14.016000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D70DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D9EA0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D9EA3670>]}


============================== 15:35:14.021090 | 866df4c3-4b2f-40be-a217-554cd3587cef ==============================
[0m15:35:14.021090 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:35:14.021090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:35:14.631106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '866df4c3-4b2f-40be-a217-554cd3587cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D9EC5360>]}
[0m15:35:14.764884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '866df4c3-4b2f-40be-a217-554cd3587cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D9EA16F0>]}
[0m15:35:14.766791 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m15:35:14.776887 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m15:35:14.913835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:14.914837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:14.914837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:35:14.920837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '866df4c3-4b2f-40be-a217-554cd3587cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DABD4C70>]}
[0m15:35:14.931466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '866df4c3-4b2f-40be-a217-554cd3587cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DAAC6440>]}
[0m15:35:14.932553 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:35:14.932553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '866df4c3-4b2f-40be-a217-554cd3587cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DAAC6530>]}
[0m15:35:14.934467 [debug] [MainThread]: Command `dbt ls` succeeded at 15:35:14.934467 after 0.99 seconds
[0m15:35:14.935559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D70DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DAAC5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200DAAC6530>]}
[0m15:35:14.935559 [debug] [MainThread]: Flushing usage events
[0m16:07:00.493937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A814C9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8425C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8425CFD0>]}


============================== 16:07:00.500936 | bc871fb7-d305-439e-83f1-3232f64ac890 ==============================
[0m16:07:00.500936 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:07:00.502021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:07:00.740212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc871fb7-d305-439e-83f1-3232f64ac890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8425FAC0>]}
[0m16:07:00.741214 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:00.743214 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:00.744213 [debug] [MainThread]: Command `dbt deps` succeeded at 16:07:00.744213 after 0.33 seconds
[0m16:07:00.745213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A814C9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A8425C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A842C71F0>]}
[0m16:07:00.745213 [debug] [MainThread]: Flushing usage events
[0m16:07:07.899146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143AEA2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B17F0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B17F3670>]}


============================== 16:07:07.904145 | 8be6f929-2b22-4b02-914d-6a790fadeb1f ==============================
[0m16:07:07.904145 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:07:07.905146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:08.566972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8be6f929-2b22-4b02-914d-6a790fadeb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B1819360>]}
[0m16:07:08.708285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8be6f929-2b22-4b02-914d-6a790fadeb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B17F16F0>]}
[0m16:07:08.709648 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m16:07:08.721657 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m16:07:08.839117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:08.840116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:08.840116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m16:07:08.846124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be6f929-2b22-4b02-914d-6a790fadeb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B2524C70>]}
[0m16:07:08.857176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be6f929-2b22-4b02-914d-6a790fadeb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B2422440>]}
[0m16:07:08.858272 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m16:07:08.858272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be6f929-2b22-4b02-914d-6a790fadeb1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B2422530>]}
[0m16:07:08.861281 [debug] [MainThread]: Command `dbt ls` succeeded at 16:07:08.861281 after 1.03 seconds
[0m16:07:08.861281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143AEA2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B2421D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143B2422530>]}
[0m16:07:08.862275 [debug] [MainThread]: Flushing usage events
[0m16:15:27.718754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A13BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A417C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A417D870>]}


============================== 16:15:27.729150 | 9a13c356-59bc-46f0-881d-64b9dd15deb7 ==============================
[0m16:15:27.729150 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:15:27.729150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:15:27.920298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a13c356-59bc-46f0-881d-64b9dd15deb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A41BF340>]}
[0m16:15:27.921311 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:15:27.923318 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:15:27.924364 [debug] [MainThread]: Command `dbt deps` succeeded at 16:15:27.924364 after 0.29 seconds
[0m16:15:27.925321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A13BDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A417F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4A417FB50>]}
[0m16:15:27.925321 [debug] [MainThread]: Flushing usage events
[0m16:15:32.900251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDAD49E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDDB22EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDDB21330>]}


============================== 16:15:32.906254 | 0e5184c4-be90-4a83-869a-0ec5ddfbc319 ==============================
[0m16:15:32.906254 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:15:32.906254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:33.738356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDE392470>]}
[0m16:15:33.895191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDDADDE10>]}
[0m16:15:33.897031 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m16:15:33.909207 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m16:15:34.026632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:34.026632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:34.027633 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m16:15:34.033726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDE8509D0>]}
[0m16:15:34.045131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDE8221A0>]}
[0m16:15:34.046132 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m16:15:34.047132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDE822290>]}
[0m16:15:34.047637 [info ] [MainThread]: 
[0m16:15:34.048643 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:15:34.050642 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m16:15:34.068646 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m16:15:34.069651 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m16:15:34.070648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:34.074733 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:15:34.075736 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:15:34.733533 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:15:34.735466 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m16:15:34.738531 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m16:15:34.745627 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:15:34.746637 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m16:15:34.746637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:34.746637 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:15:34.746637 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:15:35.029312 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.030211 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:15:35.031296 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m16:15:35.146087 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.154937 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m16:15:35.221760 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m16:15:35.259414 [debug] [MainThread]: Using redshift connection "master"
[0m16:15:35.259414 [debug] [MainThread]: On master: BEGIN
[0m16:15:35.260411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:35.261648 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:15:35.261648 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:15:35.529955 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.530943 [debug] [MainThread]: Using redshift connection "master"
[0m16:15:35.530943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:15:35.668976 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.674043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDEAB0A90>]}
[0m16:15:35.674043 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:35.739484 [debug] [MainThread]: Using redshift connection "master"
[0m16:15:35.740483 [debug] [MainThread]: On master: BEGIN
[0m16:15:35.766968 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.768056 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.768965 [debug] [MainThread]: Using redshift connection "master"
[0m16:15:35.770063 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.821320 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:35.822316 [debug] [MainThread]: On master: Close
[0m16:15:35.823317 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m16:15:35.824316 [info ] [MainThread]: 
[0m16:15:35.846408 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m16:15:35.846408 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m16:15:35.847436 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m16:15:35.847436 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m16:15:35.851920 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m16:15:35.854772 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 16:15:35.848433 => 16:15:35.854772
[0m16:15:35.855930 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m16:15:35.922595 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:35.922595 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp161535883019"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m16:15:35.923608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:15:35.923608 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:15:35.924597 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:15:45.332187 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m16:15:45.360450 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:45.361487 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m16:15:45.418053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:45.420069 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:45.421067 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp161535883019'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp161535883019'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp161535883019'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m16:15:45.656863 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:45.692590 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:45.693685 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:15:45.896823 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:45.938483 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:45.940458 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:15:46.111478 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:46.146805 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m16:15:46.158210 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:46.159216 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp161535883019"
            );
[0m16:15:52.212930 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m16:15:52.213908 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:15:52.213908 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp161535883019"
    )
[0m16:16:02.914067 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m16:16:02.949147 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m16:16:02.950158 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m16:16:02.950158 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m16:16:03.399878 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:03.401901 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 16:15:35.855930 => 16:16:03.400901
[0m16:16:03.402903 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m16:16:03.405522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e5184c4-be90-4a83-869a-0ec5ddfbc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDEA4AAA0>]}
[0m16:16:03.408539 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 27.56s]
[0m16:16:03.410539 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m16:16:03.415863 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:03.416895 [debug] [MainThread]: On master: BEGIN
[0m16:16:03.417866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:03.419896 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:03.420917 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:03.685606 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:03.685606 [debug] [MainThread]: On master: COMMIT
[0m16:16:03.687694 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:03.688692 [debug] [MainThread]: On master: COMMIT
[0m16:16:03.737985 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:03.738996 [debug] [MainThread]: On master: Close
[0m16:16:03.740934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:03.741933 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m16:16:03.743933 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m16:16:03.743933 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m16:16:03.744933 [info ] [MainThread]: 
[0m16:16:03.746939 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 29.70 seconds (29.70s).
[0m16:16:03.747954 [debug] [MainThread]: Command end result
[0m16:16:03.771050 [info ] [MainThread]: 
[0m16:16:03.772050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:03.772050 [info ] [MainThread]: 
[0m16:16:03.774050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:03.777050 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:03.777050 after 30.95 seconds
[0m16:16:03.778049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDAD49E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDEA8BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABDEA881F0>]}
[0m16:16:03.779066 [debug] [MainThread]: Flushing usage events
[0m16:16:09.604546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92080DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9235CC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9235CD810>]}


============================== 16:16:09.610611 | 369e88c2-0fbd-4e07-9251-4227a589addb ==============================
[0m16:16:09.610611 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:09.611616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:16:09.797660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '369e88c2-0fbd-4e07-9251-4227a589addb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9235CF100>]}
[0m16:16:09.798662 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:09.799662 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:09.800660 [debug] [MainThread]: Command `dbt deps` succeeded at 16:16:09.800660 after 0.27 seconds
[0m16:16:09.801662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92080DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9235CF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9235CFB50>]}
[0m16:16:09.801662 [debug] [MainThread]: Flushing usage events
[0m16:16:14.796525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8F8CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92696FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92694F10>]}


============================== 16:16:14.802526 | fdca5d67-7403-492b-b784-771e1a709509 ==============================
[0m16:16:14.802526 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:14.803551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:15.508778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92031540>]}
[0m16:16:15.702393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92F18FA0>]}
[0m16:16:15.704419 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m16:16:15.715774 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m16:16:15.799548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:15.799548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:15.800564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m16:16:15.806463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB933C0AF0>]}
[0m16:16:15.817467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB93392380>]}
[0m16:16:15.818474 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m16:16:15.818474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB93392350>]}
[0m16:16:15.820508 [info ] [MainThread]: 
[0m16:16:15.821477 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:16:15.823473 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m16:16:15.840996 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m16:16:15.840996 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m16:16:15.840996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:15.846072 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:15.847089 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:16.456975 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:16.459973 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m16:16:16.462011 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m16:16:16.471293 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:16.471293 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m16:16:16.471293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:16.472296 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:16.472296 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:16.721449 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:16.722457 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:16.722457 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m16:16:16.827467 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:16.833093 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m16:16:16.887938 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m16:16:16.925114 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:16.925114 [debug] [MainThread]: On master: BEGIN
[0m16:16:16.926108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:16.926108 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:16.927124 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:17.186461 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:17.187458 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:17.187458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:16:17.324567 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:17.328677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB93620B80>]}
[0m16:16:17.328677 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:17.392665 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:17.393663 [debug] [MainThread]: On master: BEGIN
[0m16:16:17.419648 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:17.420667 [debug] [MainThread]: On master: COMMIT
[0m16:16:17.420667 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:17.420667 [debug] [MainThread]: On master: COMMIT
[0m16:16:17.472247 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:17.473344 [debug] [MainThread]: On master: Close
[0m16:16:17.474337 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m16:16:17.475337 [info ] [MainThread]: 
[0m16:16:17.495008 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m16:16:17.495008 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m16:16:17.496008 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m16:16:17.497008 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m16:16:17.500009 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m16:16:17.504931 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 16:16:17.497008 => 16:16:17.503924
[0m16:16:17.504931 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m16:16:17.573841 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:17.574849 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp161617534640"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m16:16:17.574849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:17.574849 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:17.575841 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:23.004373 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m16:16:23.038510 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.039501 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m16:16:23.088375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:23.089327 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.090346 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp161617534640'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp161617534640'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp161617534640'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m16:16:23.311910 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:23.344644 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.345742 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:16:23.582429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:23.609344 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.610429 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:16:23.774069 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:23.811208 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m16:16:23.822514 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.823515 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp161617534640"
            );
[0m16:16:23.943105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:23.944636 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:23.945665 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp161617534640"
    )
[0m16:16:24.043798 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:24.082451 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m16:16:24.084431 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m16:16:24.085445 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m16:16:24.785251 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:24.787363 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 16:16:17.504931 => 16:16:24.787363
[0m16:16:24.789361 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m16:16:24.791375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdca5d67-7403-492b-b784-771e1a709509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB935BAB90>]}
[0m16:16:24.794261 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 7.30s]
[0m16:16:24.795260 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m16:16:24.801391 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:24.803399 [debug] [MainThread]: On master: BEGIN
[0m16:16:24.804362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:24.805387 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:24.806368 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:25.089793 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:25.090795 [debug] [MainThread]: On master: COMMIT
[0m16:16:25.091793 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:25.092798 [debug] [MainThread]: On master: COMMIT
[0m16:16:25.145385 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:25.147449 [debug] [MainThread]: On master: Close
[0m16:16:25.149167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:25.151076 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m16:16:25.152162 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m16:16:25.153178 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m16:16:25.154168 [info ] [MainThread]: 
[0m16:16:25.155167 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m16:16:25.157160 [debug] [MainThread]: Command end result
[0m16:16:25.182070 [info ] [MainThread]: 
[0m16:16:25.183071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:25.183071 [info ] [MainThread]: 
[0m16:16:25.184159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:25.185158 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:25.185158 after 10.47 seconds
[0m16:16:25.186156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8F8CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB935FB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB935F8160>]}
[0m16:16:25.186156 [debug] [MainThread]: Flushing usage events
[0m16:16:31.091090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002352F449E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353220C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353220CFD0>]}


============================== 16:16:31.096997 | d0d7ea31-a234-4a62-b87d-88449c0904d9 ==============================
[0m16:16:31.096997 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:31.097997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:16:31.285578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d7ea31-a234-4a62-b87d-88449c0904d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353220FAC0>]}
[0m16:16:31.286579 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:31.288586 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:31.291664 [debug] [MainThread]: Command `dbt deps` succeeded at 16:16:31.290725 after 0.29 seconds
[0m16:16:31.291664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002352F449E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353220C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235322771F0>]}
[0m16:16:31.291664 [debug] [MainThread]: Flushing usage events
[0m16:16:36.488084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FCD4DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FFB26FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FFB25690>]}


============================== 16:16:36.493180 | da4d9ea2-c1fa-4b70-bb2c-6a52205784ab ==============================
[0m16:16:36.493180 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:36.494194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m16:16:37.214523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF4B1510>]}
[0m16:16:37.373036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FFB275B0>]}
[0m16:16:37.375050 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m16:16:37.388959 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m16:16:37.473729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:37.474736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:37.474736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m16:16:37.479733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133808C0AC0>]}
[0m16:16:37.492654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380896290>]}
[0m16:16:37.492654 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m16:16:37.493652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380896380>]}
[0m16:16:37.494652 [info ] [MainThread]: 
[0m16:16:37.494652 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:16:37.496432 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m16:16:37.513666 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m16:16:37.514668 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m16:16:37.514668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:37.521676 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:37.521676 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:38.113529 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:38.116424 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m16:16:38.121421 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m16:16:38.130418 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:38.131420 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m16:16:38.131420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:38.132420 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:38.132420 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:38.436919 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:38.437918 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:38.437918 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m16:16:38.547534 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:38.554515 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m16:16:38.614255 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m16:16:38.655297 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:38.656393 [debug] [MainThread]: On master: BEGIN
[0m16:16:38.656393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:38.657393 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:38.657393 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:38.909786 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:38.910779 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:38.910779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:16:39.046807 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:39.050804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380B20B20>]}
[0m16:16:39.051821 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:39.113703 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:39.113703 [debug] [MainThread]: On master: BEGIN
[0m16:16:39.142180 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:39.143028 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.143028 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:39.144027 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.190492 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:39.192601 [debug] [MainThread]: On master: Close
[0m16:16:39.194633 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m16:16:39.195606 [info ] [MainThread]: 
[0m16:16:39.212266 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m16:16:39.213299 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m16:16:39.214267 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m16:16:39.215269 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m16:16:39.219292 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m16:16:39.222296 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 16:16:39.215269 => 16:16:39.221628
[0m16:16:39.223311 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m16:16:39.295120 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:39.296105 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp161639255308"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m16:16:39.296105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:39.297112 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:39.297112 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:40.640804 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:40.660816 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:40.661820 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m16:16:40.711321 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:40.712228 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:40.712228 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp161639255308'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp161639255308'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp161639255308'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m16:16:40.928688 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:40.953346 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:40.954346 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:16:41.156919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:41.189442 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:41.190443 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:16:41.350902 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:41.375184 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m16:16:41.382426 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:41.384432 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp161639255308"
            );
[0m16:16:41.539231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:41.540393 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:41.540393 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp161639255308"
    )
[0m16:16:41.805436 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:41.828437 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m16:16:41.829437 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m16:16:41.830435 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m16:16:42.954613 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:42.956772 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 16:16:39.223311 => 16:16:42.956772
[0m16:16:42.958731 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m16:16:42.960750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da4d9ea2-c1fa-4b70-bb2c-6a52205784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380ABA950>]}
[0m16:16:42.961617 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 3.75s]
[0m16:16:42.963656 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m16:16:42.969747 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:42.970754 [debug] [MainThread]: On master: BEGIN
[0m16:16:42.971728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:42.972758 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:42.973754 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:43.293982 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:43.294886 [debug] [MainThread]: On master: COMMIT
[0m16:16:43.295962 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:43.296899 [debug] [MainThread]: On master: COMMIT
[0m16:16:43.351826 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:43.352845 [debug] [MainThread]: On master: Close
[0m16:16:43.355838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:43.356850 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m16:16:43.357836 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m16:16:43.358833 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m16:16:43.359842 [info ] [MainThread]: 
[0m16:16:43.360848 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m16:16:43.361746 [debug] [MainThread]: Command end result
[0m16:16:43.387498 [info ] [MainThread]: 
[0m16:16:43.388499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:43.388499 [info ] [MainThread]: 
[0m16:16:43.389526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:43.391580 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:43.390583 after 6.98 seconds
[0m16:16:43.391580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FCD4DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380AFBBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013380AFBDC0>]}
[0m16:16:43.392581 [debug] [MainThread]: Flushing usage events
[0m16:16:49.893632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001248FD7DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492B3E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492B3F250>]}


============================== 16:16:49.899634 | 3867a3a5-59ce-48cf-aa79-ef2a1fdc1708 ==============================
[0m16:16:49.899634 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:49.900626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:50.145065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3867a3a5-59ce-48cf-aa79-ef2a1fdc1708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492B7F700>]}
[0m16:16:50.147064 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:50.147968 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:16:50.148971 [debug] [MainThread]: Command `dbt deps` succeeded at 16:16:50.148971 after 0.34 seconds
[0m16:16:50.150071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001248FD7DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492B3FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012492B3E710>]}
[0m16:16:50.150071 [debug] [MainThread]: Flushing usage events
[0m16:16:56.147682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86D97DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87073AF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A870739540>]}


============================== 16:16:56.153647 | c89fd646-b56c-42d7-b64f-2aaa88df8b67 ==============================
[0m16:16:56.153647 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:16:56.154626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:/adam/etl_bss_paytv/modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:56.883197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86E26AEC0>]}
[0m16:16:57.050099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87073BEB0>]}
[0m16:16:57.054142 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m16:16:57.065088 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m16:16:57.146975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:57.146975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:57.147971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m16:16:57.153965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A871460A30>]}
[0m16:16:57.164883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A871432200>]}
[0m16:16:57.164883 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m16:16:57.165976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8714322F0>]}
[0m16:16:57.166885 [info ] [MainThread]: 
[0m16:16:57.167889 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m16:16:57.170998 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m16:16:57.188984 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m16:16:57.188984 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m16:16:57.189971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:57.194978 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:57.195990 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:57.789992 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:57.792001 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m16:16:57.795003 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m16:16:57.804518 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:57.805524 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m16:16:57.805524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:57.806468 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:57.806468 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:58.058339 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.059294 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m16:16:58.059294 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m16:16:58.171609 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.179614 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m16:16:58.235862 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m16:16:58.278926 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:58.279937 [debug] [MainThread]: On master: BEGIN
[0m16:16:58.279937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:58.280931 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:58.280931 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:16:58.552903 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.553895 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:58.554897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m16:16:58.693828 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.696831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8716C0AF0>]}
[0m16:16:58.697824 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:58.768576 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:58.770583 [debug] [MainThread]: On master: BEGIN
[0m16:16:58.796757 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.797833 [debug] [MainThread]: On master: COMMIT
[0m16:16:58.798748 [debug] [MainThread]: Using redshift connection "master"
[0m16:16:58.798748 [debug] [MainThread]: On master: COMMIT
[0m16:16:58.851683 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:58.852664 [debug] [MainThread]: On master: Close
[0m16:16:58.853664 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m16:16:58.854663 [info ] [MainThread]: 
[0m16:16:58.874112 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m16:16:58.875131 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m16:16:58.876112 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m16:16:58.876112 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m16:16:58.879137 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m16:16:58.883115 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 16:16:58.876112 => 16:16:58.882113
[0m16:16:58.884128 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m16:16:58.959151 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:16:58.960146 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp161658918757"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m16:16:58.960146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:58.961236 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:16:58.961236 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:01.237871 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m16:17:01.277889 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:01.279786 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m16:17:01.326245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.327265 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:01.329260 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp161658918757'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp161658918757'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp161658918757'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m16:17:01.544116 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.578023 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:01.580184 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:17:01.771102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.790115 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:01.791118 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m16:17:01.952017 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.989040 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m16:17:01.995431 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:01.996345 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp161658918757"
            );
[0m16:17:02.377024 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:02.378118 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:02.379016 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp161658918757"
    )
[0m16:17:05.703863 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m16:17:05.740491 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m16:17:05.741486 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m16:17:05.741486 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m16:17:06.232471 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:06.235574 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 16:16:58.885141 => 16:17:06.234603
[0m16:17:06.236573 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m16:17:06.239596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89fd646-b56c-42d7-b64f-2aaa88df8b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87165AA40>]}
[0m16:17:06.240578 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 7.36s]
[0m16:17:06.242531 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m16:17:06.247612 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:06.248587 [debug] [MainThread]: On master: BEGIN
[0m16:17:06.249576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:06.250611 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:17:06.251606 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:17:06.517853 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:06.518879 [debug] [MainThread]: On master: COMMIT
[0m16:17:06.520878 [debug] [MainThread]: Using redshift connection "master"
[0m16:17:06.521881 [debug] [MainThread]: On master: COMMIT
[0m16:17:06.574254 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:06.576241 [debug] [MainThread]: On master: Close
[0m16:17:06.579280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:06.580260 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m16:17:06.581258 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m16:17:06.582253 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m16:17:06.583254 [info ] [MainThread]: 
[0m16:17:06.584258 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m16:17:06.586239 [debug] [MainThread]: Command end result
[0m16:17:06.609518 [info ] [MainThread]: 
[0m16:17:06.610527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:06.611647 [info ] [MainThread]: 
[0m16:17:06.612623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:17:06.616379 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:06.615249 after 10.54 seconds
[0m16:17:06.617385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86D97DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87106CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A871431D80>]}
[0m16:17:06.617385 [debug] [MainThread]: Flushing usage events
[0m17:05:22.325516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F469D1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F459E7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F459E7A30>]}


============================== 17:05:22.331782 | 100a93d4-b0bd-493f-a59b-6469b1dc9c8a ==============================
[0m17:05:22.331782 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:22.332791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:22.552132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100a93d4-b0bd-493f-a59b-6469b1dc9c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F470AD750>]}
[0m17:05:22.553132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:05:22.555111 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:05:22.556131 [debug] [MainThread]: Command `dbt deps` succeeded at 17:05:22.556131 after 0.33 seconds
[0m17:05:22.556131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F469D1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F459E7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F459E59F0>]}
[0m17:05:22.557111 [debug] [MainThread]: Flushing usage events
[0m17:05:26.750511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207FF41E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200295C130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200295F460>]}


============================== 17:05:26.755604 | ecdd71e0-fd87-4eff-8a44-621313df4266 ==============================
[0m17:05:26.755604 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:26.755604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:27.138907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000872CB0>]}
[0m17:05:27.284280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022002C855A0>]}
[0m17:05:27.286524 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m17:05:27.310398 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m17:05:27.340441 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:05:27.341485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022002DBC0D0>]}
[0m17:05:29.284687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:05:29.289762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003437EE0>]}
[0m17:05:29.301707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022002E8CF40>]}
[0m17:05:29.302759 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:05:29.302759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecdd71e0-fd87-4eff-8a44-621313df4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022002DBD7E0>]}
[0m17:05:29.305706 [debug] [MainThread]: Command `dbt ls` succeeded at 17:05:29.305706 after 2.64 seconds
[0m17:05:29.306804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207FF41E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022002F2CDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220032A5F00>]}
[0m17:05:29.307705 [debug] [MainThread]: Flushing usage events
[0m17:14:08.436000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254ECD69E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EBD77A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EBD76F20>]}


============================== 17:14:08.442023 | 91850200-c8d8-4eff-91f6-2255d32c0c22 ==============================
[0m17:14:08.442023 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:08.443040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:14:08.717464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91850200-c8d8-4eff-91f6-2255d32c0c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EBD320E0>]}
[0m17:14:08.719555 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:08.720462 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:08.721461 [debug] [MainThread]: Command `dbt deps` succeeded at 17:14:08.721461 after 0.42 seconds
[0m17:14:08.722538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254ECD69E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EBD745E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EBD774C0>]}
[0m17:14:08.723480 [debug] [MainThread]: Flushing usage events
[0m17:14:14.049952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475C61E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020474C6D270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020474C6C700>]}


============================== 17:14:14.055055 | 5e646449-2c84-4875-beb7-254cc9c0c021 ==============================
[0m17:14:14.055055 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:14.056068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_provider_packages -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:14.773795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020474C6F160>]}
[0m17:14:14.976645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478873430>]}
[0m17:14:14.981649 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m17:14:14.994686 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m17:14:15.134471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:15.135485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:15.137385 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:14:15.143402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478D35870>]}
[0m17:14:15.157403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478BCAC80>]}
[0m17:14:15.158404 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:14:15.159424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478BCABC0>]}
[0m17:14:15.160402 [info ] [MainThread]: 
[0m17:14:15.163412 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:14:15.167410 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:14:15.184421 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:14:15.185404 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:14:15.185404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:15.191444 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:15.191444 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:15.825282 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:14:15.828383 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:14:15.833295 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:14:15.840292 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:15.841292 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:14:15.841292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:15.842294 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:15.843298 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:16.103509 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.104465 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:16.104465 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:14:16.207474 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.219486 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:14:16.280290 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:14:16.341014 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:16.342012 [debug] [MainThread]: On master: BEGIN
[0m17:14:16.342012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:16.343012 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:16.343012 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:16.698734 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.699730 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:16.700725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:14:16.836924 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.839015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478D741F0>]}
[0m17:14:16.840014 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:16.899828 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:16.899828 [debug] [MainThread]: On master: BEGIN
[0m17:14:16.924969 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.925961 [debug] [MainThread]: On master: COMMIT
[0m17:14:16.925961 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:16.926959 [debug] [MainThread]: On master: COMMIT
[0m17:14:16.971466 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:16.972478 [debug] [MainThread]: On master: Close
[0m17:14:16.973572 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:14:16.974472 [info ] [MainThread]: 
[0m17:14:16.990554 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m17:14:16.991553 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m17:14:16.992552 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m17:14:16.992552 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m17:14:17.000661 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m17:14:17.002599 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 17:14:16.993642 => 17:14:17.001639
[0m17:14:17.002599 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m17:14:17.147031 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:17.149015 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp171417037322"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m17:14:17.150015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:17.151016 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:17.151016 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:17.768153 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:14:17.784154 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:17.784154 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m17:14:17.849823 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:17.850903 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:17.851848 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp171417037322'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp171417037322'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp171417037322'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:14:18.081657 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:18.094745 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:18.098768 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:14:18.368092 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:18.404171 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:18.405156 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:14:18.566304 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:18.591302 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m17:14:18.597367 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:18.599357 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp171417037322"
            );
[0m17:14:22.689675 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m17:14:22.689675 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:22.690674 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp171417037322"
    )
[0m17:14:28.215249 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m17:14:28.232739 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m17:14:28.233739 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m17:14:28.234739 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m17:14:28.800665 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:14:28.802665 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 17:14:17.003596 => 17:14:28.801666
[0m17:14:28.803665 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m17:14:28.804664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e646449-2c84-4875-beb7-254cc9c0c021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478D68340>]}
[0m17:14:28.805667 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 11.81s]
[0m17:14:28.806665 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m17:14:28.810666 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:28.814723 [debug] [MainThread]: On master: BEGIN
[0m17:14:28.815703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:28.817704 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:28.818705 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:29.065807 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:29.066804 [debug] [MainThread]: On master: COMMIT
[0m17:14:29.066804 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:29.067804 [debug] [MainThread]: On master: COMMIT
[0m17:14:29.114800 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:29.115791 [debug] [MainThread]: On master: Close
[0m17:14:29.116781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:29.117873 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:14:29.117873 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:14:29.118781 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m17:14:29.118781 [info ] [MainThread]: 
[0m17:14:29.119782 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.96 seconds (13.96s).
[0m17:14:29.119782 [debug] [MainThread]: Command end result
[0m17:14:29.134405 [info ] [MainThread]: 
[0m17:14:29.135453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:29.135453 [info ] [MainThread]: 
[0m17:14:29.136407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:14:29.137406 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:29.137406 after 15.21 seconds
[0m17:14:29.138499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020475C61E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478EEBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020478AF1B10>]}
[0m17:14:29.138499 [debug] [MainThread]: Flushing usage events
[0m17:14:35.418334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A9289E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8287A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8285A20>]}


============================== 17:14:35.423170 | 8f4e588b-0d07-4c19-9058-a44866496d93 ==============================
[0m17:14:35.423170 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:35.424180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:14:35.658032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f4e588b-0d07-4c19-9058-a44866496d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8ABBE7460>]}
[0m17:14:35.659032 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:35.660040 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:35.665092 [debug] [MainThread]: Command `dbt deps` succeeded at 17:14:35.663992 after 0.36 seconds
[0m17:14:35.665960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A9289E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8287BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8ABC845E0>]}
[0m17:14:35.666958 [debug] [MainThread]: Flushing usage events
[0m17:14:41.460241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024051BF1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024050C0C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024050C0D1B0>]}


============================== 17:14:41.470286 | 82b837e2-83ca-4708-92ec-c711e345f1bb ==============================
[0m17:14:41.470286 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:41.471339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_providers -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:14:41.990534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024050BC28C0>]}
[0m17:14:42.187858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240548F37F0>]}
[0m17:14:42.189765 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m17:14:42.204849 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m17:14:42.283335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:42.284335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:42.285333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:14:42.290332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054CD5900>]}
[0m17:14:42.306333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054B6AD10>]}
[0m17:14:42.307371 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:14:42.307371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054B6AC50>]}
[0m17:14:42.309413 [info ] [MainThread]: 
[0m17:14:42.310376 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:14:42.315334 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:14:42.331353 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:14:42.332336 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:14:42.333336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:42.339343 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:42.340343 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:42.815649 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:42.817615 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:14:42.820611 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:14:42.832614 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:42.833614 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:14:42.834613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:42.835622 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:42.836625 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:43.097782 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.099749 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:43.100749 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:14:43.200618 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.204701 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:14:43.261445 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:14:43.305346 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:43.306348 [debug] [MainThread]: On master: BEGIN
[0m17:14:43.306348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:43.307349 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:43.308349 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:43.564275 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.566119 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:43.566119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:14:43.698807 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.701806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054E9D720>]}
[0m17:14:43.702806 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:43.764949 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:43.765965 [debug] [MainThread]: On master: BEGIN
[0m17:14:43.791941 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.792950 [debug] [MainThread]: On master: COMMIT
[0m17:14:43.792950 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:43.793994 [debug] [MainThread]: On master: COMMIT
[0m17:14:43.845377 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:43.848258 [debug] [MainThread]: On master: Close
[0m17:14:43.850776 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:14:43.850776 [info ] [MainThread]: 
[0m17:14:43.865888 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m17:14:43.866886 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m17:14:43.867886 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m17:14:43.868886 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m17:14:43.872885 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m17:14:43.873886 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 17:14:43.868886 => 17:14:43.872885
[0m17:14:43.873886 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m17:14:44.026756 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:44.029681 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp171443908884"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m17:14:44.035737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:44.037757 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:44.037757 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:44.383449 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:44.399439 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:44.400440 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m17:14:44.450644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:44.450644 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:44.451738 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp171443908884'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp171443908884'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp171443908884'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:14:44.666820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:44.680869 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:44.681740 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:14:44.869181 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:44.892278 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:44.893182 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:14:45.049480 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:45.087175 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m17:14:45.092158 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:45.096189 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp171443908884"
            );
[0m17:14:45.230705 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:45.232582 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:45.233580 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp171443908884"
    )
[0m17:14:45.336016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:45.355511 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m17:14:45.356513 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m17:14:45.357513 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m17:14:45.766371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:45.768362 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 17:14:43.873886 => 17:14:45.768362
[0m17:14:45.768362 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m17:14:45.770359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b837e2-83ca-4708-92ec-c711e345f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240546D60E0>]}
[0m17:14:45.771424 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 1.90s]
[0m17:14:45.771424 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m17:14:45.775358 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:45.775358 [debug] [MainThread]: On master: BEGIN
[0m17:14:45.776377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:45.776377 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:45.777380 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:46.039927 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:46.041004 [debug] [MainThread]: On master: COMMIT
[0m17:14:46.042011 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:46.042929 [debug] [MainThread]: On master: COMMIT
[0m17:14:46.100021 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:46.101023 [debug] [MainThread]: On master: Close
[0m17:14:46.102021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:46.103021 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:14:46.103021 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:14:46.104021 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m17:14:46.104021 [info ] [MainThread]: 
[0m17:14:46.105019 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m17:14:46.106019 [debug] [MainThread]: Command end result
[0m17:14:46.120058 [info ] [MainThread]: 
[0m17:14:46.121133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:46.122076 [info ] [MainThread]: 
[0m17:14:46.122076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:14:46.124024 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:46.124024 after 4.77 seconds
[0m17:14:46.125022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024051BF1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054D0BC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024054A92380>]}
[0m17:14:46.125022 [debug] [MainThread]: Flushing usage events
[0m17:14:51.823585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECD729E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECC737A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECC737760>]}


============================== 17:14:51.829424 | dfeaa532-2f1f-4a2e-9185-fbf4b5bcf598 ==============================
[0m17:14:51.829424 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:51.832404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:52.050031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfeaa532-2f1f-4a2e-9185-fbf4b5bcf598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECC737BB0>]}
[0m17:14:52.051032 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:52.052030 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:52.053030 [debug] [MainThread]: Command `dbt deps` succeeded at 17:14:52.053030 after 0.34 seconds
[0m17:14:52.054031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECD729E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECC737BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECC734670>]}
[0m17:14:52.054031 [debug] [MainThread]: Flushing usage events
[0m17:14:57.320774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C2E0DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C1E1FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C1E1DF60>]}


============================== 17:14:57.325774 | 78d3dd6f-7fb3-4b51-ab7d-9f556698e272 ==============================
[0m17:14:57.325774 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:57.326771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_user_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m17:14:57.876376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C574B430>]}
[0m17:14:58.072459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5C4EFB0>]}
[0m17:14:58.074457 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m17:14:58.090536 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m17:14:58.171094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:58.171094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:58.172095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:14:58.179229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5EE5840>]}
[0m17:14:58.191095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5D7AC50>]}
[0m17:14:58.192095 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:14:58.193188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5D7AB90>]}
[0m17:14:58.195228 [info ] [MainThread]: 
[0m17:14:58.198111 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:14:58.201131 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:14:58.215096 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:14:58.216185 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:14:58.217101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:58.223177 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:58.223177 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:58.775375 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:14:58.776463 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:14:58.783378 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:14:58.790462 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:58.790462 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:14:58.791486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:58.791486 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:58.792450 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:59.047865 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.048864 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:14:59.048864 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:14:59.155484 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.159578 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:14:59.214484 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:14:59.262607 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:59.265496 [debug] [MainThread]: On master: BEGIN
[0m17:14:59.266479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:59.267481 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:59.267481 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:14:59.516875 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.517869 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:59.518887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:14:59.653227 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.655317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5F24A60>]}
[0m17:14:59.656316 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:59.717372 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:59.718444 [debug] [MainThread]: On master: BEGIN
[0m17:14:59.743680 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.746635 [debug] [MainThread]: On master: COMMIT
[0m17:14:59.748642 [debug] [MainThread]: Using redshift connection "master"
[0m17:14:59.749634 [debug] [MainThread]: On master: COMMIT
[0m17:14:59.797471 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:14:59.798355 [debug] [MainThread]: On master: Close
[0m17:14:59.800458 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:14:59.800458 [info ] [MainThread]: 
[0m17:14:59.818354 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m17:14:59.819446 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m17:14:59.820443 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m17:14:59.820443 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m17:14:59.824439 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m17:14:59.825440 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 17:14:59.821370 => 17:14:59.825440
[0m17:14:59.826352 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m17:14:59.973472 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:14:59.973472 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp171459862516"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m17:14:59.974472 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:59.974472 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:14:59.975472 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:01.363103 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:01.390592 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:01.391594 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m17:15:01.439392 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:01.440393 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:01.441393 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp171459862516'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp171459862516'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp171459862516'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:15:01.660846 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:01.703531 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:01.705530 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:15:01.893006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:01.913018 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:01.915913 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:15:02.070435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:02.090203 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m17:15:02.093207 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:02.095166 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp171459862516"
            );
[0m17:15:02.300626 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:02.300626 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:02.301626 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp171459862516"
    )
[0m17:15:02.590624 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:02.617637 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m17:15:02.619637 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m17:15:02.620639 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m17:15:03.555432 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:03.557448 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 17:14:59.826352 => 17:15:03.557448
[0m17:15:03.558476 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m17:15:03.559414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d3dd6f-7fb3-4b51-ab7d-9f556698e272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C60E0130>]}
[0m17:15:03.561503 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 3.74s]
[0m17:15:03.565471 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m17:15:03.569455 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:03.570453 [debug] [MainThread]: On master: BEGIN
[0m17:15:03.570453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:03.571452 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:03.572454 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:03.823675 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.824640 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.825683 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:03.826734 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.872364 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:03.873366 [debug] [MainThread]: On master: Close
[0m17:15:03.874365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:03.875364 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:15:03.875364 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:15:03.876364 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m17:15:03.876364 [info ] [MainThread]: 
[0m17:15:03.877364 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m17:15:03.879919 [debug] [MainThread]: Command end result
[0m17:15:03.890884 [info ] [MainThread]: 
[0m17:15:03.891886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:03.892886 [info ] [MainThread]: 
[0m17:15:03.893890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:03.897982 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:03.896896 after 6.72 seconds
[0m17:15:03.898890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C2E0DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C58E6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9C5B76020>]}
[0m17:15:03.899890 [debug] [MainThread]: Flushing usage events
[0m17:15:09.502106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD8989E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD7987A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD79859F0>]}


============================== 17:15:09.507204 | e7155dfe-d682-4ba3-bdc6-e3622f1d2a2e ==============================
[0m17:15:09.507204 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:15:09.508140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:09.818841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7155dfe-d682-4ba3-bdc6-e3622f1d2a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BDB2E7430>]}
[0m17:15:09.819841 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:09.821843 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:09.822844 [debug] [MainThread]: Command `dbt deps` succeeded at 17:15:09.822844 after 0.45 seconds
[0m17:15:09.823842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD8989E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD7986560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD7987730>]}
[0m17:15:09.824842 [debug] [MainThread]: Flushing usage events
[0m17:15:15.375837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60929DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6082AFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6082ADF30>]}


============================== 17:15:15.384935 | e3edcf5f-9cfd-4d62-b8e1-bad04476609e ==============================
[0m17:15:15.384935 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:15:15.385935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_users -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:15.961752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BF59300>]}
[0m17:15:16.178877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BEE8220>]}
[0m17:15:16.180802 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m17:15:16.196999 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m17:15:16.268620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:16.269603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:16.270528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m17:15:16.278652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60C375810>]}
[0m17:15:16.288615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60C20AC20>]}
[0m17:15:16.289615 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m17:15:16.289615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60C20AB60>]}
[0m17:15:16.292625 [info ] [MainThread]: 
[0m17:15:16.296631 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:15:16.298610 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m17:15:16.313209 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m17:15:16.314277 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m17:15:16.315205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:16.321278 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:16.322292 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:16.840187 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:15:16.841274 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m17:15:16.843207 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m17:15:16.855186 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:15:16.855186 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m17:15:16.856188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:16.856188 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:16.857188 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:17.112797 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.113702 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m17:15:17.113702 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m17:15:17.214467 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.222475 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m17:15:17.276537 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m17:15:17.323253 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:17.325166 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.326163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:17.326163 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:17.327242 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:17.579725 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.580799 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:17.581706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:15:17.713384 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.718453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60C3B57E0>]}
[0m17:15:17.719452 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:17.786025 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:17.787016 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.811995 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.811995 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.812996 [debug] [MainThread]: Using redshift connection "master"
[0m17:15:17.813997 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.871763 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:17.875741 [debug] [MainThread]: On master: Close
[0m17:15:17.876727 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m17:15:17.878815 [info ] [MainThread]: 
[0m17:15:17.893733 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m17:15:17.894748 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m17:15:17.896725 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m17:15:17.896725 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m17:15:17.901282 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m17:15:17.902264 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 17:15:17.897725 => 17:15:17.902264
[0m17:15:17.903269 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m17:15:18.075858 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:18.076854 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp171517947310"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m17:15:18.076854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:15:18.077856 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:15:18.078858 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:15:30.116559 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m17:15:30.141072 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:30.142156 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m17:15:30.190866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:30.191890 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:30.192867 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp171517947310'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp171517947310'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp171517947310'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m17:15:30.423735 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:30.436796 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:30.437753 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:15:30.680084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:30.686155 [debug] [Thread-1 (]: Changing col type from character varying(1000) to character varying(10000) in table database: "vplus_db_premium"
schema: "analytics"
identifier: "bss_paytv_users"

[0m17:15:30.694077 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:30.695082 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    alter table "vplus_db_premium"."analytics"."bss_paytv_users" add column "ref_code__dbt_alter" character varying(10000);
[0m17:15:30.910321 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:30.912457 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:30.914341 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: update "vplus_db_premium"."analytics"."bss_paytv_users" set "ref_code__dbt_alter" = "ref_code";
[0m17:15:44.846226 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m17:15:44.847227 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:44.848227 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: alter table "vplus_db_premium"."analytics"."bss_paytv_users" drop column "ref_code" cascade;
[0m17:15:44.939042 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:44.940044 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:44.941046 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: alter table "vplus_db_premium"."analytics"."bss_paytv_users" rename column "ref_code__dbt_alter" to "ref_code"
[0m17:15:45.010612 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:45.025452 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:45.026455 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m17:15:45.200249 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:15:45.215951 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m17:15:45.217936 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:45.218938 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp171517947310"
            );
[0m17:15:51.021876 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m17:15:51.021876 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:15:51.022897 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp171517947310"
    )
[0m17:16:01.821840 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m17:16:01.843839 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m17:16:01.845839 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m17:16:01.846839 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m17:16:02.411496 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:16:02.413568 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 17:15:17.903269 => 17:16:02.412564
[0m17:16:02.413568 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m17:16:02.415556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3edcf5f-9cfd-4d62-b8e1-bad04476609e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60C64B5B0>]}
[0m17:16:02.416479 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 44.52s]
[0m17:16:02.417479 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m17:16:02.420477 [debug] [MainThread]: Using redshift connection "master"
[0m17:16:02.421483 [debug] [MainThread]: On master: BEGIN
[0m17:16:02.422479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:02.422479 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:16:02.423480 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:16:02.746949 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:16:02.748965 [debug] [MainThread]: On master: COMMIT
[0m17:16:02.749961 [debug] [MainThread]: Using redshift connection "master"
[0m17:16:02.749961 [debug] [MainThread]: On master: COMMIT
[0m17:16:02.799367 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:16:02.801279 [debug] [MainThread]: On master: Close
[0m17:16:02.803287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:02.804277 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m17:16:02.805278 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m17:16:02.805278 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m17:16:02.806273 [info ] [MainThread]: 
[0m17:16:02.806273 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 46.51 seconds (46.51s).
[0m17:16:02.807272 [debug] [MainThread]: Command end result
[0m17:16:02.815277 [info ] [MainThread]: 
[0m17:16:02.816272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:02.817275 [info ] [MainThread]: 
[0m17:16:02.817275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:02.819274 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:02.819274 after 47.56 seconds
[0m17:16:02.819274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60929DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BF90BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BFBE710>]}
[0m17:16:02.820273 [debug] [MainThread]: Flushing usage events
[0m10:46:00.528962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E047F9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E075BEF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E075BCDF0>]}


============================== 10:46:00.536967 | 4d02001a-9a48-4762-9c34-64621dc9554d ==============================
[0m10:46:00.536967 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:46:00.538073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:46:00.863601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d02001a-9a48-4762-9c34-64621dc9554d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E075BFA90>]}
[0m10:46:00.865621 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:00.867126 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:00.869134 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:00.868157 after 0.46 seconds
[0m10:46:00.869134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E047F9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E075BEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E076A2D70>]}
[0m10:46:00.870136 [debug] [MainThread]: Flushing usage events
[0m10:46:06.070980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7852DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7880A26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7880A0BB0>]}


============================== 10:46:06.075515 | d32c1be4-a4f9-4504-bc2f-5c3d076c8562 ==============================
[0m10:46:06.075515 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:46:06.077043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:46:07.066111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32c1be4-a4f9-4504-bc2f-5c3d076c8562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7880C7220>]}
[0m10:46:07.257583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32c1be4-a4f9-4504-bc2f-5c3d076c8562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788B7CD30>]}
[0m10:46:07.260596 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:46:07.294771 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:46:07.340314 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:46:07.341325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd32c1be4-a4f9-4504-bc2f-5c3d076c8562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788BBB670>]}
[0m10:46:07.393249 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading modeling: source.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     schema: raw_data
    7  |     tables:
    8  |       - name: bss_paytv_users
    9  | - name: bss_paytv_user_packages
    10 | - name: bss_paytv_providers
    11 | - name: bss_paytv_provider_packages
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 9, column 1
[0m10:46:07.398258 [debug] [MainThread]: Command `dbt ls` failed at 10:46:07.397365 after 1.42 seconds
[0m10:46:07.399255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7852DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788B4F4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788B4C1C0>]}
[0m10:46:07.400261 [debug] [MainThread]: Flushing usage events
[0m10:50:53.908320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C49F25DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4A201C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4A201D810>]}


============================== 10:50:53.915312 | 6904f73b-acfb-491d-9691-485ba55ed694 ==============================
[0m10:50:53.915312 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:50:53.916389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m10:50:54.149323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6904f73b-acfb-491d-9691-485ba55ed694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4A201F100>]}
[0m10:50:54.150328 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:50:54.152328 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:50:54.153327 [debug] [MainThread]: Command `dbt deps` succeeded at 10:50:54.153327 after 0.33 seconds
[0m10:50:54.153327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C49F25DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4A201F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4A201FB50>]}
[0m10:50:54.154327 [debug] [MainThread]: Flushing usage events
[0m10:50:58.485566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2580DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E285D26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E285D0BB0>]}


============================== 10:50:58.489163 | 3a836a8d-7767-42fb-953a-9b66fa8897e3 ==============================
[0m10:50:58.489163 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:50:58.490196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m10:50:59.094598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E285FB220>]}
[0m10:50:59.232289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E290ACD30>]}
[0m10:50:59.234226 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:50:59.246439 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:50:59.272272 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:50:59.272272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E290EB670>]}
[0m10:51:01.483445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:51:01.488245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E285F8910>]}
[0m10:51:01.516367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E294DA2C0>]}
[0m10:51:01.516367 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:51:01.517388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a836a8d-7767-42fb-953a-9b66fa8897e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E294D9F30>]}
[0m10:51:01.519577 [debug] [MainThread]: Command `dbt ls` succeeded at 10:51:01.518552 after 3.11 seconds
[0m10:51:01.519577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2580DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E285D3BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E29346DD0>]}
[0m10:51:01.519577 [debug] [MainThread]: Flushing usage events
[0m10:51:06.956247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D701DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D9DDE230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D9DDF250>]}


============================== 10:51:06.959802 | 5538a22b-0e67-43a2-926c-47b767ec6ff5 ==============================
[0m10:51:06.959802 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:06.960802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:07.158884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5538a22b-0e67-43a2-926c-47b767ec6ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D9E1F700>]}
[0m10:51:07.160892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:07.161920 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:07.163885 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:07.162885 after 0.28 seconds
[0m10:51:07.163885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D701DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D9DDFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211D9DDE710>]}
[0m10:51:07.164885 [debug] [MainThread]: Flushing usage events
[0m10:51:11.499215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E203CBDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E206A82EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E206A80790>]}


============================== 10:51:11.504256 | 86965648-2dff-4f2a-9ddd-6b65ffa6ab7b ==============================
[0m10:51:11.504256 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:11.504256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:12.119136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E206AB6830>]}
[0m10:51:12.260587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E207274910>]}
[0m10:51:12.262677 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:51:12.274522 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:51:12.357480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:12.357480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:12.358490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:51:12.363573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2077B09A0>]}
[0m10:51:12.373196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E207782230>]}
[0m10:51:12.374169 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:51:12.374169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E207782200>]}
[0m10:51:12.375248 [info ] [MainThread]: 
[0m10:51:12.376258 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:51:12.378676 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:51:12.392283 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:51:12.393280 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:51:12.393280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:12.397870 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:12.398957 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:13.432042 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:13.434139 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:51:13.436044 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:51:13.444429 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:13.445426 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:51:13.445426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:13.446426 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:13.446426 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:13.717108 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:13.718663 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:13.719663 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:51:13.829323 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:13.834296 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:51:13.893333 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:51:13.932692 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:13.932692 [debug] [MainThread]: On master: BEGIN
[0m10:51:13.933696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:13.933696 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:13.933696 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:14.318693 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:14.320659 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:14.321658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:51:14.459505 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:14.463603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E207A10AC0>]}
[0m10:51:14.464614 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:14.528004 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:14.529024 [debug] [MainThread]: On master: BEGIN
[0m10:51:14.554913 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:14.555908 [debug] [MainThread]: On master: COMMIT
[0m10:51:14.555908 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:14.557551 [debug] [MainThread]: On master: COMMIT
[0m10:51:14.605716 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:14.605716 [debug] [MainThread]: On master: Close
[0m10:51:14.609246 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:51:14.610255 [info ] [MainThread]: 
[0m10:51:14.624477 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m10:51:14.625475 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m10:51:14.625475 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m10:51:14.626476 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m10:51:14.629991 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m10:51:14.630991 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 10:51:14.626476 => 10:51:14.630991
[0m10:51:14.630991 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m10:51:14.690690 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:14.690690 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp105114657646"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m10:51:14.691606 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:14.691606 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:14.691606 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:15.084706 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:15.105758 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.105758 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m10:51:15.156068 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:15.157686 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.158700 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp105114657646'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp105114657646'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp105114657646'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:51:15.379528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:15.398283 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.399275 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:15.585852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:15.607302 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.608420 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:15.765640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:15.783684 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.787287 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:15.787287 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp105114657646"
            );
[0m10:51:16.118507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:16.119520 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:16.120520 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp105114657646"
    )
[0m10:51:16.362349 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:16.382751 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m10:51:16.382751 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:51:16.383660 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m10:51:17.169011 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:17.171995 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 10:51:14.631992 => 10:51:17.170988
[0m10:51:17.172914 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m10:51:17.175006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86965648-2dff-4f2a-9ddd-6b65ffa6ab7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2079AA9B0>]}
[0m10:51:17.176001 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.55s]
[0m10:51:17.177734 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m10:51:17.180607 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:17.181613 [debug] [MainThread]: On master: BEGIN
[0m10:51:17.181613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:17.182610 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:17.182610 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:17.444164 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:17.445158 [debug] [MainThread]: On master: COMMIT
[0m10:51:17.446160 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:17.446160 [debug] [MainThread]: On master: COMMIT
[0m10:51:17.497811 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:17.498820 [debug] [MainThread]: On master: Close
[0m10:51:17.499827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:17.499827 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:51:17.499827 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:51:17.499827 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m10:51:17.500826 [info ] [MainThread]: 
[0m10:51:17.500826 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m10:51:17.501831 [debug] [MainThread]: Command end result
[0m10:51:17.514350 [info ] [MainThread]: 
[0m10:51:17.514350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:17.515625 [info ] [MainThread]: 
[0m10:51:17.515625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:51:17.517134 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:17.517134 after 6.09 seconds
[0m10:51:17.518161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E203CBDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2073F9FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2079EB760>]}
[0m10:51:17.518161 [debug] [MainThread]: Flushing usage events
[0m10:51:22.247109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA26D9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA549EF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA549CDF0>]}


============================== 10:51:22.252065 | ed52f24b-f8ab-4a10-839f-0f055c30c11b ==============================
[0m10:51:22.252065 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:22.252065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:22.428164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed52f24b-f8ab-4a10-839f-0f055c30c11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA549FA90>]}
[0m10:51:22.429197 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:22.431167 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:22.432189 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:22.432189 after 0.26 seconds
[0m10:51:22.432189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA26D9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA549EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA557ED70>]}
[0m10:51:22.433190 [debug] [MainThread]: Flushing usage events
[0m10:51:27.349536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD07DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD35A6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD35A4F10>]}


============================== 10:51:27.354534 | bb3c0e91-6a6b-4b13-9169-4998d3147ac4 ==============================
[0m10:51:27.354534 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:27.354534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:51:27.967386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD2F41540>]}
[0m10:51:28.112842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD3E28FA0>]}
[0m10:51:28.115379 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:51:28.125902 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:51:28.200038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:28.200038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:28.201039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:51:28.206045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD42D0A90>]}
[0m10:51:28.217074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD42A2320>]}
[0m10:51:28.218084 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:51:28.219085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD42A22F0>]}
[0m10:51:28.220085 [info ] [MainThread]: 
[0m10:51:28.220085 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:51:28.222090 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:51:28.238116 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:51:28.239117 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:51:28.239117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:28.244122 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:28.244122 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:28.807567 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:28.810429 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:51:28.813431 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:51:28.824946 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:28.825952 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:51:28.825952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:28.825952 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:28.827528 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:29.115557 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.117361 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:29.118239 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:51:29.224732 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.229299 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:51:29.296025 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:51:29.334266 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:29.334266 [debug] [MainThread]: On master: BEGIN
[0m10:51:29.335264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:29.335264 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:29.335264 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:29.591248 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.592240 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:29.593240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:51:29.727253 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.731292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD4530B20>]}
[0m10:51:29.732294 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:29.792385 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:29.793398 [debug] [MainThread]: On master: BEGIN
[0m10:51:29.818956 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.819950 [debug] [MainThread]: On master: COMMIT
[0m10:51:29.822948 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:29.823947 [debug] [MainThread]: On master: COMMIT
[0m10:51:29.870728 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:29.871797 [debug] [MainThread]: On master: Close
[0m10:51:29.873741 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:51:29.873741 [info ] [MainThread]: 
[0m10:51:29.889377 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m10:51:29.889377 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m10:51:29.890475 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m10:51:29.891486 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m10:51:29.894469 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m10:51:29.896384 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 10:51:29.891486 => 10:51:29.896384
[0m10:51:29.897386 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m10:51:29.956334 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:29.957309 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp105129923361"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m10:51:29.957309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:29.957894 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:29.957894 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:30.376132 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:30.395852 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:30.395852 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m10:51:30.460117 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:30.461099 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:30.462098 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp105129923361'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp105129923361'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp105129923361'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:51:30.684045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:30.702058 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:30.702058 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:30.904331 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:30.924742 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:30.924742 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:31.084885 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:31.106285 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m10:51:31.111914 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:31.112882 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp105129923361"
            );
[0m10:51:31.238121 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:31.238121 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:31.239125 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp105129923361"
    )
[0m10:51:31.359335 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:31.378274 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m10:51:31.378274 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:51:31.379354 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m10:51:31.770410 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:31.772484 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 10:51:29.897893 => 10:51:31.771433
[0m10:51:31.772484 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m10:51:31.773070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb3c0e91-6a6b-4b13-9169-4998d3147ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD44CAA40>]}
[0m10:51:31.774165 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 1.88s]
[0m10:51:31.774165 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m10:51:31.777291 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:31.778301 [debug] [MainThread]: On master: BEGIN
[0m10:51:31.778301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:31.779408 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:31.780378 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:32.044616 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:32.045617 [debug] [MainThread]: On master: COMMIT
[0m10:51:32.045617 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:32.047136 [debug] [MainThread]: On master: COMMIT
[0m10:51:32.105211 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:32.105211 [debug] [MainThread]: On master: Close
[0m10:51:32.106298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:32.106298 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:51:32.107295 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:51:32.107295 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m10:51:32.107887 [info ] [MainThread]: 
[0m10:51:32.107887 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m10:51:32.108974 [debug] [MainThread]: Command end result
[0m10:51:32.127658 [info ] [MainThread]: 
[0m10:51:32.128668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:32.129669 [info ] [MainThread]: 
[0m10:51:32.131666 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:51:32.137525 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:32.135667 after 4.86 seconds
[0m10:51:32.138378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD07DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD450BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD4508A00>]}
[0m10:51:32.139284 [debug] [MainThread]: Flushing usage events
[0m10:51:37.585371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C9DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49F79C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49F79D870>]}


============================== 10:51:37.592089 | 0dd7997e-a80b-4da1-9456-19545a0b07b8 ==============================
[0m10:51:37.592089 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:37.594092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:37.860504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dd7997e-a80b-4da1-9456-19545a0b07b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49F7DB340>]}
[0m10:51:37.865427 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:37.867013 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:37.868114 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:37.868114 after 0.38 seconds
[0m10:51:37.868114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49C9DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49F79F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49F79FB50>]}
[0m10:51:37.869118 [debug] [MainThread]: Flushing usage events
[0m10:51:42.965834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252437DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527140220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527142380>]}


============================== 10:51:42.971565 | e9210d1b-2761-4afe-b039-043d1019572e ==============================
[0m10:51:42.971565 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:42.972446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:43.623392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022526AE1510>]}
[0m10:51:43.777908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225271435B0>]}
[0m10:51:43.779640 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:51:43.792048 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:51:43.876064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:43.876064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:43.877497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:51:43.882522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527E70A60>]}
[0m10:51:43.893541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527E42230>]}
[0m10:51:43.894541 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:51:43.894541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022527E42320>]}
[0m10:51:43.895541 [info ] [MainThread]: 
[0m10:51:43.895541 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:51:43.899105 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:51:43.914575 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:51:43.915577 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:51:43.915577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:43.921095 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:43.921095 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:44.478482 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:44.480482 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:51:44.482496 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:51:44.492533 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:44.493533 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:51:44.493533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:44.493533 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:44.494533 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:44.773369 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:44.774359 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:51:44.774359 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:51:44.884874 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:44.890905 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:51:44.948333 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:51:44.986352 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:44.986352 [debug] [MainThread]: On master: BEGIN
[0m10:51:44.987349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:44.987859 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:44.988904 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:45.250709 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:45.251713 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:45.251713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:51:45.383851 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:45.387538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225280D0B50>]}
[0m10:51:45.387538 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:45.455818 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:45.455818 [debug] [MainThread]: On master: BEGIN
[0m10:51:45.482578 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:45.483594 [debug] [MainThread]: On master: COMMIT
[0m10:51:45.484593 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:45.484593 [debug] [MainThread]: On master: COMMIT
[0m10:51:45.535734 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:45.537238 [debug] [MainThread]: On master: Close
[0m10:51:45.538245 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:51:45.538245 [info ] [MainThread]: 
[0m10:51:45.549582 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m10:51:45.549582 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m10:51:45.550665 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m10:51:45.551674 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m10:51:45.554670 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m10:51:45.555663 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 10:51:45.551674 => 10:51:45.555663
[0m10:51:45.555663 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m10:51:45.622703 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:45.623703 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp105145583569"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m10:51:45.623703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:45.623703 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:45.624702 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:47.018312 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:47.038341 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.039345 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m10:51:47.085151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:47.086827 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.087596 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp105145583569'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp105145583569'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp105145583569'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:51:47.305646 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:47.319004 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.320009 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:47.510413 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:47.533462 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.533462 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:51:47.690503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:47.733319 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m10:51:47.743996 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.745999 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp105145583569"
            );
[0m10:51:47.922359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:47.923360 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:47.924360 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp105145583569"
    )
[0m10:51:48.200128 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:48.231407 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m10:51:48.232408 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:51:48.233420 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m10:51:49.163676 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:51:49.167351 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 10:51:45.555663 => 10:51:49.165763
[0m10:51:49.168406 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m10:51:49.171383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9210d1b-2761-4afe-b039-043d1019572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022528066BC0>]}
[0m10:51:49.172387 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 3.62s]
[0m10:51:49.174381 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m10:51:49.179419 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:49.180429 [debug] [MainThread]: On master: BEGIN
[0m10:51:49.181454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:49.182420 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:51:49.182420 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:51:49.460313 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:49.461406 [debug] [MainThread]: On master: COMMIT
[0m10:51:49.462315 [debug] [MainThread]: Using redshift connection "master"
[0m10:51:49.463323 [debug] [MainThread]: On master: COMMIT
[0m10:51:49.514699 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:51:49.515727 [debug] [MainThread]: On master: Close
[0m10:51:49.517402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:49.518419 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:51:49.519437 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:51:49.520433 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m10:51:49.521446 [info ] [MainThread]: 
[0m10:51:49.522441 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m10:51:49.524360 [debug] [MainThread]: Command end result
[0m10:51:49.548504 [info ] [MainThread]: 
[0m10:51:49.550520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:49.551517 [info ] [MainThread]: 
[0m10:51:49.552530 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:51:49.555574 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:49.554526 after 6.66 seconds
[0m10:51:49.555574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002252437DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225280ABC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225280ABA60>]}
[0m10:51:49.557352 [debug] [MainThread]: Flushing usage events
[0m10:51:54.338467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7C24DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F01C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F01F1C0>]}


============================== 10:51:54.343468 | 62d646c7-49af-44e2-b951-04dec992f911 ==============================
[0m10:51:54.343468 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:54.343468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:54.526268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62d646c7-49af-44e2-b951-04dec992f911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F01FAF0>]}
[0m10:51:54.527266 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:54.528917 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:54.529952 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:54.529952 after 0.27 seconds
[0m10:51:54.529952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7C24DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F01F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F087220>]}
[0m10:51:54.530946 [debug] [MainThread]: Flushing usage events
[0m10:51:59.094335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7BDECDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C0C90190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C0C931C0>]}


============================== 10:51:59.098825 | fbe4e2cc-10aa-4300-9d14-66694fae3725 ==============================
[0m10:51:59.098825 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:51:59.099825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:59.747319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C0CC6830>]}
[0m10:51:59.891743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1484910>]}
[0m10:51:59.893715 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:51:59.904700 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:51:59.976256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:59.976256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:59.977257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:51:59.981940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C19C09A0>]}
[0m10:51:59.999353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1992230>]}
[0m10:51:59.999353 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:52:00.000353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1992200>]}
[0m10:52:00.001357 [info ] [MainThread]: 
[0m10:52:00.001357 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:52:00.004797 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:52:00.025978 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:52:00.025978 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:52:00.025978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:00.031689 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:52:00.031689 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:52:00.553723 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:52:00.557466 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:52:00.560389 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:52:00.570192 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:52:00.570192 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:52:00.571098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:00.571098 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:52:00.571098 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:52:00.830731 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:00.831724 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:52:00.832722 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:52:00.940109 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:00.947100 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:52:01.003464 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:52:01.043270 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:01.043270 [debug] [MainThread]: On master: BEGIN
[0m10:52:01.044280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:01.044280 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:52:01.045270 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:52:01.311093 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:01.312179 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:01.312179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:52:01.444361 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:01.447357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1C20A90>]}
[0m10:52:01.447867 [debug] [MainThread]: On master: ROLLBACK
[0m10:52:01.511414 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:01.511414 [debug] [MainThread]: On master: BEGIN
[0m10:52:01.537224 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:01.538704 [debug] [MainThread]: On master: COMMIT
[0m10:52:01.539698 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:01.540698 [debug] [MainThread]: On master: COMMIT
[0m10:52:01.590223 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:01.591222 [debug] [MainThread]: On master: Close
[0m10:52:01.592233 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:52:01.593241 [info ] [MainThread]: 
[0m10:52:01.607485 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m10:52:01.608613 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m10:52:01.608613 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m10:52:01.609614 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m10:52:01.612612 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m10:52:01.615611 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 10:52:01.609614 => 10:52:01.614647
[0m10:52:01.615611 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m10:52:01.680098 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:01.680098 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp105201641643"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m10:52:01.681098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:01.681098 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:52:01.682093 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:52:04.142145 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m10:52:04.179942 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:04.180952 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m10:52:04.236369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:04.237827 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:04.239850 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp105201641643'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp105201641643'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp105201641643'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:52:04.449863 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:04.471930 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:04.472933 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:52:04.697199 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:04.741655 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:04.742564 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:52:04.900337 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:04.944232 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m10:52:04.950662 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:04.951674 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp105201641643"
            );
[0m10:52:05.383995 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:05.384996 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:05.384996 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp105201641643"
    )
[0m10:52:16.095498 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m10:52:16.131432 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:52:16.133422 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:52:16.134424 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:52:16.511843 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:16.514841 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 10:52:01.615611 => 10:52:16.513839
[0m10:52:16.515864 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m10:52:16.517394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe4e2cc-10aa-4300-9d14-66694fae3725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1D5BB20>]}
[0m10:52:16.517394 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 14.91s]
[0m10:52:16.519410 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m10:52:16.523475 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:16.524471 [debug] [MainThread]: On master: BEGIN
[0m10:52:16.524471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:16.525472 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:52:16.525472 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:52:16.869759 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:16.870783 [debug] [MainThread]: On master: COMMIT
[0m10:52:16.871783 [debug] [MainThread]: Using redshift connection "master"
[0m10:52:16.872799 [debug] [MainThread]: On master: COMMIT
[0m10:52:16.924974 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:52:16.925976 [debug] [MainThread]: On master: Close
[0m10:52:16.928563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:16.929563 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:52:16.929563 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:52:16.931078 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m10:52:16.932091 [info ] [MainThread]: 
[0m10:52:16.933089 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 16.93 seconds (16.93s).
[0m10:52:16.934089 [debug] [MainThread]: Command end result
[0m10:52:16.949794 [info ] [MainThread]: 
[0m10:52:16.950789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:16.951789 [info ] [MainThread]: 
[0m10:52:16.952786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:52:16.954787 [debug] [MainThread]: Command `dbt run` succeeded at 10:52:16.953786 after 17.94 seconds
[0m10:52:16.954787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7BDECDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C167BF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C1991390>]}
[0m10:52:16.955788 [debug] [MainThread]: Flushing usage events
[0m10:58:35.523473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C01EFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C04CBC250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C04CBD810>]}


============================== 10:58:35.527473 | 6dd37537-c202-4f92-a20a-8408082fa60b ==============================
[0m10:58:35.527473 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:58:35.528474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:35.708574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd37537-c202-4f92-a20a-8408082fa60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C04CBF100>]}
[0m10:58:35.708574 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:58:35.711172 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:58:35.712264 [debug] [MainThread]: Command `dbt deps` succeeded at 10:58:35.712264 after 0.26 seconds
[0m10:58:35.712264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C01EFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C04CBF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C04CBFB50>]}
[0m10:58:35.713267 [debug] [MainThread]: Flushing usage events
[0m10:58:40.072336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47C3D9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47F1A3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47F1A02B0>]}


============================== 10:58:40.077368 | 52d3823f-2fa9-468f-8e19-a2f855268297 ==============================
[0m10:58:40.077368 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:58:40.077368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:58:40.737571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d3823f-2fa9-468f-8e19-a2f855268297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47B482C20>]}
[0m10:58:40.875817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d3823f-2fa9-468f-8e19-a2f855268297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47F1C9A20>]}
[0m10:58:40.877775 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:58:40.888477 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:58:41.043693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:41.044767 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m10:58:41.059364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:58:41.064063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d3823f-2fa9-468f-8e19-a2f855268297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D400008640>]}
[0m10:58:41.075377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d3823f-2fa9-468f-8e19-a2f855268297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FDC6440>]}
[0m10:58:41.076377 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:58:41.076377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d3823f-2fa9-468f-8e19-a2f855268297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FDC6410>]}
[0m10:58:41.078376 [debug] [MainThread]: Command `dbt ls` succeeded at 10:58:41.078376 after 1.07 seconds
[0m10:58:41.078376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47C3D9E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FDC5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FDC6410>]}
[0m10:58:41.079377 [debug] [MainThread]: Flushing usage events
[0m10:58:46.078682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C375DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C651C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C651D810>]}


============================== 10:58:46.083194 | bfe95b7b-cf31-46a4-9fdd-c2e6ac070b19 ==============================
[0m10:58:46.083194 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:58:46.084194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:58:46.260702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfe95b7b-cf31-46a4-9fdd-c2e6ac070b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C651F100>]}
[0m10:58:46.262711 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:58:46.263711 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:58:46.264712 [debug] [MainThread]: Command `dbt deps` succeeded at 10:58:46.264712 after 0.26 seconds
[0m10:58:46.265712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C375DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C651F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C651FB50>]}
[0m10:58:46.265712 [debug] [MainThread]: Flushing usage events
[0m10:58:50.540868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2353DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C26302EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C26300790>]}


============================== 10:58:50.545967 | 2bbf6e51-7300-4247-8130-ff07178399a8 ==============================
[0m10:58:50.545967 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:58:50.545967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_provider_packages -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:51.160189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2633A830>]}
[0m10:58:51.307164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C26AF4910>]}
[0m10:58:51.308754 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:58:51.320359 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:58:51.405999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:51.406999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:51.406999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:58:51.411842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C27030A00>]}
[0m10:58:51.422608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C27002290>]}
[0m10:58:51.423611 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:58:51.423611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C27002260>]}
[0m10:58:51.424641 [info ] [MainThread]: 
[0m10:58:51.425650 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:58:51.427573 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:58:51.443771 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:58:51.444774 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:58:51.444774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:51.448772 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:51.450445 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:52.095640 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:52.098630 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:58:52.104169 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:58:52.111312 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:58:52.112315 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:58:52.112315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:52.112315 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:52.113315 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:52.463157 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:52.464162 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:58:52.466076 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:58:52.575173 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:52.582881 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:58:52.645271 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:58:52.683876 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:52.683876 [debug] [MainThread]: On master: BEGIN
[0m10:58:52.684879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:52.684879 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:52.684879 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:52.975375 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:52.976355 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:52.977355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:58:53.134487 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:53.141009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C27290AC0>]}
[0m10:58:53.142020 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:53.208842 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:53.210490 [debug] [MainThread]: On master: BEGIN
[0m10:58:53.245854 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:53.246955 [debug] [MainThread]: On master: COMMIT
[0m10:58:53.247962 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:53.247962 [debug] [MainThread]: On master: COMMIT
[0m10:58:53.302398 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:53.303580 [debug] [MainThread]: On master: Close
[0m10:58:53.305593 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:58:53.306592 [info ] [MainThread]: 
[0m10:58:53.323069 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m10:58:53.323069 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m10:58:53.324088 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m10:58:53.325090 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m10:58:53.328088 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m10:58:53.329070 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 10:58:53.325090 => 10:58:53.329070
[0m10:58:53.330069 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m10:58:53.388672 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:53.388672 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp105853355613"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m10:58:53.388672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:53.390272 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:53.390272 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:53.735611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:53.756096 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:53.756096 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m10:58:53.805609 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:53.806595 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:53.807605 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp105853355613'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp105853355613'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp105853355613'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:58:54.031494 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:54.048238 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.048238 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:58:54.240617 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:54.260936 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.260936 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:58:54.420446 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:54.446677 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.448678 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.450204 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp105853355613"
            );
[0m10:58:54.583111 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:54.584187 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.585189 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp105853355613"
    )
[0m10:58:54.774334 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:54.790693 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m10:58:54.791779 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m10:58:54.791779 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m10:58:55.551513 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:58:55.554557 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 10:58:53.330069 => 10:58:55.553527
[0m10:58:55.555607 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m10:58:55.557604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bbf6e51-7300-4247-8130-ff07178399a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C27226B00>]}
[0m10:58:55.558609 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.23s]
[0m10:58:55.558609 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m10:58:55.563127 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:55.564129 [debug] [MainThread]: On master: BEGIN
[0m10:58:55.564129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:55.565143 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:58:55.566122 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:58:55.830734 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:55.831751 [debug] [MainThread]: On master: COMMIT
[0m10:58:55.832763 [debug] [MainThread]: Using redshift connection "master"
[0m10:58:55.833763 [debug] [MainThread]: On master: COMMIT
[0m10:58:55.886205 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:58:55.888310 [debug] [MainThread]: On master: Close
[0m10:58:55.889325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:55.890308 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:58:55.890916 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:58:55.890916 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m10:58:55.892031 [info ] [MainThread]: 
[0m10:58:55.892923 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m10:58:55.892923 [debug] [MainThread]: Command end result
[0m10:58:55.903612 [info ] [MainThread]: 
[0m10:58:55.904701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:55.904701 [info ] [MainThread]: 
[0m10:58:55.904701 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:58:55.905732 [debug] [MainThread]: Command `dbt run` succeeded at 10:58:55.905732 after 5.44 seconds
[0m10:58:55.906697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2353DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C26CF7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2726B8B0>]}
[0m10:58:55.906697 [debug] [MainThread]: Flushing usage events
[0m10:59:00.508490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E824EFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E827CBE230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E827CBF250>]}


============================== 10:59:00.513084 | f9c135fd-25f9-4e9c-a13d-35ce4b018530 ==============================
[0m10:59:00.513084 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:00.513999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m10:59:00.686013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9c135fd-25f9-4e9c-a13d-35ce4b018530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E827CFF700>]}
[0m10:59:00.687013 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:00.689014 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:00.690525 [debug] [MainThread]: Command `dbt deps` succeeded at 10:59:00.690015 after 0.26 seconds
[0m10:59:00.690525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E824EFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E827CBFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E827CBE710>]}
[0m10:59:00.690525 [debug] [MainThread]: Flushing usage events
[0m10:59:05.068153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024635CDDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024638AA6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024638AA55A0>]}


============================== 10:59:05.073503 | 2f043187-7f5f-4488-85ad-9e48b068ad34 ==============================
[0m10:59:05.073503 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:05.074489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_providers -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:05.673370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024638AD6020>]}
[0m10:59:05.817831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024638AA7340>]}
[0m10:59:05.818821 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:59:05.830186 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:59:05.905954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:05.905954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:05.906948 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:59:05.911546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246397D0A60>]}
[0m10:59:05.922094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246397A2230>]}
[0m10:59:05.923092 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:59:05.923092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246397A2320>]}
[0m10:59:05.924725 [info ] [MainThread]: 
[0m10:59:05.924725 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:59:05.926613 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:59:05.941643 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:59:05.941643 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:59:05.942645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:05.946645 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:05.947646 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:06.452175 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:06.456269 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:59:06.460187 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:59:06.471425 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:06.471425 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:59:06.471425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:06.472418 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:06.472418 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:06.766627 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:06.767667 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:06.768668 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:59:06.878739 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:06.884353 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:59:06.944543 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:59:06.981481 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:06.982484 [debug] [MainThread]: On master: BEGIN
[0m10:59:06.982484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:06.983483 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:06.983483 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:07.240799 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:07.240799 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:07.241809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:59:07.376620 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:07.381367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024639A30AF0>]}
[0m10:59:07.381367 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:07.450108 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:07.451046 [debug] [MainThread]: On master: BEGIN
[0m10:59:07.479136 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:07.480817 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.481837 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:07.481837 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.535957 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:07.536941 [debug] [MainThread]: On master: Close
[0m10:59:07.538927 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:59:07.540519 [info ] [MainThread]: 
[0m10:59:07.560297 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m10:59:07.561427 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m10:59:07.562421 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m10:59:07.562421 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m10:59:07.565421 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m10:59:07.567404 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 10:59:07.562421 => 10:59:07.566421
[0m10:59:07.567404 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m10:59:07.633638 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:07.633638 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp105907593392"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m10:59:07.633638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:07.634636 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:07.634636 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:07.984081 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.026337 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.029253 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m10:59:08.091302 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.093311 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.094687 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp105907593392'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp105907593392'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp105907593392'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:59:08.316589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.350655 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.351661 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:08.544264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.579237 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.579237 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:08.737729 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.777758 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m10:59:08.781292 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.782322 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp105907593392"
            );
[0m10:59:08.904123 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:08.905555 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:08.906572 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp105907593392"
    )
[0m10:59:09.002206 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:09.016506 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m10:59:09.017471 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m10:59:09.018423 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m10:59:09.441521 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:09.445508 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 10:59:07.567404 => 10:59:09.444513
[0m10:59:09.445508 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m10:59:09.447515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f043187-7f5f-4488-85ad-9e48b068ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246399C6A10>]}
[0m10:59:09.448512 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 1.89s]
[0m10:59:09.448512 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m10:59:09.453042 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:09.454039 [debug] [MainThread]: On master: BEGIN
[0m10:59:09.455042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:09.455042 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:09.456040 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:09.708317 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:09.708317 [debug] [MainThread]: On master: COMMIT
[0m10:59:09.709359 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:09.710371 [debug] [MainThread]: On master: COMMIT
[0m10:59:09.760189 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:09.761441 [debug] [MainThread]: On master: Close
[0m10:59:09.763453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:09.763453 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:59:09.764450 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:59:09.764450 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m10:59:09.765449 [info ] [MainThread]: 
[0m10:59:09.766449 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m10:59:09.767449 [debug] [MainThread]: Command end result
[0m10:59:09.777968 [info ] [MainThread]: 
[0m10:59:09.778967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:09.778967 [info ] [MainThread]: 
[0m10:59:09.778967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:09.780667 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:09.780667 after 4.78 seconds
[0m10:59:09.781516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024635CDDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024639A0BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024639A0BA60>]}
[0m10:59:09.781516 [debug] [MainThread]: Flushing usage events
[0m10:59:14.522406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214766DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147949E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147949F250>]}


============================== 10:59:14.526408 | 569bb80b-4e35-4181-a0af-bf1c92e51ad1 ==============================
[0m10:59:14.526408 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:14.527407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:14.708709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '569bb80b-4e35-4181-a0af-bf1c92e51ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214794DF700>]}
[0m10:59:14.708709 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:14.711221 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:14.712222 [debug] [MainThread]: Command `dbt deps` succeeded at 10:59:14.712222 after 0.26 seconds
[0m10:59:14.713228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214766DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147949FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147949E710>]}
[0m10:59:14.713228 [debug] [MainThread]: Flushing usage events
[0m10:59:19.076205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED0BFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED39D6FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED39D5690>]}


============================== 10:59:19.080718 | 843b6adf-c893-46ea-9853-96b7c8dd18e8 ==============================
[0m10:59:19.080718 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:19.080718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:59:19.688849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED3361510>]}
[0m10:59:19.838791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED39D75B0>]}
[0m10:59:19.840500 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:59:19.853006 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:59:19.933483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:19.933483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:19.934473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:59:19.939428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED4700AC0>]}
[0m10:59:19.950587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED46D2290>]}
[0m10:59:19.951594 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:59:19.951594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED46D2380>]}
[0m10:59:19.952600 [info ] [MainThread]: 
[0m10:59:19.953601 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:59:19.956022 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:59:19.972053 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:59:19.972053 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:59:19.973058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:19.978153 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:19.979060 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:20.495342 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:20.498331 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:59:20.501925 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:59:20.510527 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:20.511427 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:59:20.511427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:20.511427 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:20.512427 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:20.751166 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:20.752160 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:20.753140 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:59:20.852163 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:20.855261 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:59:20.933338 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:59:20.970130 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:20.971499 [debug] [MainThread]: On master: BEGIN
[0m10:59:20.971499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:20.971499 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:20.972495 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:21.215328 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:21.216419 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:21.216419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:59:21.357724 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:21.364263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED4960B80>]}
[0m10:59:21.365266 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:21.425408 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:21.426442 [debug] [MainThread]: On master: BEGIN
[0m10:59:21.452532 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:21.455550 [debug] [MainThread]: On master: COMMIT
[0m10:59:21.456601 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:21.457601 [debug] [MainThread]: On master: COMMIT
[0m10:59:21.506486 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:21.507380 [debug] [MainThread]: On master: Close
[0m10:59:21.509375 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:59:21.510885 [info ] [MainThread]: 
[0m10:59:21.528943 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m10:59:21.528943 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m10:59:21.530450 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m10:59:21.531455 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m10:59:21.534475 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m10:59:21.535474 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 10:59:21.531455 => 10:59:21.535474
[0m10:59:21.536455 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m10:59:21.601169 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:21.602223 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp105921564241"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m10:59:21.602223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:21.603192 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:21.603192 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:22.937909 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:22.958518 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:22.960099 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m10:59:23.010288 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:23.010796 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:23.010796 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp105921564241'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp105921564241'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp105921564241'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:59:23.240339 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:23.255793 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:23.256702 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:23.450514 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:23.467959 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:23.468976 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:23.629605 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:23.646755 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m10:59:23.649926 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:23.651370 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp105921564241"
            );
[0m10:59:23.817936 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:23.818939 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:23.818939 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp105921564241"
    )
[0m10:59:24.088640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:24.107767 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m10:59:24.107767 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m10:59:24.108773 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m10:59:24.978885 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:24.981571 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 10:59:21.536455 => 10:59:24.980708
[0m10:59:24.982577 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m10:59:24.985499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '843b6adf-c893-46ea-9853-96b7c8dd18e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED4A6F790>]}
[0m10:59:24.987506 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 3.46s]
[0m10:59:24.988589 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m10:59:24.995205 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:24.996208 [debug] [MainThread]: On master: BEGIN
[0m10:59:24.997222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:24.998216 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:25.000205 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:25.256539 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:25.257639 [debug] [MainThread]: On master: COMMIT
[0m10:59:25.259796 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:25.260314 [debug] [MainThread]: On master: COMMIT
[0m10:59:25.306736 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:25.307807 [debug] [MainThread]: On master: Close
[0m10:59:25.310406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:25.311515 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:59:25.312500 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:59:25.312500 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m10:59:25.313502 [info ] [MainThread]: 
[0m10:59:25.314500 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m10:59:25.316500 [debug] [MainThread]: Command end result
[0m10:59:25.338576 [info ] [MainThread]: 
[0m10:59:25.338576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:25.338576 [info ] [MainThread]: 
[0m10:59:25.340083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:25.342183 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:25.342183 after 6.34 seconds
[0m10:59:25.343213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED0BFDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED493B970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED493BA30>]}
[0m10:59:25.345202 [debug] [MainThread]: Flushing usage events
[0m10:59:30.174191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015634469E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563722FA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563722FF70>]}


============================== 10:59:30.178281 | d0fdfbb9-9543-4f19-920a-8aafd5abcb95 ==============================
[0m10:59:30.178281 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:30.179297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:30.353887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0fdfbb9-9543-4f19-920a-8aafd5abcb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563722CDC0>]}
[0m10:59:30.354892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:30.355892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:59:30.356893 [debug] [MainThread]: Command `dbt deps` succeeded at 10:59:30.356893 after 0.25 seconds
[0m10:59:30.357892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015634469E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563722C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015637310C40>]}
[0m10:59:30.357892 [debug] [MainThread]: Flushing usage events
[0m10:59:34.751787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F1E5DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F4C201C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F4C22440>]}


============================== 10:59:34.756710 | 544671b6-2a45-4afc-9e26-8551504a8142 ==============================
[0m10:59:34.756710 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:59:34.756710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -m bss_paytv_users -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:35.380712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F274AEC0>]}
[0m10:59:35.519166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F4C23EB0>]}
[0m10:59:35.521799 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m10:59:35.533458 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m10:59:35.605388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:35.605388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:35.606389 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m10:59:35.611905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F5940A30>]}
[0m10:59:35.621982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F5912200>]}
[0m10:59:35.622988 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m10:59:35.622988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F59122F0>]}
[0m10:59:35.624991 [info ] [MainThread]: 
[0m10:59:35.625989 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:59:35.628073 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m10:59:35.643543 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m10:59:35.643543 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m10:59:35.644546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:35.652056 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:35.652056 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:36.162475 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:36.164568 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m10:59:36.166481 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m10:59:36.174263 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:36.175263 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m10:59:36.175263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:36.175263 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:36.176264 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:36.431580 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:36.432659 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m10:59:36.433663 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m10:59:36.723473 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:36.727523 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m10:59:36.813843 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m10:59:36.850379 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:36.850379 [debug] [MainThread]: On master: BEGIN
[0m10:59:36.850379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:36.851384 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:36.851384 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:37.420843 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:37.422367 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:37.423467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:59:37.570303 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:37.576208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F5BA0A90>]}
[0m10:59:37.576208 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:37.638335 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:37.639317 [debug] [MainThread]: On master: BEGIN
[0m10:59:37.665394 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:37.666430 [debug] [MainThread]: On master: COMMIT
[0m10:59:37.667416 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:37.668434 [debug] [MainThread]: On master: COMMIT
[0m10:59:37.717955 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:37.718982 [debug] [MainThread]: On master: Close
[0m10:59:37.720658 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m10:59:37.721644 [info ] [MainThread]: 
[0m10:59:37.738724 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m10:59:37.740252 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m10:59:37.741257 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m10:59:37.741257 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m10:59:37.745282 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m10:59:37.746278 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 10:59:37.742275 => 10:59:37.746278
[0m10:59:37.747258 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m10:59:37.811617 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:37.811617 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp105937776276"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m10:59:37.812618 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:37.812618 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:37.813618 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:40.010398 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m10:59:40.050268 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:40.051280 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m10:59:40.115685 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:40.117787 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:40.118783 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp105937776276'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp105937776276'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp105937776276'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:59:40.335545 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:40.372091 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:40.373085 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:40.576102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:40.613002 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:40.614007 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m10:59:40.773892 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:40.812648 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m10:59:40.818649 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:40.818649 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp105937776276"
            );
[0m10:59:41.159035 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:41.160743 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:41.161647 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp105937776276"
    )
[0m10:59:44.574721 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m10:59:44.611227 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:59:44.612318 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m10:59:44.613340 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m10:59:45.183673 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:59:45.185669 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 10:59:37.747258 => 10:59:45.184668
[0m10:59:45.186767 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m10:59:45.188654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '544671b6-2a45-4afc-9e26-8551504a8142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F5B94EB0>]}
[0m10:59:45.190169 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 7.45s]
[0m10:59:45.191189 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m10:59:45.195523 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:45.196541 [debug] [MainThread]: On master: BEGIN
[0m10:59:45.197540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:45.198520 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:59:45.200193 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:59:45.471649 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:45.473745 [debug] [MainThread]: On master: COMMIT
[0m10:59:45.474731 [debug] [MainThread]: Using redshift connection "master"
[0m10:59:45.475723 [debug] [MainThread]: On master: COMMIT
[0m10:59:45.526773 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:59:45.527776 [debug] [MainThread]: On master: Close
[0m10:59:45.528774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:45.531384 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m10:59:45.531384 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m10:59:45.532487 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m10:59:45.533494 [info ] [MainThread]: 
[0m10:59:45.534469 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.91 seconds (9.91s).
[0m10:59:45.536483 [debug] [MainThread]: Command end result
[0m10:59:45.558748 [info ] [MainThread]: 
[0m10:59:45.558748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:45.560359 [info ] [MainThread]: 
[0m10:59:45.561416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:45.562552 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:45.562552 after 10.88 seconds
[0m10:59:45.562552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F1E5DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F554CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238F59114B0>]}
[0m10:59:45.563635 [debug] [MainThread]: Flushing usage events
[0m14:05:45.333867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396429E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395427A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021395426F20>]}


============================== 14:05:45.340910 | 60901a8f-1fe1-45ca-992d-f50b2af8b44c ==============================
[0m14:05:45.340910 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:05:45.342008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.546365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60901a8f-1fe1-45ca-992d-f50b2af8b44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213953E20E0>]}
[0m14:05:45.547366 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:05:45.549369 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:05:45.550367 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:45.550367 after 0.32 seconds
[0m14:05:45.551366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021396429E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213954245E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213954274C0>]}
[0m14:05:45.552365 [debug] [MainThread]: Flushing usage events
[0m14:05:49.971087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2840FDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28310C130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28310F460>]}


============================== 14:05:49.979169 | 3cd23a4c-3144-4bf6-9399-ba818d08651f ==============================
[0m14:05:49.979169 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:05:49.979169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.587665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28472F9D0>]}
[0m14:05:50.743286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C286D255A0>]}
[0m14:05:50.745287 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:05:50.761292 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:05:50.777022 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:05:50.778036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C286E580D0>]}
[0m14:05:52.584526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:05:52.590610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2871B9E40>]}
[0m14:05:52.608637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2871BBFA0>]}
[0m14:05:52.609543 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:05:52.610544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd23a4c-3144-4bf6-9399-ba818d08651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C286EE82E0>]}
[0m14:05:52.610544 [warn ] [MainThread]: No nodes selected!
[0m14:05:52.611628 [debug] [MainThread]: Command `dbt ls` succeeded at 14:05:52.611628 after 2.75 seconds
[0m14:05:52.612629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2840FDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28715F4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28717C8E0>]}
[0m14:05:52.612629 [debug] [MainThread]: Flushing usage events
[0m14:07:56.674681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0B6D2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0A6D7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0A6D59F0>]}


============================== 14:07:56.678682 | 6565844c-a494-4f77-961a-4633cc9a2f21 ==============================
[0m14:07:56.678682 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:07:56.679682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:56.911892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6565844c-a494-4f77-961a-4633cc9a2f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0E037430>]}
[0m14:07:56.913894 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:07:56.914893 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:07:56.918901 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:56.918901 after 0.39 seconds
[0m14:07:56.919898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0B6D2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0A6D6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A0A6D7730>]}
[0m14:07:56.922901 [debug] [MainThread]: Flushing usage events
[0m14:08:04.322348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAEA3B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B9EAE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B9EAD360>]}


============================== 14:08:04.328350 | 144d595e-c362-45de-8ea2-cd8c466026ba ==============================
[0m14:08:04.328350 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:08:04.329351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:08:04.692371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144d595e-c362-45de-8ea2-cd8c466026ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD7C19C0>]}
[0m14:08:04.845212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '144d595e-c362-45de-8ea2-cd8c466026ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD7C0040>]}
[0m14:08:04.847131 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:08:04.857220 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:08:04.947996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:04.948992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:04.949993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:08:04.955994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '144d595e-c362-45de-8ea2-cd8c466026ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDF5C0D0>]}
[0m14:08:04.967993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '144d595e-c362-45de-8ea2-cd8c466026ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDE68DC0>]}
[0m14:08:04.969003 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:08:04.970001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144d595e-c362-45de-8ea2-cd8c466026ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDE68D00>]}
[0m14:08:04.971001 [warn ] [MainThread]: No nodes selected!
[0m14:08:04.972000 [debug] [MainThread]: Command `dbt ls` succeeded at 14:08:04.972000 after 0.80 seconds
[0m14:08:04.972998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAEA3B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD7C0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDE68DF0>]}
[0m14:08:04.972998 [debug] [MainThread]: Flushing usage events
[0m14:11:05.466317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001852095DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001851F967A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001851F965A20>]}


============================== 14:11:05.470325 | d4870cf8-79da-40c1-9455-319da3dbb0e2 ==============================
[0m14:11:05.470325 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:11:05.471422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:05.639087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4870cf8-79da-40c1-9455-319da3dbb0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185232CB460>]}
[0m14:11:05.640105 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:11:05.641089 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:11:05.642103 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:05.642103 after 0.27 seconds
[0m14:11:05.643106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001852095DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001851F967BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185233645E0>]}
[0m14:11:05.643106 [debug] [MainThread]: Flushing usage events
[0m14:11:12.259917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BDF7C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BDE7CE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BDE7CF490>]}


============================== 14:11:12.268430 | 82802497-3d09-45e7-91cb-3421279c6f2b ==============================
[0m14:11:12.268430 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:11:12.270441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:12.919391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82802497-3d09-45e7-91cb-3421279c6f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BDFE7FD90>]}
[0m14:11:13.211568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82802497-3d09-45e7-91cb-3421279c6f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE23E55A0>]}
[0m14:11:13.214576 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:11:13.228650 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:11:13.399469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:13.400978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:13.402517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:11:13.417138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82802497-3d09-45e7-91cb-3421279c6f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE28780D0>]}
[0m14:11:13.447300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82802497-3d09-45e7-91cb-3421279c6f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE2784EB0>]}
[0m14:11:13.449296 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:11:13.450806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82802497-3d09-45e7-91cb-3421279c6f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE2784DF0>]}
[0m14:11:13.455346 [warn ] [MainThread]: No nodes selected!
[0m14:11:13.463388 [debug] [MainThread]: Command `dbt ls` succeeded at 14:11:13.462378 after 1.34 seconds
[0m14:11:13.464392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BDF7C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE23E55A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BE2784EE0>]}
[0m14:11:13.466390 [debug] [MainThread]: Flushing usage events
[0m14:14:11.278156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A355959E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A354947A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A354947880>]}


============================== 14:14:11.285868 | e2933768-0e74-48e9-9688-9a8f21384765 ==============================
[0m14:14:11.285868 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:14:11.286785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:11.503507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2933768-0e74-48e9-9688-9a8f21384765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A354947BB0>]}
[0m14:14:11.504011 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:14:11.505016 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:14:11.506021 [debug] [MainThread]: Command `dbt deps` succeeded at 14:14:11.506021 after 0.32 seconds
[0m14:14:11.507021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A355959E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A354947BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A35835E410>]}
[0m14:14:11.507021 [debug] [MainThread]: Flushing usage events
[0m14:14:15.745839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C62F309E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C62E30E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C62E30F490>]}


============================== 14:14:15.757384 | dff5505a-a5ea-486a-bd02-cba8b0cd8086 ==============================
[0m14:14:15.757384 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:14:15.762381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:16.225572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dff5505a-a5ea-486a-bd02-cba8b0cd8086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C62F9BFD90>]}
[0m14:14:16.475849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dff5505a-a5ea-486a-bd02-cba8b0cd8086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C631F255A0>]}
[0m14:14:16.477892 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:14:16.491593 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:14:16.582111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:16.583110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:16.583638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:14:16.589645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dff5505a-a5ea-486a-bd02-cba8b0cd8086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6323B80D0>]}
[0m14:14:16.599159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dff5505a-a5ea-486a-bd02-cba8b0cd8086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6322D8EB0>]}
[0m14:14:16.600159 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:14:16.600159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dff5505a-a5ea-486a-bd02-cba8b0cd8086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6322D8DF0>]}
[0m14:14:16.601160 [warn ] [MainThread]: No nodes selected!
[0m14:14:16.602159 [debug] [MainThread]: Command `dbt ls` succeeded at 14:14:16.602159 after 1.04 seconds
[0m14:14:16.603160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C62F309E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C631F255A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6322D8EE0>]}
[0m14:14:16.603674 [debug] [MainThread]: Flushing usage events
[0m14:18:36.179115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CA929E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9927A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9927760>]}


============================== 14:18:36.185812 | 00c2b5ee-6566-4532-b454-a3fffb1c46a2 ==============================
[0m14:18:36.185812 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:18:36.185812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:36.594382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c2b5ee-6566-4532-b454-a3fffb1c46a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9927BB0>]}
[0m14:18:36.596384 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:18:36.598888 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:18:36.600882 [debug] [MainThread]: Command `dbt deps` succeeded at 14:18:36.600882 after 0.55 seconds
[0m14:18:36.601884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CA929E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9927BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9924670>]}
[0m14:18:36.602883 [debug] [MainThread]: Flushing usage events
[0m14:18:41.781439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E0212E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159DF21E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159DF21F490>]}


============================== 14:18:41.789673 | 7b1be035-25ec-4bf6-86c9-16735be7d4ef ==============================
[0m14:18:41.789673 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:18:41.790718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:42.315487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b1be035-25ec-4bf6-86c9-16735be7d4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E2B31390>]}
[0m14:18:42.575646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b1be035-25ec-4bf6-86c9-16735be7d4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E2E355A0>]}
[0m14:18:42.578160 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:18:42.599164 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:18:42.680895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:42.681893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:42.682891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:18:42.694549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b1be035-25ec-4bf6-86c9-16735be7d4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E32C80D0>]}
[0m14:18:42.711568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b1be035-25ec-4bf6-86c9-16735be7d4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E31D8E20>]}
[0m14:18:42.712569 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:18:42.713570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b1be035-25ec-4bf6-86c9-16735be7d4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E31D8D60>]}
[0m14:18:42.714569 [warn ] [MainThread]: No nodes selected!
[0m14:18:42.715572 [debug] [MainThread]: Command `dbt ls` succeeded at 14:18:42.715572 after 1.04 seconds
[0m14:18:42.717085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E0212E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E2E355A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E31D8E50>]}
[0m14:18:42.722171 [debug] [MainThread]: Flushing usage events
[0m14:41:05.446495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E077C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E067C7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E067C6F20>]}


============================== 14:41:05.451622 | d3ad153c-6f8e-4999-83e3-662499066b75 ==============================
[0m14:41:05.451622 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:41:05.453132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:05.678251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ad153c-6f8e-4999-83e3-662499066b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E067820E0>]}
[0m14:41:05.679236 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:41:05.681234 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:41:05.682233 [debug] [MainThread]: Command `dbt deps` succeeded at 14:41:05.682233 after 0.33 seconds
[0m14:41:05.682233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E077C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E067C45E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E067C74C0>]}
[0m14:41:05.683285 [debug] [MainThread]: Flushing usage events
[0m14:41:10.046746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0379DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D027AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D027AF4C0>]}


============================== 14:41:10.051746 | 8377703f-8452-401a-9b73-dc76b3a5d44c ==============================
[0m14:41:10.051746 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:41:10.051746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:10.530552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8377703f-8452-401a-9b73-dc76b3a5d44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D03E57EE0>]}
[0m14:41:10.695257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8377703f-8452-401a-9b73-dc76b3a5d44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D063C55A0>]}
[0m14:41:10.697171 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:41:10.707943 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:41:10.810980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m14:41:10.810980 [debug] [MainThread]: Partial parsing: added file: modeling://models\source.yml
[0m14:41:10.811980 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_users.sql
[0m14:41:10.811980 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_provider_packages.sql
[0m14:41:10.811980 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_user_packages.sql
[0m14:41:10.813553 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_providers.sql
[0m14:41:11.241741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:41:11.249296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8377703f-8452-401a-9b73-dc76b3a5d44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06B5BE80>]}
[0m14:41:11.263323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8377703f-8452-401a-9b73-dc76b3a5d44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0681FDC0>]}
[0m14:41:11.263829 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:41:11.264836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8377703f-8452-401a-9b73-dc76b3a5d44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0681FCD0>]}
[0m14:41:11.267867 [debug] [MainThread]: Command `dbt ls` succeeded at 14:41:11.267867 after 1.34 seconds
[0m14:41:11.268844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0379DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D063C55A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0681FC70>]}
[0m14:41:11.268844 [debug] [MainThread]: Flushing usage events
[0m14:41:48.370669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019295129E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019294127A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019294125A20>]}


============================== 14:41:48.375229 | 1c7719ee-5e80-4e8b-bc9b-b0583ad277a2 ==============================
[0m14:41:48.375229 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:41:48.376224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:48.620817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c7719ee-5e80-4e8b-bc9b-b0583ad277a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019297A8B460>]}
[0m14:41:48.621819 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:41:48.623325 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:41:48.625338 [debug] [MainThread]: Command `dbt deps` succeeded at 14:41:48.625338 after 0.37 seconds
[0m14:41:48.625338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019295129E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019294127BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019297B245E0>]}
[0m14:41:48.626336 [debug] [MainThread]: Flushing usage events
[0m14:41:54.276872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E77D7DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E76D8EFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E76D8F730>]}


============================== 14:41:54.281824 | 98a121aa-fbf9-492f-89b7-c8e7674accd5 ==============================
[0m14:41:54.281824 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:41:54.283382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_provider_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:41:54.784227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7A6B3EB0>]}
[0m14:41:55.015804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7A991D80>]}
[0m14:41:55.016716 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:41:55.034601 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:41:55.147792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:55.147792 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m14:41:55.332059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:41:55.340585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7AFBE9E0>]}
[0m14:41:55.419468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7AE7F910>]}
[0m14:41:55.420466 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:41:55.422476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7AEC7670>]}
[0m14:41:55.426667 [info ] [MainThread]: 
[0m14:41:55.427642 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:41:55.429629 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:41:55.446800 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:41:55.447876 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:41:55.447876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:55.453503 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:55.455527 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:56.257813 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:41:56.260805 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:41:56.264331 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:41:56.278951 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:41:56.279974 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:41:56.279974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:56.280878 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:56.281876 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:56.571131 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:56.573718 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:41:56.575734 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:41:56.683408 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:56.686418 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:41:56.760476 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:41:56.811268 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:56.812299 [debug] [MainThread]: On master: BEGIN
[0m14:41:56.813234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:56.813234 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:56.814375 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:57.175583 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:57.176679 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:57.176679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:41:57.315873 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:57.318954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7ACE9B40>]}
[0m14:41:57.321897 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:57.391674 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:57.391674 [debug] [MainThread]: On master: BEGIN
[0m14:41:57.416773 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:57.417730 [debug] [MainThread]: On master: COMMIT
[0m14:41:57.418639 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:57.418639 [debug] [MainThread]: On master: COMMIT
[0m14:41:57.468530 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:57.469531 [debug] [MainThread]: On master: Close
[0m14:41:57.473533 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:41:57.474765 [info ] [MainThread]: 
[0m14:41:57.493529 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m14:41:57.494054 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.bss_paytv_provider_packages .............. [RUN]
[0m14:41:57.495059 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m14:41:57.496078 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m14:41:57.498078 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m14:41:57.499059 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 14:41:57.496078 => 14:41:57.499059
[0m14:41:57.500058 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m14:41:57.554677 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m14:41:57.558737 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:41:57.559816 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m14:41:57.559816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:57.560698 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:57.561706 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:57.850973 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:57.851969 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m14:41:57.851969 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */


  create view "vplus_db_premium"."analytics"."bss_paytv_provider_packages__dbt_tmp" as (
    { 
    config(
        materialized='incremental',
        unique_key = 'id'
        )
}

select getdate() as upload_date,* from {source('rawdata_users','bss_paytv_provider_packages')}
  ) ;
[0m14:41:57.884824 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "{"
[0m14:41:57.884824 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: ROLLBACK
[0m14:41:57.941033 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 14:41:57.500058 => 14:41:57.940033
[0m14:41:57.942079 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m14:41:57.987252 [debug] [Thread-1 (]: Database Error in model bss_paytv_provider_packages (models\bss_paytv_provider_packages.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_provider_packages.sql
[0m14:41:57.990251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a121aa-fbf9-492f-89b7-c8e7674accd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7AE59D80>]}
[0m14:41:57.992244 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.bss_paytv_provider_packages ..... [[31mERROR[0m in 0.50s]
[0m14:41:57.994507 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m14:41:57.997511 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:57.998505 [debug] [MainThread]: On master: BEGIN
[0m14:41:57.999503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:58.000502 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:41:58.000502 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:41:58.251927 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:58.253611 [debug] [MainThread]: On master: COMMIT
[0m14:41:58.256581 [debug] [MainThread]: Using redshift connection "master"
[0m14:41:58.256581 [debug] [MainThread]: On master: COMMIT
[0m14:41:58.305384 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:41:58.307394 [debug] [MainThread]: On master: Close
[0m14:41:58.308391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:58.309412 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:41:58.309412 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:41:58.310398 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m14:41:58.310398 [info ] [MainThread]: 
[0m14:41:58.311398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m14:41:58.312398 [debug] [MainThread]: Command end result
[0m14:41:58.331609 [info ] [MainThread]: 
[0m14:41:58.332608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:58.332608 [info ] [MainThread]: 
[0m14:41:58.333604 [error] [MainThread]:   Database Error in model bss_paytv_provider_packages (models\bss_paytv_provider_packages.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_provider_packages.sql
[0m14:41:58.333604 [info ] [MainThread]: 
[0m14:41:58.336120 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:58.341100 [debug] [MainThread]: Command `dbt run` failed at 14:41:58.341100 after 4.18 seconds
[0m14:41:58.342100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E77D7DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7A991D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E7AF3D360>]}
[0m14:41:58.342100 [debug] [MainThread]: Flushing usage events
[0m14:42:07.076671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D8D1DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7D27A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7D27760>]}


============================== 14:42:07.086195 | 92b26dfd-886e-4912-8893-1ab364def033 ==============================
[0m14:42:07.086195 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:07.087210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:42:07.318326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92b26dfd-886e-4912-8893-1ab364def033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7D27BB0>]}
[0m14:42:07.319303 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:07.320218 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:07.321242 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:07.321242 after 0.40 seconds
[0m14:42:07.322283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D8D1DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7D27BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7D24670>]}
[0m14:42:07.323241 [debug] [MainThread]: Flushing usage events
[0m14:42:12.627476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267D4D2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267C4EFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267C4EDF30>]}


============================== 14:42:12.632494 | 3a3f1049-ba0e-4bc5-a2b3-01826fc6079f ==============================
[0m14:42:12.632494 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:12.634009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_providers -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:42:13.139469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226001B9300>]}
[0m14:42:13.350619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022600148220>]}
[0m14:42:13.351620 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:42:13.366966 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:42:13.447905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:13.448912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:13.449819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:42:13.454535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226005D5870>]}
[0m14:42:13.467174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002260046AC80>]}
[0m14:42:13.468174 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:42:13.469186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002260046ABC0>]}
[0m14:42:13.470177 [info ] [MainThread]: 
[0m14:42:13.472258 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:42:13.476287 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:42:13.488054 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:42:13.489035 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:42:13.489035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:13.497645 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:13.498626 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:13.977147 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:13.979230 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:42:13.982152 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:42:13.991694 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:13.993221 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:42:13.994229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:13.995299 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:13.996234 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:14.261687 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:14.263194 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:14.264202 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:42:14.371119 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:14.379674 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:42:14.440318 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:42:14.486421 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:14.487343 [debug] [MainThread]: On master: BEGIN
[0m14:42:14.487343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:14.488342 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:14.488342 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:14.733708 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:14.734635 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:14.735637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:42:14.941989 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:14.945693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226006157E0>]}
[0m14:42:14.945693 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:15.334800 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:15.335856 [debug] [MainThread]: On master: BEGIN
[0m14:42:15.453278 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:15.453278 [debug] [MainThread]: On master: COMMIT
[0m14:42:15.454219 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:15.455232 [debug] [MainThread]: On master: COMMIT
[0m14:42:15.677371 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:15.678379 [debug] [MainThread]: On master: Close
[0m14:42:15.679379 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:42:15.680381 [info ] [MainThread]: 
[0m14:42:15.693537 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m14:42:15.694795 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.bss_paytv_providers ...................... [RUN]
[0m14:42:15.695794 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m14:42:15.695794 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m14:42:15.698812 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m14:42:15.699794 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 14:42:15.696793 => 14:42:15.698812
[0m14:42:15.699794 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m14:42:15.753655 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m14:42:15.758674 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:42:15.759677 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m14:42:15.760677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:15.761676 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:15.761676 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:16.075605 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:16.076600 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m14:42:16.077598 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */


  create view "vplus_db_premium"."analytics"."bss_paytv_providers__dbt_tmp" as (
    { 
    config(
        materialized='incremental',
        unique_key = 'id'
        )
}

select getdate() as upload_date,* from {source('rawdata_users','bss_paytv_providers')}
  ) ;
[0m14:42:16.101742 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "{"
[0m14:42:16.103424 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: ROLLBACK
[0m14:42:16.161573 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 14:42:15.699794 => 14:42:16.161573
[0m14:42:16.162575 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m14:42:16.165848 [debug] [Thread-1 (]: Database Error in model bss_paytv_providers (models\bss_paytv_providers.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_providers.sql
[0m14:42:16.166777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3f1049-ba0e-4bc5-a2b3-01826fc6079f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226008A2D40>]}
[0m14:42:16.166777 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.bss_paytv_providers ............. [[31mERROR[0m in 0.47s]
[0m14:42:16.167812 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m14:42:16.170779 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:16.173387 [debug] [MainThread]: On master: BEGIN
[0m14:42:16.174328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:16.175327 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:16.176402 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:16.989845 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m14:42:16.990880 [debug] [MainThread]: On master: COMMIT
[0m14:42:16.991862 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:16.991862 [debug] [MainThread]: On master: COMMIT
[0m14:42:17.042003 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:17.043508 [debug] [MainThread]: On master: Close
[0m14:42:17.044521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:17.045517 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:42:17.046516 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:42:17.046516 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m14:42:17.047514 [info ] [MainThread]: 
[0m14:42:17.048516 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m14:42:17.049516 [debug] [MainThread]: Command end result
[0m14:42:17.131330 [info ] [MainThread]: 
[0m14:42:17.131330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:17.132409 [info ] [MainThread]: 
[0m14:42:17.133389 [error] [MainThread]:   Database Error in model bss_paytv_providers (models\bss_paytv_providers.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_providers.sql
[0m14:42:17.133980 [info ] [MainThread]: 
[0m14:42:17.133980 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:17.136063 [debug] [MainThread]: Command `dbt run` failed at 14:42:17.135023 after 4.62 seconds
[0m14:42:17.136063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267D4D2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002260035F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267C4A3070>]}
[0m14:42:17.138008 [debug] [MainThread]: Flushing usage events
[0m14:42:23.290127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EF0B9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EE0C7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EE0C6F20>]}


============================== 14:42:23.296651 | f53b7c3f-835f-4ea8-94b1-b72f982411ae ==============================
[0m14:42:23.296651 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:23.297649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:23.538484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f53b7c3f-835f-4ea8-94b1-b72f982411ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EE0820E0>]}
[0m14:42:23.540442 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:23.541404 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:23.543939 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:23.543939 after 0.40 seconds
[0m14:42:23.543939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EF0B9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EE0C45E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155EE0C74C0>]}
[0m14:42:23.544947 [debug] [MainThread]: Flushing usage events
[0m14:42:29.369134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C578171E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57718EFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57718F730>]}


============================== 14:42:29.377465 | 263b631e-122b-472e-8366-ce3229f51f93 ==============================
[0m14:42:29.377465 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:29.378462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:29.793125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57AAABEB0>]}
[0m14:42:29.949592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57AD91D80>]}
[0m14:42:29.951514 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:42:29.963193 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:42:30.026455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:30.027530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:30.028453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:42:30.035236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B251900>]}
[0m14:42:30.046439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B0EAD40>]}
[0m14:42:30.046439 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:42:30.047439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B0EAD10>]}
[0m14:42:30.048438 [info ] [MainThread]: 
[0m14:42:30.049439 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:42:30.051438 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:42:30.063406 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:42:30.064283 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:42:30.064283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:30.070289 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:30.072289 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:30.541163 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:30.544859 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:42:30.547856 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:42:30.555381 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:30.556417 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:42:30.556417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:30.557372 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:30.557372 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:30.800929 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:30.801947 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:30.804475 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:42:30.904844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:30.910853 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:42:30.964183 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:42:30.999332 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:31.000332 [debug] [MainThread]: On master: BEGIN
[0m14:42:31.000332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:31.001239 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:31.001239 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:31.252245 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:31.253385 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:31.254329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:42:31.388643 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:31.390653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B291330>]}
[0m14:42:31.391625 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:31.453447 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:31.454070 [debug] [MainThread]: On master: BEGIN
[0m14:42:31.478911 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:31.478911 [debug] [MainThread]: On master: COMMIT
[0m14:42:31.479923 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:31.481001 [debug] [MainThread]: On master: COMMIT
[0m14:42:31.537182 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:31.538195 [debug] [MainThread]: On master: Close
[0m14:42:31.538195 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:42:31.539792 [info ] [MainThread]: 
[0m14:42:31.551809 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m14:42:31.553316 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.bss_paytv_user_packages .................. [RUN]
[0m14:42:31.554324 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m14:42:31.554324 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m14:42:31.556340 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m14:42:31.557340 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 14:42:31.555323 => 14:42:31.557340
[0m14:42:31.558324 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m14:42:31.597057 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m14:42:31.599013 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:42:31.600046 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m14:42:31.600046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:31.601000 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:31.601965 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:31.837636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:31.838623 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m14:42:31.838623 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */


  create view "vplus_db_premium"."analytics"."bss_paytv_user_packages__dbt_tmp" as (
    { 
    config(
        materialized='incremental',
        unique_key = 'id'
        )
}

select getdate() as upload_date,* from {source('rawdata_users','bss_paytv_user_packages')}
  ) ;
[0m14:42:31.868998 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "{"
[0m14:42:31.869998 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: ROLLBACK
[0m14:42:31.917470 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 14:42:31.558324 => 14:42:31.917470
[0m14:42:31.919465 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m14:42:31.922463 [debug] [Thread-1 (]: Database Error in model bss_paytv_user_packages (models\bss_paytv_user_packages.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_user_packages.sql
[0m14:42:31.922463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263b631e-122b-472e-8366-ce3229f51f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B522D40>]}
[0m14:42:31.923969 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.bss_paytv_user_packages ......... [[31mERROR[0m in 0.37s]
[0m14:42:31.924983 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m14:42:31.928994 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:31.929992 [debug] [MainThread]: On master: BEGIN
[0m14:42:31.930994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:31.931994 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:31.931994 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:32.192224 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:32.193318 [debug] [MainThread]: On master: COMMIT
[0m14:42:32.194508 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:32.194508 [debug] [MainThread]: On master: COMMIT
[0m14:42:32.245978 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:32.247079 [debug] [MainThread]: On master: Close
[0m14:42:32.248077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:32.248077 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:42:32.249069 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:42:32.249069 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m14:42:32.250055 [info ] [MainThread]: 
[0m14:42:32.250055 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m14:42:32.251066 [debug] [MainThread]: Command end result
[0m14:42:32.316277 [info ] [MainThread]: 
[0m14:42:32.316277 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:32.317226 [info ] [MainThread]: 
[0m14:42:32.318295 [error] [MainThread]:   Database Error in model bss_paytv_user_packages (models\bss_paytv_user_packages.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_user_packages.sql
[0m14:42:32.318295 [info ] [MainThread]: 
[0m14:42:32.319280 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:32.320295 [debug] [MainThread]: Command `dbt run` failed at 14:42:32.320295 after 3.04 seconds
[0m14:42:32.321287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C578171E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B008190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57B284A00>]}
[0m14:42:32.321287 [debug] [MainThread]: Flushing usage events
[0m14:42:37.721697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028918CB9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917CC7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917CC7760>]}


============================== 14:42:37.727219 | 55ce1696-f10a-4429-9649-1c7c9f1f6c82 ==============================
[0m14:42:37.727219 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:37.728219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:37.903198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ce1696-f10a-4429-9649-1c7c9f1f6c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917CC7BB0>]}
[0m14:42:37.905240 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:37.906209 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:42:37.907216 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:37.907216 after 0.28 seconds
[0m14:42:37.910650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028918CB9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917CC7BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028917CC4670>]}
[0m14:42:37.911766 [debug] [MainThread]: Flushing usage events
[0m14:42:42.247583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289730ADE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289720BD270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289720BC700>]}


============================== 14:42:42.252093 | 2510304d-c0b6-4eb1-a69a-731bca30c470 ==============================
[0m14:42:42.252093 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:42:42.253596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_users -t analytics', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:42.670839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289720BF160>]}
[0m14:42:42.825583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975CC3430>]}
[0m14:42:42.826535 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:42:42.838189 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:42:42.897575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:42.898579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:42.899490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:42:42.904853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289761818D0>]}
[0m14:42:42.915321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897601ACE0>]}
[0m14:42:42.916284 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:42:42.917371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897601AC20>]}
[0m14:42:42.918395 [info ] [MainThread]: 
[0m14:42:42.919379 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:42:42.921290 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m14:42:42.931804 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m14:42:42.933315 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m14:42:42.934328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:42.940325 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:42.940325 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:43.346321 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:43.349288 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m14:42:43.351810 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m14:42:43.359509 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:43.360409 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m14:42:43.361412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:43.361412 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:43.362408 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:43.614314 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:43.616304 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m14:42:43.617301 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m14:42:43.720838 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:43.726441 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m14:42:43.785945 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m14:42:43.821471 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:43.822474 [debug] [MainThread]: On master: BEGIN
[0m14:42:43.822474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:43.824006 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:43.824006 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:44.068602 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:44.069590 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:44.070698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:42:44.203691 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:44.206715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289761C3DC0>]}
[0m14:42:44.206715 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:44.266085 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:44.267086 [debug] [MainThread]: On master: BEGIN
[0m14:42:44.292212 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:44.293212 [debug] [MainThread]: On master: COMMIT
[0m14:42:44.294577 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:44.295580 [debug] [MainThread]: On master: COMMIT
[0m14:42:44.341629 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:44.342594 [debug] [MainThread]: On master: Close
[0m14:42:44.344122 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m14:42:44.345162 [info ] [MainThread]: 
[0m14:42:44.357200 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m14:42:44.358203 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.bss_paytv_users .......................... [RUN]
[0m14:42:44.360201 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m14:42:44.361205 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m14:42:44.364728 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m14:42:44.365728 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 14:42:44.361205 => 14:42:44.365728
[0m14:42:44.366737 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m14:42:44.427988 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m14:42:44.429987 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:42:44.431991 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m14:42:44.431991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:44.433582 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:44.434526 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:44.705572 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:44.705572 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m14:42:44.706571 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */


  create view "vplus_db_premium"."analytics"."bss_paytv_users__dbt_tmp" as (
    { 
    config(
        materialized='incremental',
        unique_key = 'id'
        )
}

select getdate() as upload_date,* from {source('rawdata_users','bss_paytv_users')}
  ) ;
[0m14:42:44.735337 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "{"
[0m14:42:44.735337 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: ROLLBACK
[0m14:42:44.789744 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 14:42:44.367737 => 14:42:44.789744
[0m14:42:44.790742 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m14:42:44.794256 [debug] [Thread-1 (]: Database Error in model bss_paytv_users (models\bss_paytv_users.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_users.sql
[0m14:42:44.794256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2510304d-c0b6-4eb1-a69a-731bca30c470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028976452CE0>]}
[0m14:42:44.795258 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.bss_paytv_users ................. [[31mERROR[0m in 0.44s]
[0m14:42:44.796262 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m14:42:44.799263 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:44.800263 [debug] [MainThread]: On master: BEGIN
[0m14:42:44.800263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:44.801265 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:42:44.801265 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:42:45.077052 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:45.078059 [debug] [MainThread]: On master: COMMIT
[0m14:42:45.078059 [debug] [MainThread]: Using redshift connection "master"
[0m14:42:45.079078 [debug] [MainThread]: On master: COMMIT
[0m14:42:45.130720 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:42:45.131806 [debug] [MainThread]: On master: Close
[0m14:42:45.133380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:45.134333 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m14:42:45.134333 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m14:42:45.134333 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m14:42:45.135332 [info ] [MainThread]: 
[0m14:42:45.135332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m14:42:45.136326 [debug] [MainThread]: Command end result
[0m14:42:45.191485 [info ] [MainThread]: 
[0m14:42:45.192414 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:45.192414 [info ] [MainThread]: 
[0m14:42:45.193413 [error] [MainThread]:   Database Error in model bss_paytv_users (models\bss_paytv_users.sql)
  syntax error at or near "{"
  compiled Code at target\run\modeling\models\bss_paytv_users.sql
[0m14:42:45.193413 [info ] [MainThread]: 
[0m14:42:45.193413 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:45.197598 [debug] [MainThread]: Command `dbt run` failed at 14:42:45.197598 after 3.04 seconds
[0m14:42:45.198599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289730ADE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975F3DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975D65BD0>]}
[0m14:42:45.198599 [debug] [MainThread]: Flushing usage events
[0m14:44:59.467537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D272DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D1737A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D1736F20>]}


============================== 14:44:59.477064 | f3110d76-9177-4425-90a8-9707481fb701 ==============================
[0m14:44:59.477064 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:44:59.479063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:44:59.927136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3110d76-9177-4425-90a8-9707481fb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D16F20E0>]}
[0m14:44:59.929132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:44:59.930135 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:44:59.931134 [debug] [MainThread]: Command `dbt deps` succeeded at 14:44:59.931134 after 0.68 seconds
[0m14:44:59.932192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D272DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D17345E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254D17374C0>]}
[0m14:44:59.932192 [debug] [MainThread]: Flushing usage events
[0m14:45:06.679523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728861E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72786E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72786F490>]}


============================== 14:45:06.690864 | 76bfc673-86a5-445e-8fcf-c206ed7992f9 ==============================
[0m14:45:06.690864 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:45:06.690864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:45:07.174417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76bfc673-86a5-445e-8fcf-c206ed7992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728F1FD90>]}
[0m14:45:07.356357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76bfc673-86a5-445e-8fcf-c206ed7992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B4955A0>]}
[0m14:45:07.358104 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:45:07.372707 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:45:07.467475 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 0 files added, 0 files changed.
[0m14:45:07.469385 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_provider_packages.sql
[0m14:45:07.469385 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_users.sql
[0m14:45:07.470422 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_user_packages.sql
[0m14:45:07.470422 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_providers.sql
[0m14:45:07.475945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:45:07.484503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76bfc673-86a5-445e-8fcf-c206ed7992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B9500D0>]}
[0m14:45:07.493861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76bfc673-86a5-445e-8fcf-c206ed7992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B7D6A40>]}
[0m14:45:07.494958 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:45:07.495861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bfc673-86a5-445e-8fcf-c206ed7992f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B7D6980>]}
[0m14:45:07.495861 [warn ] [MainThread]: No nodes selected!
[0m14:45:07.497865 [debug] [MainThread]: Command `dbt ls` succeeded at 14:45:07.497865 after 0.95 seconds
[0m14:45:07.499893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D728861E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B4955A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72B7D6A70>]}
[0m14:45:07.500877 [debug] [MainThread]: Flushing usage events
[0m14:46:56.646690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134817E2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134807F7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134807F59F0>]}


============================== 14:46:56.655425 | f628cb87-262a-43fc-bce6-12a0e158c1ea ==============================
[0m14:46:56.655425 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:46:56.657422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:57.026438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f628cb87-262a-43fc-bce6-12a0e158c1ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001348411B430>]}
[0m14:46:57.028438 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:57.030436 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:46:57.032990 [debug] [MainThread]: Command `dbt deps` succeeded at 14:46:57.032455 after 0.54 seconds
[0m14:46:57.032990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134817E2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134807F6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134807F7730>]}
[0m14:46:57.034996 [debug] [MainThread]: Flushing usage events
[0m14:47:03.683045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E67C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E57CE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E57CF4C0>]}


============================== 14:47:03.689567 | 5f8a1a1a-0277-427f-a920-05571bc37372 ==============================
[0m14:47:03.689567 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:47:03.690566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:04.272597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f8a1a1a-0277-427f-a920-05571bc37372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E6E7E4A0>]}
[0m14:47:04.445897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f8a1a1a-0277-427f-a920-05571bc37372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E57CF640>]}
[0m14:47:04.447457 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:47:04.459090 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:47:04.563656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:47:04.564652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:47:04.565634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:47:04.573292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f8a1a1a-0277-427f-a920-05571bc37372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E98780D0>]}
[0m14:47:04.583307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f8a1a1a-0277-427f-a920-05571bc37372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E9788E80>]}
[0m14:47:04.584307 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:47:04.585311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8a1a1a-0277-427f-a920-05571bc37372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E9788DC0>]}
[0m14:47:04.587311 [warn ] [MainThread]: No nodes selected!
[0m14:47:04.588870 [debug] [MainThread]: Command `dbt ls` succeeded at 14:47:04.588870 after 1.01 seconds
[0m14:47:04.588870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E67C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E57CF640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E9788EB0>]}
[0m14:47:04.589844 [debug] [MainThread]: Flushing usage events
[0m14:50:45.931636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2B0BDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2A0C7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2A0C6F20>]}


============================== 14:50:45.937573 | 65a7c2d6-1a27-4fca-916e-c341bf6128d0 ==============================
[0m14:50:45.937573 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:50:45.938580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:50:46.140386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a7c2d6-1a27-4fca-916e-c341bf6128d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2A0820E0>]}
[0m14:50:46.141387 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:50:46.142389 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:50:46.144390 [debug] [MainThread]: Command `dbt deps` succeeded at 14:50:46.144390 after 0.31 seconds
[0m14:50:46.144390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2B0BDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2A0C45E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2A0C74C0>]}
[0m14:50:46.145386 [debug] [MainThread]: Flushing usage events
[0m14:50:50.533775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247385E1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247375EE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247375EF4C0>]}


============================== 14:50:50.538281 | d773086e-6efb-4e2b-9a11-b6bae6c0ed32 ==============================
[0m14:50:50.538281 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:50:50.538281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:50.936491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd773086e-6efb-4e2b-9a11-b6bae6c0ed32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024738C9A4A0>]}
[0m14:50:51.094536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd773086e-6efb-4e2b-9a11-b6bae6c0ed32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247375EF640>]}
[0m14:50:51.096092 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:50:51.107169 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:50:51.187579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:50:51.188083 [debug] [MainThread]: Partial parsing: added file: modeling://models\source.yml
[0m14:50:51.330923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:50:51.337421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd773086e-6efb-4e2b-9a11-b6bae6c0ed32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473B819A80>]}
[0m14:50:51.349469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd773086e-6efb-4e2b-9a11-b6bae6c0ed32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473B663D00>]}
[0m14:50:51.349469 [info ] [MainThread]: Found 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:50:51.350469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd773086e-6efb-4e2b-9a11-b6bae6c0ed32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473B663D90>]}
[0m14:50:51.352467 [debug] [MainThread]: Command `dbt ls` succeeded at 14:50:51.352467 after 0.91 seconds
[0m14:50:51.353469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247385E1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247375EF640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473B663DF0>]}
[0m14:50:51.353469 [debug] [MainThread]: Flushing usage events
[0m14:52:28.739016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C1959E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C0967A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C0966F20>]}


============================== 14:52:28.744631 | 6dbcfe46-a39b-48c2-9338-0485d13bc35e ==============================
[0m14:52:28.744631 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:52:28.745584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:52:28.954262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dbcfe46-a39b-48c2-9338-0485d13bc35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C09220E0>]}
[0m14:52:28.955145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:52:28.956143 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:52:28.958145 [debug] [MainThread]: Command `dbt deps` succeeded at 14:52:28.957145 after 0.33 seconds
[0m14:52:28.958145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C1959E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C09645E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C09674C0>]}
[0m14:52:28.959143 [debug] [MainThread]: Flushing usage events
[0m14:52:33.593447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF83FAE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF73FD3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF73FDB10>]}


============================== 14:52:33.598372 | c356dcfa-e36e-4f7c-ab51-058399058272 ==============================
[0m14:52:33.598372 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:52:33.598372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:34.022247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c356dcfa-e36e-4f7c-ab51-058399058272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFAD119C0>]}
[0m14:52:34.206112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c356dcfa-e36e-4f7c-ab51-058399058272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB003AF0>]}
[0m14:52:34.208092 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:52:34.221151 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:52:34.299470 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:52:34.305987 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:52:34.313688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c356dcfa-e36e-4f7c-ab51-058399058272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB4C00D0>]}
[0m14:52:34.324632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c356dcfa-e36e-4f7c-ab51-058399058272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB3A9840>]}
[0m14:52:34.325640 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:52:34.326650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c356dcfa-e36e-4f7c-ab51-058399058272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB3A9780>]}
[0m14:52:34.327648 [warn ] [MainThread]: No nodes selected!
[0m14:52:34.328646 [debug] [MainThread]: Command `dbt ls` succeeded at 14:52:34.328646 after 0.84 seconds
[0m14:52:34.329647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF83FAE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB003AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFB3A9870>]}
[0m14:52:34.331649 [debug] [MainThread]: Flushing usage events
[0m14:58:57.664351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DC06B2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DBF6C7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DBF6C59F0>]}


============================== 14:58:57.669756 | 6cb59f87-a8d9-4110-8fad-f46738456679 ==============================
[0m14:58:57.669756 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:58:57.670358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:57.860048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb59f87-a8d9-4110-8fad-f46738456679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DC3027430>]}
[0m14:58:57.861053 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:57.862054 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:58:57.863054 [debug] [MainThread]: Command `dbt deps` succeeded at 14:58:57.863054 after 0.29 seconds
[0m14:58:57.863054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DC06B2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DBF6C6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DBF6C7730>]}
[0m14:58:57.864559 [debug] [MainThread]: Flushing usage events
[0m14:59:02.129040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08C88AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08B89E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08B89F490>]}


============================== 14:59:02.133032 | 70f9cae7-936a-4c4b-9334-713cb372d879 ==============================
[0m14:59:02.133032 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:59:02.133032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m14:59:02.529889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70f9cae7-936a-4c4b-9334-713cb372d879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F1BD390>]}
[0m14:59:02.754501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70f9cae7-936a-4c4b-9334-713cb372d879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F4B55A0>]}
[0m14:59:02.755515 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m14:59:02.767084 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m14:59:02.857356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:02.858344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:02.858344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m14:59:02.864338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70f9cae7-936a-4c4b-9334-713cb372d879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F9480D0>]}
[0m14:59:02.874595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70f9cae7-936a-4c4b-9334-713cb372d879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F868E20>]}
[0m14:59:02.875855 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m14:59:02.876860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f9cae7-936a-4c4b-9334-713cb372d879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F868D60>]}
[0m14:59:02.877857 [warn ] [MainThread]: No nodes selected!
[0m14:59:02.878856 [debug] [MainThread]: Command `dbt ls` succeeded at 14:59:02.878856 after 0.84 seconds
[0m14:59:02.879853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08C88AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F4B55A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08F868E50>]}
[0m14:59:02.879853 [debug] [MainThread]: Flushing usage events
[0m15:03:28.098335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93555DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C934567A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C934566F20>]}


============================== 15:03:28.104527 | 0b1e5bd1-43f3-4e33-be2e-c658411af557 ==============================
[0m15:03:28.104527 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:03:28.105625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:03:28.294716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1e5bd1-43f3-4e33-be2e-c658411af557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9345220E0>]}
[0m15:03:28.295727 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:03:28.297234 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:03:28.298243 [debug] [MainThread]: Command `dbt deps` succeeded at 15:03:28.298243 after 0.29 seconds
[0m15:03:28.299245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93555DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9345645E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9345674C0>]}
[0m15:03:28.299245 [debug] [MainThread]: Flushing usage events
[0m15:03:32.609283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C1EEFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C0EFE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C0EFD360>]}


============================== 15:03:32.613280 | 531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc ==============================
[0m15:03:32.613280 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:03:32.614197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:03:32.995154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C481D9C0>]}
[0m15:03:33.148453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C481C040>]}
[0m15:03:33.150238 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:03:33.161357 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:03:33.250807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m15:03:33.251803 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_user_packages.sql
[0m15:03:33.252725 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_users.sql
[0m15:03:33.252725 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_providers.sql
[0m15:03:33.253720 [debug] [MainThread]: Partial parsing: added file: modeling://models\source.yml
[0m15:03:33.253720 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_provider_packages.sql
[0m15:03:33.715427 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:03:33.720166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C52AFE50>]}
[0m15:03:33.732608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C4F6FD00>]}
[0m15:03:33.732608 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:03:33.733642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '531e2289-1e8d-41cc-aa1d-f4dcd5fa56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C4F6FD90>]}
[0m15:03:33.735775 [debug] [MainThread]: Command `dbt ls` succeeded at 15:03:33.735775 after 1.21 seconds
[0m15:03:33.737281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C1EEFB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C481C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169C4F6FDF0>]}
[0m15:03:33.737281 [debug] [MainThread]: Flushing usage events
[0m15:07:34.770574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FBDDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EBE7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EBE7760>]}


============================== 15:07:34.779644 | a143bc62-0e08-417f-95e3-81fd1af5d6c6 ==============================
[0m15:07:34.779644 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:07:34.781147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:07:35.047603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a143bc62-0e08-417f-95e3-81fd1af5d6c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EBE7BB0>]}
[0m15:07:35.049572 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:07:35.050571 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:07:35.052077 [debug] [MainThread]: Command `dbt deps` succeeded at 15:07:35.052077 after 0.41 seconds
[0m15:07:35.052077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11FBDDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EBE7BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C11EBE4670>]}
[0m15:07:35.053083 [debug] [MainThread]: Flushing usage events
[0m15:07:41.174923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734C431E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734B44D270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734B44C700>]}


============================== 15:07:41.181572 | 5012ebfb-f4bf-4528-953e-bfebbd21caeb ==============================
[0m15:07:41.181572 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:07:41.182525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_provider_packages -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:07:41.850056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734B44F160>]}
[0m15:07:42.084376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F053430>]}
[0m15:07:42.087381 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:07:42.099806 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:07:42.248338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:42.248338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:42.249310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:07:42.256874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F515870>]}
[0m15:07:42.274716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F3AAC80>]}
[0m15:07:42.275717 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:07:42.275717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F3AABC0>]}
[0m15:07:42.277792 [info ] [MainThread]: 
[0m15:07:42.278716 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:07:42.281302 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:07:42.297073 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:07:42.298005 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:07:42.298005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:42.306604 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:42.307600 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:42.839341 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:07:42.840423 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:07:42.843931 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:07:42.854500 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:07:42.855610 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:07:42.856519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:42.857490 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:42.858534 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:43.267488 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:43.269497 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:07:43.271492 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:07:43.518832 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:43.524358 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:07:43.636586 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:07:43.710104 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:43.711613 [debug] [MainThread]: On master: BEGIN
[0m15:07:43.711613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:43.712622 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:43.713622 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:44.107124 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:44.108127 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:44.109126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:07:44.248442 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:44.253666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F5541C0>]}
[0m15:07:44.254667 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:44.327087 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:44.328097 [debug] [MainThread]: On master: BEGIN
[0m15:07:44.357531 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:44.358531 [debug] [MainThread]: On master: COMMIT
[0m15:07:44.359530 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:44.359530 [debug] [MainThread]: On master: COMMIT
[0m15:07:44.413505 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:44.414581 [debug] [MainThread]: On master: Close
[0m15:07:44.416490 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:07:44.418521 [info ] [MainThread]: 
[0m15:07:44.437615 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m15:07:44.439615 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m15:07:44.440618 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m15:07:44.442277 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m15:07:44.446364 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m15:07:44.449287 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 15:07:44.442277 => 15:07:44.448287
[0m15:07:44.450290 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m15:07:44.618993 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:44.619916 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp150744493194"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m15:07:44.619916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:44.621423 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:44.621423 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:48.496567 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m15:07:48.517771 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:48.517771 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m15:07:48.639402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:48.640449 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:48.641940 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp150744493194'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp150744493194'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp150744493194'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:07:48.864883 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:48.883311 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:48.884336 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:07:49.083651 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:49.107803 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:49.109727 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:07:49.287633 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:49.308665 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m15:07:49.313032 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:49.317024 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp150744493194"
            );
[0m15:07:49.531448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:49.532418 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:49.533415 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp150744493194"
    )
[0m15:07:54.709619 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m15:07:54.733708 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:07:54.734690 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:07:54.735611 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:07:55.186641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:55.187738 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 15:07:44.451297 => 15:07:55.187738
[0m15:07:55.188785 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m15:07:55.189686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5012ebfb-f4bf-4528-953e-bfebbd21caeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F0F9120>]}
[0m15:07:55.191230 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 10.75s]
[0m15:07:55.194291 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m15:07:55.199238 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:55.200238 [debug] [MainThread]: On master: BEGIN
[0m15:07:55.201238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:55.201744 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:07:55.202752 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:07:55.534491 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:55.535474 [debug] [MainThread]: On master: COMMIT
[0m15:07:55.535474 [debug] [MainThread]: Using redshift connection "master"
[0m15:07:55.535474 [debug] [MainThread]: On master: COMMIT
[0m15:07:55.589397 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:07:55.590413 [debug] [MainThread]: On master: Close
[0m15:07:55.595688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:55.596684 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:07:55.597684 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:07:55.597684 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m15:07:55.598680 [info ] [MainThread]: 
[0m15:07:55.599680 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.32 seconds (13.32s).
[0m15:07:55.600679 [debug] [MainThread]: Command end result
[0m15:07:55.614270 [info ] [MainThread]: 
[0m15:07:55.615350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:55.615350 [info ] [MainThread]: 
[0m15:07:55.616269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:07:55.618345 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:55.617275 after 14.56 seconds
[0m15:07:55.619269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734C431E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F1A7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734F2C9B10>]}
[0m15:07:55.619269 [debug] [MainThread]: Flushing usage events
[0m15:08:03.207372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9FDE59E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E980887A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E980886F20>]}


============================== 15:08:03.212522 | 92f7799f-b9d3-4314-8ff1-629f4681f5d0 ==============================
[0m15:08:03.212522 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:03.213516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:08:03.471729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92f7799f-b9d3-4314-8ff1-629f4681f5d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9808420E0>]}
[0m15:08:03.472743 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:03.474748 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:03.475748 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:03.475748 after 0.40 seconds
[0m15:08:03.476747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9FDE59E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9808845E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9808874C0>]}
[0m15:08:03.476747 [debug] [MainThread]: Flushing usage events
[0m15:08:10.200511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF12EDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF02FD270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF02FC700>]}


============================== 15:08:10.207013 | a71feee0-9a3b-4e71-b486-dbf48bc6282d ==============================
[0m15:08:10.207013 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:10.207922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_providers -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:10.825884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF02FF160>]}
[0m15:08:11.048286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF3F03430>]}
[0m15:08:11.050171 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:08:11.064805 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:08:11.139800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:11.139800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:11.141369 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:11.148323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF43C5870>]}
[0m15:08:11.168632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF425AC80>]}
[0m15:08:11.169658 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:08:11.169658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF425ABC0>]}
[0m15:08:11.171697 [info ] [MainThread]: 
[0m15:08:11.172293 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:11.175302 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:11.190091 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:11.191702 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:11.191702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:11.202223 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:11.202223 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:11.713101 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:11.715066 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:11.718111 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:11.727595 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:11.728597 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:11.729607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:11.731594 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:11.732101 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:12.013440 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.015452 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:12.016457 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:12.124335 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.133406 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:12.203334 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:12.255567 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:12.256492 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.256492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:12.257484 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:12.258481 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:12.553029 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.554028 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:12.555029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:12.697482 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.700469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF44041C0>]}
[0m15:08:12.700469 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:12.764716 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:12.765725 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.793490 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.794916 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.797941 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:12.799926 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.851790 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:12.852800 [debug] [MainThread]: On master: Close
[0m15:08:12.854813 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:12.854813 [info ] [MainThread]: 
[0m15:08:12.872861 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m15:08:12.873861 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m15:08:12.876859 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m15:08:12.877859 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m15:08:12.884388 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m15:08:12.886389 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 15:08:12.878859 => 15:08:12.885388
[0m15:08:12.886389 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m15:08:13.097650 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:13.098613 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp150812943269"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m15:08:13.099613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:13.100614 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:13.100614 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:14.504236 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:14.530065 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:14.531574 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m15:08:14.578621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:14.579622 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:14.580623 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp150812943269'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp150812943269'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp150812943269'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:08:14.796669 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:14.814143 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:14.815071 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:15.007658 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:15.035192 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:15.036096 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:15.193440 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:15.217720 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m15:08:15.221302 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:15.222309 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp150812943269"
            );
[0m15:08:15.432412 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:15.433503 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:15.434479 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp150812943269"
    )
[0m15:08:15.523444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:15.547355 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:08:15.549318 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:08:15.549318 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:08:15.938590 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:15.944128 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 15:08:12.887393 => 15:08:15.943126
[0m15:08:15.946119 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m15:08:15.948118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71feee0-9a3b-4e71-b486-dbf48bc6282d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF3FA87C0>]}
[0m15:08:15.950119 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 3.07s]
[0m15:08:15.951727 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m15:08:15.954638 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:15.955654 [debug] [MainThread]: On master: BEGIN
[0m15:08:15.956638 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:15.958644 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:15.959651 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:16.446321 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:16.447400 [debug] [MainThread]: On master: COMMIT
[0m15:08:16.448321 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:16.448321 [debug] [MainThread]: On master: COMMIT
[0m15:08:16.496686 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:16.497595 [debug] [MainThread]: On master: Close
[0m15:08:16.499596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:16.499596 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:08:16.500596 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:08:16.501598 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m15:08:16.502106 [info ] [MainThread]: 
[0m15:08:16.503117 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m15:08:16.504125 [debug] [MainThread]: Command end result
[0m15:08:16.521312 [info ] [MainThread]: 
[0m15:08:16.522831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:16.524853 [info ] [MainThread]: 
[0m15:08:16.525881 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:16.531473 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:16.530475 after 6.48 seconds
[0m15:08:16.532545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF12EDE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF417A230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF4593CD0>]}
[0m15:08:16.533549 [debug] [MainThread]: Flushing usage events
[0m15:08:23.062171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA3489E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA2497A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA2496F20>]}


============================== 15:08:23.069219 | 28ed8be1-88e2-43a9-a82d-bad59eb83242 ==============================
[0m15:08:23.069219 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:23.070175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:08:23.322152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28ed8be1-88e2-43a9-a82d-bad59eb83242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA24520E0>]}
[0m15:08:23.323163 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:23.324165 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:23.326244 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:23.325249 after 0.40 seconds
[0m15:08:23.326244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA3489E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA24945E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA24974C0>]}
[0m15:08:23.327171 [debug] [MainThread]: Flushing usage events
[0m15:08:29.105989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF1911E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF092C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF092D210>]}


============================== 15:08:29.110052 | 1d5940a9-235f-4167-aac8-b4c5cd9d7b45 ==============================
[0m15:08:29.110052 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:29.111616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_user_packages -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:29.702079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF424B250>]}
[0m15:08:29.929192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF45443D0>]}
[0m15:08:29.931728 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:08:29.945027 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:08:30.028867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:30.029903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:30.033235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:30.040816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF49F5930>]}
[0m15:08:30.054968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF488AD40>]}
[0m15:08:30.055971 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:08:30.055971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF488AC80>]}
[0m15:08:30.058042 [info ] [MainThread]: 
[0m15:08:30.058965 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:30.060016 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:30.076328 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:30.077360 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:30.077360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:30.090000 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:30.090000 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:30.574794 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.575848 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:30.579772 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:30.589389 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:30.590380 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:30.590380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:30.591297 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:30.591297 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:30.857907 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.858906 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:30.858906 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:30.971360 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:30.976368 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:31.086082 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:31.131760 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:31.132517 [debug] [MainThread]: On master: BEGIN
[0m15:08:31.133519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:31.133519 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:31.134550 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:31.420647 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.421638 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:31.422148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:31.555126 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.558149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4A34B20>]}
[0m15:08:31.559085 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:31.623423 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:31.624486 [debug] [MainThread]: On master: BEGIN
[0m15:08:31.651413 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.652425 [debug] [MainThread]: On master: COMMIT
[0m15:08:31.653420 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:31.653420 [debug] [MainThread]: On master: COMMIT
[0m15:08:31.710276 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:31.711791 [debug] [MainThread]: On master: Close
[0m15:08:31.714813 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:31.716815 [info ] [MainThread]: 
[0m15:08:31.802734 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m15:08:31.805744 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m15:08:31.808744 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m15:08:31.811255 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m15:08:31.821366 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m15:08:31.823023 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 15:08:31.812282 => 15:08:31.823023
[0m15:08:31.823967 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m15:08:32.003724 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:32.004721 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp150831871256"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m15:08:32.005730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:32.006729 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:32.007728 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:39.159365 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m15:08:39.176857 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:39.177846 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m15:08:39.230458 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:39.230458 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:39.231418 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp150831871256'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp150831871256'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp150831871256'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:08:39.464562 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:39.480005 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:39.481514 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:39.669032 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:39.703897 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:39.705898 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:08:39.922665 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:39.948150 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m15:08:39.951891 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:39.952844 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp150831871256"
            );
[0m15:08:40.091891 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:40.091891 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:40.092895 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp150831871256"
    )
[0m15:08:40.333693 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:40.360506 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:08:40.361500 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:08:40.362669 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:08:41.371361 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:41.376612 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 15:08:31.824968 => 15:08:41.375614
[0m15:08:41.376612 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m15:08:41.378666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5940a9-235f-4167-aac8-b4c5cd9d7b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF43F6110>]}
[0m15:08:41.379684 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 9.57s]
[0m15:08:41.380634 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m15:08:41.385017 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:41.385940 [debug] [MainThread]: On master: BEGIN
[0m15:08:41.386944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:41.387940 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:41.389945 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:41.651593 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:41.652602 [debug] [MainThread]: On master: COMMIT
[0m15:08:41.653607 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:41.654628 [debug] [MainThread]: On master: COMMIT
[0m15:08:41.711435 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:41.712020 [debug] [MainThread]: On master: Close
[0m15:08:41.713107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:41.714112 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:08:41.714112 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:08:41.715124 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m15:08:41.715124 [info ] [MainThread]: 
[0m15:08:41.716127 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.66 seconds (11.66s).
[0m15:08:41.717105 [debug] [MainThread]: Command end result
[0m15:08:41.731369 [info ] [MainThread]: 
[0m15:08:41.732315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:41.733324 [info ] [MainThread]: 
[0m15:08:41.734320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:41.736321 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:41.736321 after 12.75 seconds
[0m15:08:41.739325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF1911E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4A28340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4612770>]}
[0m15:08:41.741889 [debug] [MainThread]: Flushing usage events
[0m15:08:49.422622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023269E69E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023268E77A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023268E77880>]}


============================== 15:08:49.430624 | b09d056b-742b-4281-856b-0f5fec974db2 ==============================
[0m15:08:49.430624 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:49.431627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:49.723577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09d056b-742b-4281-856b-0f5fec974db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023268E77BB0>]}
[0m15:08:49.725568 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:49.726498 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:08:49.729494 [debug] [MainThread]: Command `dbt deps` succeeded at 15:08:49.728530 after 0.46 seconds
[0m15:08:49.730494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023269E69E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023268E77BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326C81E410>]}
[0m15:08:49.731509 [debug] [MainThread]: Flushing usage events
[0m15:08:56.298172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024087F32E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024086F3FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024086F3DF30>]}


============================== 15:08:56.303184 | 30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f ==============================
[0m15:08:56.303184 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:56.305183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_users -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:08:56.945298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408ABF82B0>]}
[0m15:08:57.248821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408AB88220>]}
[0m15:08:57.251841 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:08:57.280456 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:08:57.512705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:57.513705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:57.514689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:08:57.530308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408B015810>]}
[0m15:08:57.560923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408AEAAC20>]}
[0m15:08:57.561929 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:08:57.562931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408AEAAB60>]}
[0m15:08:57.564947 [info ] [MainThread]: 
[0m15:08:57.565930 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:08:57.569470 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:08:57.590157 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:08:57.592162 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:08:57.594156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:57.600370 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:57.601376 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:58.256229 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:08:58.266442 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:08:58.275626 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:08:58.301350 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:58.303372 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:08:58.306374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:58.307368 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:58.310902 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:58.612407 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:58.614396 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:08:58.615388 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:08:58.722638 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:58.731695 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:08:58.798319 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:08:58.908566 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:58.909074 [debug] [MainThread]: On master: BEGIN
[0m15:08:58.910084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:58.911105 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:58.912081 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:08:59.199892 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:59.200894 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:59.201938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:08:59.331461 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:59.334400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408B054AC0>]}
[0m15:08:59.335424 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:59.397443 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:59.398889 [debug] [MainThread]: On master: BEGIN
[0m15:08:59.423329 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:59.427246 [debug] [MainThread]: On master: COMMIT
[0m15:08:59.428247 [debug] [MainThread]: Using redshift connection "master"
[0m15:08:59.428753 [debug] [MainThread]: On master: COMMIT
[0m15:08:59.476960 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:08:59.478544 [debug] [MainThread]: On master: Close
[0m15:08:59.480570 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:08:59.481574 [info ] [MainThread]: 
[0m15:08:59.497090 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m15:08:59.499680 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m15:08:59.500772 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m15:08:59.501782 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m15:08:59.509278 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m15:08:59.511280 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 15:08:59.502721 => 15:08:59.510284
[0m15:08:59.512278 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m15:08:59.730503 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:08:59.733507 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp150859558148"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m15:08:59.735495 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:59.737502 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:08:59.739010 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:16.742822 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m15:09:16.760033 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:16.761022 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m15:09:16.891459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:16.894458 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:16.895460 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp150859558148'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp150859558148'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp150859558148'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:09:17.114695 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:17.130487 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:17.132495 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:09:17.328740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:17.351115 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:17.352028 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:09:17.510540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:17.529758 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m15:09:17.535759 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:17.535759 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp150859558148"
            );
[0m15:09:17.697449 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:17.698446 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:17.698950 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp150859558148"
    )
[0m15:09:17.928728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:17.948565 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:09:17.949154 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:09:17.949154 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:09:18.980736 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:09:18.982692 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 15:08:59.512278 => 15:09:18.981710
[0m15:09:18.982692 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m15:09:18.983665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a190a9-ab1d-4dd7-a88d-4c2d5727ca3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408ACA5270>]}
[0m15:09:18.984691 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 19.48s]
[0m15:09:18.985613 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m15:09:18.992183 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:18.993183 [debug] [MainThread]: On master: BEGIN
[0m15:09:18.993183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:18.994216 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:09:18.995273 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:09:19.244610 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:19.245583 [debug] [MainThread]: On master: COMMIT
[0m15:09:19.245583 [debug] [MainThread]: Using redshift connection "master"
[0m15:09:19.246582 [debug] [MainThread]: On master: COMMIT
[0m15:09:19.319436 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:09:19.320441 [debug] [MainThread]: On master: Close
[0m15:09:19.323443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:19.325441 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:09:19.326442 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:09:19.327443 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m15:09:19.327443 [info ] [MainThread]: 
[0m15:09:19.328442 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 21.76 seconds (21.76s).
[0m15:09:19.329484 [debug] [MainThread]: Command end result
[0m15:09:19.346076 [info ] [MainThread]: 
[0m15:09:19.347072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:19.347072 [info ] [MainThread]: 
[0m15:09:19.349605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:19.352601 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:19.352601 after 23.20 seconds
[0m15:09:19.353598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024087F32E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408AD24D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408AD9D870>]}
[0m15:09:19.359153 [debug] [MainThread]: Flushing usage events
[0m15:11:57.828905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6C269E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6B267A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6B266F20>]}


============================== 15:11:57.833227 | 15b1b711-4273-45b0-917e-f9eb937b34ae ==============================
[0m15:11:57.833227 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:11:57.834223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:58.006848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b1b711-4273-45b0-917e-f9eb937b34ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6B2220E0>]}
[0m15:11:58.008296 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:11:58.009306 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:11:58.010306 [debug] [MainThread]: Command `dbt deps` succeeded at 15:11:58.010306 after 0.31 seconds
[0m15:11:58.011400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6C269E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6B2645E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6B2674C0>]}
[0m15:11:58.011400 [debug] [MainThread]: Flushing usage events
[0m15:12:02.607363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD58AD0B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD57ADE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD57ADD330>]}


============================== 15:12:02.611882 | 5324ab19-e597-4120-938f-8d3337b9a6fa ==============================
[0m15:12:02.611882 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:12:02.612882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:03.047565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5324ab19-e597-4120-938f-8d3337b9a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD591686D0>]}
[0m15:12:03.216390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5324ab19-e597-4120-938f-8d3337b9a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD5B99DBA0>]}
[0m15:12:03.218429 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:12:03.231519 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:12:03.305593 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 0 files added, 0 files changed.
[0m15:12:03.306596 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_users.sql
[0m15:12:03.307596 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_provider_packages.sql
[0m15:12:03.307596 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_providers.sql
[0m15:12:03.307596 [debug] [MainThread]: Partial parsing: deleted file: modeling://models\bss_paytv_user_packages.sql
[0m15:12:03.314120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:12:03.318795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5324ab19-e597-4120-938f-8d3337b9a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD5BBB40D0>]}
[0m15:12:03.328464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5324ab19-e597-4120-938f-8d3337b9a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD5BA36920>]}
[0m15:12:03.329337 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:12:03.330340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5324ab19-e597-4120-938f-8d3337b9a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD5BA36860>]}
[0m15:12:03.331338 [warn ] [MainThread]: No nodes selected!
[0m15:12:03.332338 [debug] [MainThread]: Command `dbt ls` succeeded at 15:12:03.332338 after 0.81 seconds
[0m15:12:03.332338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD58AD0B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD57ADEEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD5BA36950>]}
[0m15:12:03.333337 [debug] [MainThread]: Flushing usage events
[0m15:18:25.279908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDF202E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDE207A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDE2059F0>]}


============================== 15:18:25.285923 | 1d7c7279-6e65-402b-aeee-a2d1747d211d ==============================
[0m15:18:25.285923 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:25.286939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:25.470543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d7c7279-6e65-402b-aeee-a2d1747d211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE1B6B430>]}
[0m15:18:25.471546 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:18:25.472546 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:18:25.473546 [debug] [MainThread]: Command `dbt deps` succeeded at 15:18:25.473546 after 0.28 seconds
[0m15:18:25.474562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDF202E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDE206560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDE207730>]}
[0m15:18:25.474562 [debug] [MainThread]: Flushing usage events
[0m15:18:29.663198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BC9B2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BB9BD3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BB9BDB10>]}


============================== 15:18:29.668150 | 85040b90-7df3-4c2f-8fba-5e5fa94670ef ==============================
[0m15:18:29.668150 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:29.669150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ --output json -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:18:30.051624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85040b90-7df3-4c2f-8fba-5e5fa94670ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BF2E1300>]}
[0m15:18:30.203983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85040b90-7df3-4c2f-8fba-5e5fa94670ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BF5D3AF0>]}
[0m15:18:30.205345 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:18:30.216351 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:18:30.326472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m15:18:30.327381 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_provider_packages.sql
[0m15:18:30.327381 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_users.sql
[0m15:18:30.328480 [debug] [MainThread]: Partial parsing: added file: modeling://models\source.yml
[0m15:18:30.328480 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_user_packages.sql
[0m15:18:30.329464 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_providers.sql
[0m15:18:30.780727 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:18:30.787726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85040b90-7df3-4c2f-8fba-5e5fa94670ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BFD87E80>]}
[0m15:18:30.798775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85040b90-7df3-4c2f-8fba-5e5fa94670ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BFA43DC0>]}
[0m15:18:30.798775 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:18:30.799778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85040b90-7df3-4c2f-8fba-5e5fa94670ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BFA43C10>]}
[0m15:18:30.802855 [debug] [MainThread]: Command `dbt ls` succeeded at 15:18:30.802855 after 1.23 seconds
[0m15:18:30.803857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BC9B2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BF5D3AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BFA43D30>]}
[0m15:18:30.803857 [debug] [MainThread]: Flushing usage events
[0m15:21:40.591811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DEDA21E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DECA27A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DECA277C0>]}


============================== 15:21:40.603811 | f08190ae-1866-4318-b681-788304bee101 ==============================
[0m15:21:40.603811 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:40.604805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:40.928215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f08190ae-1866-4318-b681-788304bee101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DECA27BB0>]}
[0m15:21:40.934226 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:21:40.937225 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:21:40.938222 [debug] [MainThread]: Command `dbt deps` succeeded at 15:21:40.938222 after 0.56 seconds
[0m15:21:40.939221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DEDA21E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DECA27520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF03888E0>]}
[0m15:21:40.940221 [debug] [MainThread]: Flushing usage events
[0m15:21:46.622827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED798FEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED788FFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED788FF850>]}


============================== 15:21:46.633828 | b588e2ca-1198-4482-b1d4-898290e69942 ==============================
[0m15:21:46.633828 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:46.634828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_provider_packages -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:47.239971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C5BB1C0>]}
[0m15:21:47.516751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C548220>]}
[0m15:21:47.518659 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:21:47.535846 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:21:47.665517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:47.666434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:47.666434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:21:47.676556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C9D57E0>]}
[0m15:21:47.695441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C86ABF0>]}
[0m15:21:47.696435 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:21:47.697469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C86AB30>]}
[0m15:21:47.698550 [info ] [MainThread]: 
[0m15:21:47.699524 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:21:47.701436 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:21:47.717437 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:21:47.718435 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:21:47.718435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:47.728450 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:21:47.729452 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:21:48.238195 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:21:48.243248 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:21:48.248288 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:21:48.259232 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:21:48.262214 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:21:48.263211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:48.264214 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:21:48.264214 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:21:48.537850 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:48.537850 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:21:48.539377 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:21:48.651335 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:48.663339 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:21:48.725498 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:21:48.800985 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:48.801987 [debug] [MainThread]: On master: BEGIN
[0m15:21:48.802984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:48.803985 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:21:48.804985 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:21:49.080320 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:49.081319 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:49.082303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:21:49.236644 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:49.239664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7CA157E0>]}
[0m15:21:49.243415 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:49.301957 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:49.302992 [debug] [MainThread]: On master: BEGIN
[0m15:21:49.328510 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:49.328510 [debug] [MainThread]: On master: COMMIT
[0m15:21:49.329513 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:49.329513 [debug] [MainThread]: On master: COMMIT
[0m15:21:49.378435 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:49.379438 [debug] [MainThread]: On master: Close
[0m15:21:49.381441 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:21:49.382440 [info ] [MainThread]: 
[0m15:21:49.405457 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m15:21:49.411434 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m15:21:49.413437 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_provider_packages'
[0m15:21:49.414471 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m15:21:49.419434 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m15:21:49.421432 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 15:21:49.415435 => 15:21:49.420433
[0m15:21:49.425436 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m15:21:49.632868 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:49.633843 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

    
  
    

  create temporary table
    "bss_paytv_provider_packages__dbt_tmp152149485203"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m15:21:49.633843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:49.634843 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:21:49.634843 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:21:50.126319 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:50.144881 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.144881 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m15:21:50.193327 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:50.194392 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.195326 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp152149485203'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp152149485203'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp152149485203'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:21:50.413730 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:50.434700 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.435698 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:21:50.629144 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:50.649752 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.650760 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:21:50.818908 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:50.849390 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.852384 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:50.853386 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_provider_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp152149485203"
            );
[0m15:21:51.014442 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:51.015427 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:51.015427 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp152149485203"
    )
[0m15:21:51.107570 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:51.127615 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:21:51.128658 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m15:21:51.129705 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m15:21:51.677466 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:21:51.678441 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 15:21:49.427484 => 15:21:51.678441
[0m15:21:51.679446 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m15:21:51.680421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b588e2ca-1198-4482-b1d4-898290e69942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C6E4610>]}
[0m15:21:51.681358 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 2.27s]
[0m15:21:51.681358 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m15:21:51.685451 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:51.686359 [debug] [MainThread]: On master: BEGIN
[0m15:21:51.688397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:51.692367 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:21:51.693364 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:21:51.959223 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:51.959223 [debug] [MainThread]: On master: COMMIT
[0m15:21:51.960260 [debug] [MainThread]: Using redshift connection "master"
[0m15:21:51.960260 [debug] [MainThread]: On master: COMMIT
[0m15:21:52.032678 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:21:52.033766 [debug] [MainThread]: On master: Close
[0m15:21:52.034686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:52.035685 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:21:52.035685 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:21:52.037739 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m15:21:52.040719 [info ] [MainThread]: 
[0m15:21:52.041689 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m15:21:52.042685 [debug] [MainThread]: Command end result
[0m15:21:52.051454 [info ] [MainThread]: 
[0m15:21:52.052464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:52.056375 [info ] [MainThread]: 
[0m15:21:52.058374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:52.060446 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:52.060446 after 5.56 seconds
[0m15:21:52.061372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED798FEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C665C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7C791BD0>]}
[0m15:21:52.061372 [debug] [MainThread]: Flushing usage events
[0m15:21:58.003410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67FF01E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D602957A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D602956F20>]}


============================== 15:21:58.007950 | 7263ee6a-9109-4e6d-ba10-f4dd591f149f ==============================
[0m15:21:58.007950 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:58.008950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:21:58.246424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7263ee6a-9109-4e6d-ba10-f4dd591f149f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6029120E0>]}
[0m15:21:58.247341 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:21:58.253349 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:21:58.255338 [debug] [MainThread]: Command `dbt deps` succeeded at 15:21:58.254339 after 0.38 seconds
[0m15:21:58.255844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67FF01E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6029545E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6029574C0>]}
[0m15:21:58.255844 [debug] [MainThread]: Flushing usage events
[0m15:22:03.903044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C16D9DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C15DAEFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C15DAF730>]}


============================== 15:22:03.907801 | b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb ==============================
[0m15:22:03.907801 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:22:03.908801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_providers -t analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:04.499779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C196D3EB0>]}
[0m15:22:04.732174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C199B1D80>]}
[0m15:22:04.734170 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:22:04.751169 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:22:04.856711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:04.856711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:04.857711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:22:04.872213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C19E758A0>]}
[0m15:22:04.895208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C19D0ACE0>]}
[0m15:22:04.898199 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:22:04.899199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C19D0ACB0>]}
[0m15:22:04.901219 [info ] [MainThread]: 
[0m15:22:04.902219 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:22:04.903193 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:22:04.919217 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:22:04.920215 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:22:04.921193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:04.931197 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:04.932195 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:05.480502 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:22:05.482500 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:22:05.485497 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:22:05.500574 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:05.501574 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:22:05.502570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:05.503507 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:05.504552 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:05.784933 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:05.785948 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:05.785948 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:22:05.891304 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:05.900192 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:22:05.964678 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:22:06.008386 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:06.012379 [debug] [MainThread]: On master: BEGIN
[0m15:22:06.013419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:06.014373 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:06.015442 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:06.300065 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:06.300065 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:06.301108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:22:06.445625 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:06.450642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C1A042E00>]}
[0m15:22:06.451591 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:06.519906 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:06.520916 [debug] [MainThread]: On master: BEGIN
[0m15:22:06.547116 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:06.548109 [debug] [MainThread]: On master: COMMIT
[0m15:22:06.549110 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:06.549110 [debug] [MainThread]: On master: COMMIT
[0m15:22:06.606612 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:06.608529 [debug] [MainThread]: On master: Close
[0m15:22:06.613524 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:22:06.614511 [info ] [MainThread]: 
[0m15:22:06.632554 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_providers
[0m15:22:06.633600 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_providers ............... [RUN]
[0m15:22:06.634594 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_providers'
[0m15:22:06.634594 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_providers
[0m15:22:06.639587 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_providers"
[0m15:22:06.641546 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (compile): 15:22:06.635591 => 15:22:06.639587
[0m15:22:06.646521 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_providers
[0m15:22:06.822165 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:06.822165 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

    
  
    

  create temporary table
    "bss_paytv_providers__dbt_tmp152206692293"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_providers"
  );
[0m15:22:06.823160 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:06.825078 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:06.829174 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:07.237532 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:07.278252 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:07.280142 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: BEGIN
[0m15:22:07.347136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:07.348212 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:07.349212 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers__dbt_tmp152206692293'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers__dbt_tmp152206692293'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_providers__dbt_tmp152206692293'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:22:07.579278 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:07.598320 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:07.599325 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:07.791342 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:07.820368 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:07.821326 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_providers'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_providers'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_providers'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:07.979354 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:08.001350 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_providers"
[0m15:22:08.003349 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:08.004350 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_providers"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_providers"
            where (
                id) in (
                select (id)
                from "bss_paytv_providers__dbt_tmp152206692293"
            );
[0m15:22:08.119611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:08.120719 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:08.120719 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: insert into "vplus_db_premium"."analytics"."bss_paytv_providers" ("upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "code", "name", "web_image_url", "ios_image_url", "android_image_url", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_providers__dbt_tmp152206692293"
    )
[0m15:22:08.211630 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:08.238717 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:22:08.243640 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_providers"
[0m15:22:08.245631 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: COMMIT
[0m15:22:08.666891 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:08.667908 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_providers (execute): 15:22:06.647520 => 15:22:08.667908
[0m15:22:08.668900 [debug] [Thread-1 (]: On model.modeling.bss_paytv_providers: Close
[0m15:22:08.669901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c2727a-4e58-4d1f-8faf-80ee3c9f66cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C19A58880>]}
[0m15:22:08.670901 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_providers .......... [[32mSUCCESS[0m in 2.04s]
[0m15:22:08.670901 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_providers
[0m15:22:08.678430 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:08.679428 [debug] [MainThread]: On master: BEGIN
[0m15:22:08.680425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:08.681421 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:08.681421 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:09.027638 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:09.028638 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.029635 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:09.029635 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.091428 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:09.094427 [debug] [MainThread]: On master: Close
[0m15:22:09.096506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.096506 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:22:09.097424 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:22:09.097424 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_providers' was properly closed.
[0m15:22:09.098424 [info ] [MainThread]: 
[0m15:22:09.099423 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:22:09.099423 [debug] [MainThread]: Command end result
[0m15:22:09.114519 [info ] [MainThread]: 
[0m15:22:09.115500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.116507 [info ] [MainThread]: 
[0m15:22:09.116507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:09.118498 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.117462 after 5.33 seconds
[0m15:22:09.118498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C16D9DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C19C2FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C196D12A0>]}
[0m15:22:09.119491 [debug] [MainThread]: Flushing usage events
[0m15:22:15.354399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EDD29E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ECD37A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ECD377C0>]}


============================== 15:22:15.360479 | aa28ec2c-923f-4a6f-b64e-0978277a0f3a ==============================
[0m15:22:15.360479 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:22:15.360479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m15:22:15.614013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa28ec2c-923f-4a6f-b64e-0978277a0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ECD37BB0>]}
[0m15:22:15.615014 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:15.615932 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:15.621977 [debug] [MainThread]: Command `dbt deps` succeeded at 15:22:15.620947 after 0.39 seconds
[0m15:22:15.622942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EDD29E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ECD37520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F06A48E0>]}
[0m15:22:15.623931 [debug] [MainThread]: Flushing usage events
[0m15:22:21.310626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FEC2DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A48165D270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A48165C700>]}


============================== 15:22:21.320655 | 7e3a169d-5f54-477c-8056-3e7c34f1fc2e ==============================
[0m15:22:21.320655 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:22:21.321587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_user_packages -t analytics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:21.894010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A48165F160>]}
[0m15:22:22.127523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481977430>]}
[0m15:22:22.133441 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:22:22.148464 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:22:22.233554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:22.234557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:22.235551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:22:22.240648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481E35870>]}
[0m15:22:22.255549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481CCAC80>]}
[0m15:22:22.256551 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:22:22.257549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481CCABC0>]}
[0m15:22:22.258631 [info ] [MainThread]: 
[0m15:22:22.259549 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:22:22.263622 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:22:22.281652 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:22:22.284600 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:22:22.285661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:22.290691 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:22.291714 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:22.756368 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:22.757461 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:22:22.760375 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:22:22.773448 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:22.774376 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:22:22.774376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:22.775373 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:22.775373 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:23.035284 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.035284 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:23.036284 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:22:23.150945 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.155942 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:22:23.217624 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:22:23.274619 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:23.274619 [debug] [MainThread]: On master: BEGIN
[0m15:22:23.275620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:23.276620 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:23.277639 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:23.545053 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.549047 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:23.550047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:22:23.683390 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.686386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481E741C0>]}
[0m15:22:23.687384 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:23.749024 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:23.750032 [debug] [MainThread]: On master: BEGIN
[0m15:22:23.771925 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.773083 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.773083 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:23.774020 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.822047 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:23.822047 [debug] [MainThread]: On master: Close
[0m15:22:23.823063 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:22:23.824165 [info ] [MainThread]: 
[0m15:22:23.841411 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m15:22:23.842420 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m15:22:23.847429 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_user_packages'
[0m15:22:23.850415 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m15:22:23.854413 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m15:22:23.855412 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 15:22:23.850415 => 15:22:23.855412
[0m15:22:23.855412 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m15:22:24.074660 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:24.075669 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

    
  
    

  create temporary table
    "bss_paytv_user_packages__dbt_tmp152223941091"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m15:22:24.078714 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:24.082573 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:24.083580 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:28.330409 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m15:22:28.350499 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:28.351496 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m15:22:28.403688 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:28.403688 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:28.404687 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp152223941091'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp152223941091'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp152223941091'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:22:28.620044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:28.649043 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:28.650045 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:28.844590 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:28.878575 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:28.879574 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:29.035843 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:29.063932 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m15:22:29.066925 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:29.067945 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_user_packages"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp152223941091"
            );
[0m15:22:29.189962 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:29.193992 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:29.194972 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp152223941091"
    )
[0m15:22:34.982808 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m15:22:35.006814 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:22:35.007892 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m15:22:35.007892 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m15:22:36.256650 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:22:36.257663 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 15:22:23.856413 => 15:22:36.257663
[0m15:22:36.258651 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m15:22:36.259650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e3a169d-5f54-477c-8056-3e7c34f1fc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A482003C40>]}
[0m15:22:36.260651 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 12.42s]
[0m15:22:36.261651 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m15:22:36.264653 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:36.265656 [debug] [MainThread]: On master: BEGIN
[0m15:22:36.266651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:36.271654 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:36.272656 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:36.609736 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:36.609736 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.610736 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:36.610736 [debug] [MainThread]: On master: COMMIT
[0m15:22:36.664003 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:36.665001 [debug] [MainThread]: On master: Close
[0m15:22:36.667058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:36.670014 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:22:36.672010 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:22:36.673039 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m15:22:36.674101 [info ] [MainThread]: 
[0m15:22:36.674101 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 14.41 seconds (14.41s).
[0m15:22:36.675005 [debug] [MainThread]: Command end result
[0m15:22:36.693003 [info ] [MainThread]: 
[0m15:22:36.694042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:36.695006 [info ] [MainThread]: 
[0m15:22:36.695006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:36.697040 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:36.697040 after 15.51 seconds
[0m15:22:36.698126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FEC2DE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481AF7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A481BEE230>]}
[0m15:22:36.698126 [debug] [MainThread]: Flushing usage events
[0m15:22:42.909193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020598F11E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597F27A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597F26F20>]}


============================== 15:22:42.919486 | f48eb9c4-63a5-4bc4-a096-a13655042a90 ==============================
[0m15:22:42.919486 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:22:42.920387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:43.157154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f48eb9c4-63a5-4bc4-a096-a13655042a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597EE20E0>]}
[0m15:22:43.158155 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:43.159165 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:43.161167 [debug] [MainThread]: Command `dbt deps` succeeded at 15:22:43.160155 after 0.39 seconds
[0m15:22:43.165176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020598F11E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597F245E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020597F274C0>]}
[0m15:22:43.167159 [debug] [MainThread]: Flushing usage events
[0m15:22:48.988169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA21D9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA11DEFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA11DF730>]}


============================== 15:22:48.997260 | ae5bf71e-ac14-401a-ab71-b3cc2013c982 ==============================
[0m15:22:48.997260 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:22:48.998168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'D:/Projects/profiles-key/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -m bss_paytv_users -t analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:49.510198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4AF3EB0>]}
[0m15:22:49.700537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4DE5D80>]}
[0m15:22:49.704618 [info ] [MainThread]: Registered adapter: redshift=1.7.4
[0m15:22:49.718621 [debug] [MainThread]: checksum: 174f23dfaa63fc60606f1bf07b7f177c3d5df0133fa9c0b4983f5f7e87ab46f8, vars: {}, profile: , target: analytics, version: 1.7.9
[0m15:22:49.792252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:49.793249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:49.793249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m15:22:49.799328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA52A18A0>]}
[0m15:22:49.813254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA513ACE0>]}
[0m15:22:49.814256 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 467 macros, 0 groups, 0 semantic models
[0m15:22:49.814256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA513ACB0>]}
[0m15:22:49.816253 [info ] [MainThread]: 
[0m15:22:49.817251 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:22:49.818250 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m15:22:49.833364 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m15:22:49.834345 [debug] [ThreadPool]: On list_vplus_db_premium: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium"} */

    select distinct nspname from pg_namespace
[0m15:22:49.834345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:49.842803 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:49.843802 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:50.336938 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:22:50.337977 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m15:22:50.344025 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium_analytics'
[0m15:22:50.351024 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:50.351024 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m15:22:50.352027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:50.352027 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:50.353025 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:50.610253 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:50.610253 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m15:22:50.611252 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "list_vplus_db_premium_analytics"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'analytics'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'analytics'
[0m15:22:50.719250 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:50.726255 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m15:22:50.791559 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m15:22:50.834715 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:50.834715 [debug] [MainThread]: On master: BEGIN
[0m15:22:50.835674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:50.835674 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:50.836709 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:51.119312 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:51.119312 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:51.120404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:22:51.250691 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:51.254596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA546EDD0>]}
[0m15:22:51.257603 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:51.324201 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:51.325204 [debug] [MainThread]: On master: BEGIN
[0m15:22:51.349611 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:51.350722 [debug] [MainThread]: On master: COMMIT
[0m15:22:51.350722 [debug] [MainThread]: Using redshift connection "master"
[0m15:22:51.351668 [debug] [MainThread]: On master: COMMIT
[0m15:22:51.399787 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:51.400795 [debug] [MainThread]: On master: Close
[0m15:22:51.401879 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m15:22:51.401879 [info ] [MainThread]: 
[0m15:22:51.417475 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m15:22:51.418452 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m15:22:51.419473 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.modeling.bss_paytv_users'
[0m15:22:51.419473 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m15:22:51.426455 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m15:22:51.428454 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 15:22:51.419473 => 15:22:51.427455
[0m15:22:51.428454 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m15:22:51.569725 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:51.570638 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

    
  
    

  create temporary table
    "bss_paytv_users__dbt_tmp152251461061"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m15:22:51.573650 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:51.575638 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:22:51.576714 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:22:55.870615 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m15:22:55.891715 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:55.892685 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m15:22:55.954240 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:55.956237 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:55.957236 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp152251461061'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp152251461061'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp152251461061'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m15:22:56.190830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:56.208733 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:56.209732 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:56.404126 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:56.423160 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:56.424157 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m15:22:56.587432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:56.610506 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m15:22:56.613513 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:56.614520 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "modeling", "target_name": "analytics", "node_id": "model.modeling.bss_paytv_users"} */

      
        
            delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp152251461061"
            );
[0m15:22:56.754138 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:22:56.755537 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:22:56.755537 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp152251461061"
    )
[0m15:23:03.734790 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m15:23:03.752753 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:23:03.753753 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m15:23:03.754752 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m15:23:04.920071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:23:04.921166 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 15:22:51.428454 => 15:23:04.921166
[0m15:23:04.922169 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m15:23:04.923082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae5bf71e-ac14-401a-ab71-b3cc2013c982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4E88880>]}
[0m15:23:04.924082 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 13.50s]
[0m15:23:04.925186 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m15:23:04.930089 [debug] [MainThread]: Using redshift connection "master"
[0m15:23:04.931089 [debug] [MainThread]: On master: BEGIN
[0m15:23:04.932163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:04.933084 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:23:04.933084 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:23:05.190110 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:23:05.191111 [debug] [MainThread]: On master: COMMIT
[0m15:23:05.195112 [debug] [MainThread]: Using redshift connection "master"
[0m15:23:05.197112 [debug] [MainThread]: On master: COMMIT
[0m15:23:05.247632 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:23:05.249648 [debug] [MainThread]: On master: Close
[0m15:23:05.251648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:05.252653 [debug] [MainThread]: Connection 'list_vplus_db_premium' was properly closed.
[0m15:23:05.253647 [debug] [MainThread]: Connection 'list_vplus_db_premium_analytics' was properly closed.
[0m15:23:05.254647 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m15:23:05.255646 [info ] [MainThread]: 
[0m15:23:05.256645 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.44 seconds (15.44s).
[0m15:23:05.258646 [debug] [MainThread]: Command end result
[0m15:23:05.279199 [info ] [MainThread]: 
[0m15:23:05.281194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:05.282190 [info ] [MainThread]: 
[0m15:23:05.283188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:05.286189 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:05.286189 after 16.40 seconds
[0m15:23:05.287190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA21D9E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA11DC070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA4AF13F0>]}
[0m15:23:05.288189 [debug] [MainThread]: Flushing usage events
[0m09:05:32.387121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960e2c2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960cd51e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960cd51ed0>]}


============================== 09:05:32.388939 | c0d06229-b1d2-48f4-9cd4-d890d21764fc ==============================
[0m09:05:32.388939 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:05:32.389552 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/prk/user/loop/profiles-key/', 'debug': 'False'}
[0m09:05:32.412555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d06229-b1d2-48f4-9cd4-d890d21764fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960cd52980>]}
[0m09:05:32.413131 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:05:32.413782 [debug] [MainThread]: Command `dbt deps` succeeded at 09:05:32.413652 after 0.03 seconds
[0m09:05:32.414134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960e2c2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960cd52980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960cd529e0>]}
[0m09:05:32.414532 [debug] [MainThread]: Flushing usage events
[0m09:05:35.316295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf49db6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4884ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4884e9b0>]}


============================== 09:05:35.318110 | 8aa22151-17d9-4684-8127-b7a96c66e7b6 ==============================
[0m09:05:35.318110 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:05:35.318696 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/prk/user/loop/profiles-key/', 'fail_fast': 'False', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True'}
[0m09:05:35.512452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4884eb60>]}
[0m09:05:35.529785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4ac80070>]}
[0m09:05:35.543621 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:05:35.553127 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:05:35.553580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4ac82d40>]}
[0m09:05:36.212176 [debug] [MainThread]: 1699: static parser successfully parsed bss_paytv_user_packages.sql
[0m09:05:36.225062 [debug] [MainThread]: 1699: static parser successfully parsed bss_paytv_users.sql
[0m09:05:36.228421 [debug] [MainThread]: 1699: static parser successfully parsed bss_paytv_provider_packages.sql
[0m09:05:36.286035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:05:36.291715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf483b5540>]}
[0m09:05:36.299103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf48423fd0>]}
[0m09:05:36.299560 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:05:36.299936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa22151-17d9-4684-8127-b7a96c66e7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf4ac80a90>]}
[0m09:05:36.301243 [debug] [MainThread]: Command `dbt ls` succeeded at 09:05:36.301110 after 0.99 seconds
[0m09:05:36.301604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf49db6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf48423fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf483a5630>]}
[0m09:05:36.301950 [debug] [MainThread]: Flushing usage events
[0m09:07:56.485778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4389cb5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438874ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438874de40>]}


============================== 09:07:56.487542 | 0d17aace-dc12-4e09-bba6-74ec401667b5 ==============================
[0m09:07:56.487542 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:07:56.488136 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/prk/user/loop/profiles-key/', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'introspect': 'True'}
[0m09:07:56.511026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d17aace-dc12-4e09-bba6-74ec401667b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438874e8f0>]}
[0m09:07:56.511455 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:07:56.512030 [debug] [MainThread]: Command `dbt deps` succeeded at 09:07:56.511907 after 0.03 seconds
[0m09:07:56.512371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4389cb5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438874e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438874e950>]}
[0m09:07:56.512740 [debug] [MainThread]: Flushing usage events
[0m09:07:59.395966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc1eb6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc094a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc094a5f0>]}


============================== 09:07:59.397753 | fe6a0475-6647-4734-a1ef-43d075fa0b1d ==============================
[0m09:07:59.397753 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:07:59.398382 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/prk/user/loop/profiles-key/', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m09:07:59.631387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc094a920>]}
[0m09:07:59.652337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc2e13370>]}
[0m09:07:59.665511 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:07:59.687677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:59.687990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:59.688482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:07:59.693896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc05300d0>]}
[0m09:07:59.701550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc0502d40>]}
[0m09:07:59.701969 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:07:59.702354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc0502cb0>]}
[0m09:07:59.703395 [info ] [MainThread]: 
[0m09:07:59.704112 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:07:59.705211 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m09:07:59.716963 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m09:07:59.717293 [debug] [ThreadPool]: On list_vplus_db_premium: select distinct nspname from pg_namespace
[0m09:07:59.717571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:59.717879 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:07:59.718919 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:07:59.719247 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:07:59.993627 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:07:59.995216 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m09:07:59.997009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_vplus_db_premium, now list_vplus_db_premium_analytics)
[0m09:08:00.006012 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:00.006420 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m09:08:00.006722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:00.007056 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:00.007537 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:00.007865 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:00.222137 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.222661 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:00.223059 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: select
      'vplus_db_premium' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'vplus_db_premium' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
[0m09:08:00.304147 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.308121 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m09:08:00.354342 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m09:08:00.391132 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:00.391471 [debug] [MainThread]: On master: BEGIN
[0m09:08:00.391773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:00.392106 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:00.392649 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:00.393002 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:00.610811 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.611250 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:00.611659 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:08:00.731172 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.733421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc056e470>]}
[0m09:08:00.733847 [debug] [MainThread]: On master: ROLLBACK
[0m09:08:00.777808 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:00.778128 [debug] [MainThread]: On master: BEGIN
[0m09:08:00.796410 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.796732 [debug] [MainThread]: On master: COMMIT
[0m09:08:00.797146 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:00.797443 [debug] [MainThread]: On master: COMMIT
[0m09:08:00.832939 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:00.833279 [debug] [MainThread]: On master: Close
[0m09:08:00.834094 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m09:08:00.834507 [info ] [MainThread]: 
[0m09:08:00.841173 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_provider_packages
[0m09:08:00.841714 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_provider_packages ....... [RUN]
[0m09:08:00.842486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_vplus_db_premium_analytics, now model.modeling.bss_paytv_provider_packages)
[0m09:08:00.842875 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_provider_packages
[0m09:08:00.846555 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_provider_packages"
[0m09:08:00.847304 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (compile): 09:08:00.843117 => 09:08:00.847052
[0m09:08:00.847685 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_provider_packages
[0m09:08:00.918390 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:00.918825 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: create temporary table
    "bss_paytv_provider_packages__dbt_tmp090800879290"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_provider_packages"
  );
[0m09:08:00.919200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:00.919590 [debug] [Thread-1 (]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:00.920147 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:00.920544 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:01.207073 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:01.223689 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.224150 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: BEGIN
[0m09:08:01.259647 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:01.260051 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.260541 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages__dbt_tmp090800879290'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages__dbt_tmp090800879290'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_provider_packages__dbt_tmp090800879290'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m09:08:01.468178 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:01.498606 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.499752 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:01.682559 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:01.701184 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.701807 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_provider_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_provider_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_provider_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:01.858190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:01.891979 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.896362 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:01.897348 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: delete from "vplus_db_premium"."analytics"."bss_paytv_provider_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_provider_packages__dbt_tmp090800879290"
            );
[0m09:08:02.014398 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:02.015423 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:02.016097 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_provider_packages" ("id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at")
    (
        select "id", "provider_id", "provider_package_code", "package_id", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_provider_packages__dbt_tmp090800879290"
    )
[0m09:08:02.088021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:02.104972 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m09:08:02.105536 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_provider_packages"
[0m09:08:02.105919 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: COMMIT
[0m09:08:02.565022 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:02.566360 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_provider_packages (execute): 09:08:00.847925 => 09:08:02.566109
[0m09:08:02.566790 [debug] [Thread-1 (]: On model.modeling.bss_paytv_provider_packages: Close
[0m09:08:02.567721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6a0475-6647-4734-a1ef-43d075fa0b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc0298280>]}
[0m09:08:02.568372 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_provider_packages .. [[32mSUCCESS[0m in 1.73s]
[0m09:08:02.569125 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_provider_packages
[0m09:08:02.571522 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:02.571847 [debug] [MainThread]: On master: BEGIN
[0m09:08:02.572128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:02.572439 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:02.572951 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:02.573273 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:02.775199 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:02.775723 [debug] [MainThread]: On master: COMMIT
[0m09:08:02.776216 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:02.776551 [debug] [MainThread]: On master: COMMIT
[0m09:08:02.810008 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:02.810385 [debug] [MainThread]: On master: Close
[0m09:08:02.811196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:02.811513 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_provider_packages' was properly closed.
[0m09:08:02.811876 [info ] [MainThread]: 
[0m09:08:02.812308 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m09:08:02.813100 [debug] [MainThread]: Command end result
[0m09:08:02.821755 [info ] [MainThread]: 
[0m09:08:02.822218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:02.822606 [info ] [MainThread]: 
[0m09:08:02.823040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:08:02.823693 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:02.823569 after 3.44 seconds
[0m09:08:02.824074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc1eb6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc2e13370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc056e680>]}
[0m09:08:02.824473 [debug] [MainThread]: Flushing usage events
[0m09:08:05.833513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd9fc1ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd8a51de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd8a51e70>]}


============================== 09:08:05.836056 | c4648f3d-23f6-46e1-b874-719b2c9fa39a ==============================
[0m09:08:05.836056 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:08:05.836925 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'profiles_dir': '/prk/user/loop/profiles-key/', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True'}
[0m09:08:05.870114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4648f3d-23f6-46e1-b874-719b2c9fa39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd8a52920>]}
[0m09:08:05.870533 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:08:05.871071 [debug] [MainThread]: Command `dbt deps` succeeded at 09:08:05.870951 after 0.05 seconds
[0m09:08:05.871398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd9fc1ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd8a52920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd8a52980>]}
[0m09:08:05.871729 [debug] [MainThread]: Flushing usage events
[0m09:08:08.757449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4c7be080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4b256770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4b256680>]}


============================== 09:08:08.759215 | 420891b2-8a42-4609-8438-3a8ecfa0e7ba ==============================
[0m09:08:08.759215 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:08:08.759745 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'use_colors': 'True', 'profiles_dir': '/prk/user/loop/profiles-key/', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m09:08:08.958591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4b2569b0>]}
[0m09:08:08.975654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4d5cc0d0>]}
[0m09:08:08.989254 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:08:09.011341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:09.011680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:09.012165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:08:09.017675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae3c0d0>]}
[0m09:08:09.024903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae0edd0>]}
[0m09:08:09.025323 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:08:09.025695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae0ed40>]}
[0m09:08:09.026727 [info ] [MainThread]: 
[0m09:08:09.027435 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:08:09.028514 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m09:08:09.040491 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m09:08:09.040878 [debug] [ThreadPool]: On list_vplus_db_premium: select distinct nspname from pg_namespace
[0m09:08:09.041200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:09.041559 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:09.042693 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:09.043057 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:09.334324 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:09.336007 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m09:08:09.337902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_vplus_db_premium, now list_vplus_db_premium_analytics)
[0m09:08:09.346553 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:09.346896 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m09:08:09.347187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:09.347517 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:09.348002 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:09.348335 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:09.562863 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:09.563357 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:09.563719 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: select
      'vplus_db_premium' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'vplus_db_premium' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
[0m09:08:09.650341 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:09.659992 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m09:08:09.707222 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m09:08:09.756321 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:09.756868 [debug] [MainThread]: On master: BEGIN
[0m09:08:09.757300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:09.757768 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:09.758552 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:09.759041 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:09.967134 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:09.967619 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:09.968052 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:08:10.079180 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:10.081439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae7a530>]}
[0m09:08:10.081885 [debug] [MainThread]: On master: ROLLBACK
[0m09:08:10.122752 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:10.123067 [debug] [MainThread]: On master: BEGIN
[0m09:08:10.139794 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:10.140109 [debug] [MainThread]: On master: COMMIT
[0m09:08:10.140549 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:10.140884 [debug] [MainThread]: On master: COMMIT
[0m09:08:10.173440 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:10.173811 [debug] [MainThread]: On master: Close
[0m09:08:10.174642 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m09:08:10.175034 [info ] [MainThread]: 
[0m09:08:10.180792 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_user_packages
[0m09:08:10.181379 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_user_packages ........... [RUN]
[0m09:08:10.182117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_vplus_db_premium_analytics, now model.modeling.bss_paytv_user_packages)
[0m09:08:10.182520 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_user_packages
[0m09:08:10.186058 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_user_packages"
[0m09:08:10.186681 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (compile): 09:08:10.182761 => 09:08:10.186438
[0m09:08:10.187052 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_user_packages
[0m09:08:10.257735 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:10.258148 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: create temporary table
    "bss_paytv_user_packages__dbt_tmp090810218358"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_user_packages"
  );
[0m09:08:10.258512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:10.258881 [debug] [Thread-1 (]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:10.259415 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:10.259806 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:10.731375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:10.748225 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:10.748680 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: BEGIN
[0m09:08:10.784928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:10.785297 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:10.785744 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages__dbt_tmp090810218358'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages__dbt_tmp090810218358'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_user_packages__dbt_tmp090810218358'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m09:08:10.990084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:11.004335 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:11.004862 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:11.186585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:11.204594 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:11.205111 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_user_packages'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_user_packages'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_user_packages'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:11.359191 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:11.376646 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_user_packages"
[0m09:08:11.378935 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:11.379306 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: delete from "vplus_db_premium"."analytics"."bss_paytv_user_packages"
            where (
                id) in (
                select (id)
                from "bss_paytv_user_packages__dbt_tmp090810218358"
            );
[0m09:08:11.505683 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:11.506355 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:11.506803 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: insert into "vplus_db_premium"."analytics"."bss_paytv_user_packages" ("upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at")
    (
        select "upload_date", "id", "paytv_user_id", "provider_package_id", "name", "start_date", "end_date", "status", "created_at", "updated_at", "deleted_at"
        from "bss_paytv_user_packages__dbt_tmp090810218358"
    )
[0m09:08:11.718039 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:11.734833 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m09:08:11.735355 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_user_packages"
[0m09:08:11.735729 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: COMMIT
[0m09:08:12.691708 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m09:08:12.693136 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_user_packages (execute): 09:08:10.187283 => 09:08:12.692873
[0m09:08:12.693584 [debug] [Thread-1 (]: On model.modeling.bss_paytv_user_packages: Close
[0m09:08:12.694548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '420891b2-8a42-4609-8438-3a8ecfa0e7ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae0ebf0>]}
[0m09:08:12.695199 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_user_packages ...... [[32mSUCCESS[0m in 2.51s]
[0m09:08:12.695888 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_user_packages
[0m09:08:12.698327 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:12.698680 [debug] [MainThread]: On master: BEGIN
[0m09:08:12.699000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:12.699360 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:12.699885 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:12.700246 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:12.914352 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:12.914798 [debug] [MainThread]: On master: COMMIT
[0m09:08:12.915258 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:12.915587 [debug] [MainThread]: On master: COMMIT
[0m09:08:12.951345 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:12.951704 [debug] [MainThread]: On master: Close
[0m09:08:12.952474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:12.952786 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_user_packages' was properly closed.
[0m09:08:12.953168 [info ] [MainThread]: 
[0m09:08:12.953588 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m09:08:12.954352 [debug] [MainThread]: Command end result
[0m09:08:12.962985 [info ] [MainThread]: 
[0m09:08:12.963433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:12.963835 [info ] [MainThread]: 
[0m09:08:12.964277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:08:12.964948 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:12.964798 after 4.21 seconds
[0m09:08:12.965335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4c7be080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4d5cc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4ae7a740>]}
[0m09:08:12.965739 [debug] [MainThread]: Flushing usage events
[0m09:08:15.929074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4684eb6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683945e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683945ed0>]}


============================== 09:08:15.930820 | 69348932-5a8b-45a7-a3ab-b9564acc74bc ==============================
[0m09:08:15.930820 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:08:15.931387 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/prk/user/loop/profiles-key/', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True'}
[0m09:08:15.954683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69348932-5a8b-45a7-a3ab-b9564acc74bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683946980>]}
[0m09:08:15.955120 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:08:15.955698 [debug] [MainThread]: Command `dbt deps` succeeded at 09:08:15.955574 after 0.03 seconds
[0m09:08:15.956019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4684eb6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4683946980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46839469e0>]}
[0m09:08:15.956357 [debug] [MainThread]: Flushing usage events
[0m09:08:18.786973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7acb5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad797466e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad797465f0>]}


============================== 09:08:18.788697 | bf7acece-2aae-426b-95d8-450a4d94c305 ==============================
[0m09:08:18.788697 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:08:18.789309 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'profiles_dir': '/prk/user/loop/profiles-key/', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m09:08:18.982925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79746920>]}
[0m09:08:19.000096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7bbf7430>]}
[0m09:08:19.013234 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:08:19.035093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:19.035428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:19.036000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:08:19.041758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad793300d0>]}
[0m09:08:19.049753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79302d40>]}
[0m09:08:19.050205 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:08:19.050645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79302cb0>]}
[0m09:08:19.051706 [info ] [MainThread]: 
[0m09:08:19.052464 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m09:08:19.053568 [debug] [ThreadPool]: Acquiring new redshift connection 'list_vplus_db_premium'
[0m09:08:19.065415 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium"
[0m09:08:19.065753 [debug] [ThreadPool]: On list_vplus_db_premium: select distinct nspname from pg_namespace
[0m09:08:19.066046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:19.066387 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:19.067455 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:19.067797 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:19.345035 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:19.346610 [debug] [ThreadPool]: On list_vplus_db_premium: Close
[0m09:08:19.348364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_vplus_db_premium, now list_vplus_db_premium_analytics)
[0m09:08:19.356887 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:19.357224 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: BEGIN
[0m09:08:19.357519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:19.357843 [debug] [ThreadPool]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:19.358327 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:19.358660 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:19.575872 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:19.576354 [debug] [ThreadPool]: Using redshift connection "list_vplus_db_premium_analytics"
[0m09:08:19.576724 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: select
      'vplus_db_premium' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'vplus_db_premium' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
[0m09:08:19.660859 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:19.664769 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: ROLLBACK
[0m09:08:19.711720 [debug] [ThreadPool]: On list_vplus_db_premium_analytics: Close
[0m09:08:19.783830 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:19.784380 [debug] [MainThread]: On master: BEGIN
[0m09:08:19.784849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:19.785225 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:19.785759 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:19.786081 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:19.995731 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:19.996219 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:19.996652 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:08:20.107464 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:20.109767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7936e440>]}
[0m09:08:20.110222 [debug] [MainThread]: On master: ROLLBACK
[0m09:08:20.151167 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:20.151494 [debug] [MainThread]: On master: BEGIN
[0m09:08:20.168311 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:20.168634 [debug] [MainThread]: On master: COMMIT
[0m09:08:20.169071 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:20.169373 [debug] [MainThread]: On master: COMMIT
[0m09:08:20.201869 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:20.202209 [debug] [MainThread]: On master: Close
[0m09:08:20.203016 [info ] [MainThread]: Concurrency: 30 threads (target='analytics')
[0m09:08:20.203397 [info ] [MainThread]: 
[0m09:08:20.209139 [debug] [Thread-1 (]: Began running node model.modeling.bss_paytv_users
[0m09:08:20.209670 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics.bss_paytv_users ................... [RUN]
[0m09:08:20.210402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_vplus_db_premium_analytics, now model.modeling.bss_paytv_users)
[0m09:08:20.210791 [debug] [Thread-1 (]: Began compiling node model.modeling.bss_paytv_users
[0m09:08:20.214267 [debug] [Thread-1 (]: Writing injected SQL for node "model.modeling.bss_paytv_users"
[0m09:08:20.214898 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (compile): 09:08:20.211032 => 09:08:20.214651
[0m09:08:20.215277 [debug] [Thread-1 (]: Began executing node model.modeling.bss_paytv_users
[0m09:08:20.285965 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:20.286449 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: create temporary table
    "bss_paytv_users__dbt_tmp090820246592"
    
    
    
  as (
    

select getdate() as upload_date,* from "vplus_db_premium"."raw_data"."bss_paytv_users"
  );
[0m09:08:20.286864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:20.287266 [debug] [Thread-1 (]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:20.287831 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:20.288233 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:20.780539 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:20.797632 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:20.798077 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: BEGIN
[0m09:08:20.832165 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:20.832555 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:20.833045 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users__dbt_tmp090820246592'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users__dbt_tmp090820246592'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'bss_paytv_users__dbt_tmp090820246592'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m09:08:21.035445 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:21.049913 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:21.050458 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:21.232208 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:21.250989 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:21.251555 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'bss_paytv_users'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'bss_paytv_users'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'analytics'
        and tablename = 'bss_paytv_users'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'analytics'
    
    order by ordinal_position
[0m09:08:21.406569 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:21.424404 [debug] [Thread-1 (]: Writing runtime sql for node "model.modeling.bss_paytv_users"
[0m09:08:21.426970 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:21.427359 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: delete from "vplus_db_premium"."analytics"."bss_paytv_users"
            where (
                id) in (
                select (id)
                from "bss_paytv_users__dbt_tmp090820246592"
            );
[0m09:08:21.555130 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:21.555601 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:21.555993 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: insert into "vplus_db_premium"."analytics"."bss_paytv_users" ("upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code")
    (
        select "upload_date", "id", "provider_id", "subscriber_id", "joined_at", "status", "is_blocked", "user_id", "phone", "email", "state", "created_at", "updated_at", "deleted_at", "ref_code"
        from "bss_paytv_users__dbt_tmp090820246592"
    )
[0m09:08:21.823125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:21.839923 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m09:08:21.840471 [debug] [Thread-1 (]: Using redshift connection "model.modeling.bss_paytv_users"
[0m09:08:21.840856 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: COMMIT
[0m09:08:22.829947 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m09:08:22.831325 [debug] [Thread-1 (]: Timing info for model.modeling.bss_paytv_users (execute): 09:08:20.215516 => 09:08:22.831085
[0m09:08:22.831766 [debug] [Thread-1 (]: On model.modeling.bss_paytv_users: Close
[0m09:08:22.832683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf7acece-2aae-426b-95d8-450a4d94c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79300490>]}
[0m09:08:22.833366 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics.bss_paytv_users .............. [[32mSUCCESS[0m in 2.62s]
[0m09:08:22.834093 [debug] [Thread-1 (]: Finished running node model.modeling.bss_paytv_users
[0m09:08:22.836510 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:22.836895 [debug] [MainThread]: On master: BEGIN
[0m09:08:22.837226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:22.837588 [debug] [MainThread]: Redshift adapter: No region provided, attempting to determine from host.
[0m09:08:22.838120 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:08:22.838498 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:08:23.047277 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:23.047673 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.048104 [debug] [MainThread]: Using redshift connection "master"
[0m09:08:23.048409 [debug] [MainThread]: On master: COMMIT
[0m09:08:23.083245 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m09:08:23.083574 [debug] [MainThread]: On master: Close
[0m09:08:23.084323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:23.084618 [debug] [MainThread]: Connection 'model.modeling.bss_paytv_users' was properly closed.
[0m09:08:23.084970 [info ] [MainThread]: 
[0m09:08:23.085382 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m09:08:23.086105 [debug] [MainThread]: Command end result
[0m09:08:23.094618 [info ] [MainThread]: 
[0m09:08:23.095051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:23.095440 [info ] [MainThread]: 
[0m09:08:23.095862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:08:23.096503 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:23.096376 after 4.32 seconds
[0m09:08:23.096881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7acb5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7bbf7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79138280>]}
[0m09:08:23.097263 [debug] [MainThread]: Flushing usage events
[0m09:17:39.826871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed64b6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4f49e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4f49f00>]}


============================== 09:17:39.828589 | ccc96521-06f8-4a1f-8411-f3fb61524a70 ==============================
[0m09:17:39.828589 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:17:39.829198 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'profiles_dir': '/prk/user/loop/profiles-key/', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True'}
[0m09:17:39.852105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccc96521-06f8-4a1f-8411-f3fb61524a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4f4a9b0>]}
[0m09:17:39.852506 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:17:39.853090 [debug] [MainThread]: Command `dbt deps` succeeded at 09:17:39.852968 after 0.03 seconds
[0m09:17:39.853408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed64b6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4f4a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed4f4aa10>]}
[0m09:17:39.853747 [debug] [MainThread]: Flushing usage events
[0m09:17:42.761026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a01c2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69ec569e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69ec56980>]}


============================== 09:17:42.762770 | 35794e58-7c82-4419-9429-42261f3ccc7a ==============================
[0m09:17:42.762770 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:17:42.763399 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/prk/user/loop/profiles-key/', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m09:17:42.954135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35794e58-7c82-4419-9429-42261f3ccc7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69ec56b30>]}
[0m09:17:42.971198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35794e58-7c82-4419-9429-42261f3ccc7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0fdcf40>]}
[0m09:17:42.984527 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:17:43.006696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:17:43.007003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:17:43.007497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:17:43.012930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35794e58-7c82-4419-9429-42261f3ccc7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69e8380d0>]}
[0m09:17:43.020357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35794e58-7c82-4419-9429-42261f3ccc7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69e31f0a0>]}
[0m09:17:43.020801 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:17:43.021233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35794e58-7c82-4419-9429-42261f3ccc7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69e31c8e0>]}
[0m09:17:43.022485 [debug] [MainThread]: Command `dbt ls` succeeded at 09:17:43.022357 after 0.27 seconds
[0m09:17:43.022836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a01c2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69fd0c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69e31efb0>]}
[0m09:17:43.023175 [debug] [MainThread]: Flushing usage events
[0m09:36:04.683988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7449eb2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448949e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7448949ea0>]}


============================== 09:36:04.685751 | ab358d05-06bb-4d73-964f-ccd211199c0a ==============================
[0m09:36:04.685751 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:36:04.686362 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/prk/user/loop/profiles-key/', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:36:04.709358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab358d05-06bb-4d73-964f-ccd211199c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744894a950>]}
[0m09:36:04.709772 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:36:04.710330 [debug] [MainThread]: Command `dbt deps` succeeded at 09:36:04.710200 after 0.03 seconds
[0m09:36:04.710654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7449eb2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744894a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744894a9b0>]}
[0m09:36:04.711003 [debug] [MainThread]: Flushing usage events
[0m09:36:07.725289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970c4ba080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970af4ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970af4e9b0>]}


============================== 09:36:07.727068 | ea42282f-4052-4f8b-8a45-ef3a700caa4f ==============================
[0m09:36:07.727068 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:36:07.727655 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/prk/user/loop/profiles-key/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default'}
[0m09:36:07.921925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea42282f-4052-4f8b-8a45-ef3a700caa4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970af4eb60>]}
[0m09:36:07.939086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea42282f-4052-4f8b-8a45-ef3a700caa4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970d274f70>]}
[0m09:36:07.952721 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:36:07.975222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:07.975597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:07.976141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:36:07.981781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea42282f-4052-4f8b-8a45-ef3a700caa4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970ab340d0>]}
[0m09:36:07.989108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea42282f-4052-4f8b-8a45-ef3a700caa4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970a613010>]}
[0m09:36:07.989526 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:36:07.989892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea42282f-4052-4f8b-8a45-ef3a700caa4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970a612f80>]}
[0m09:36:07.991173 [debug] [MainThread]: Command `dbt ls` succeeded at 09:36:07.991043 after 0.27 seconds
[0m09:36:07.991527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970c4ba080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970bf42aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970a612fe0>]}
[0m09:36:07.991868 [debug] [MainThread]: Flushing usage events
[0m09:54:12.610572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e516c2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e50151e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e50151ed0>]}


============================== 09:54:12.612369 | 1d0f9bcd-0600-48f1-a5ab-513589b7f063 ==============================
[0m09:54:12.612369 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:54:12.612971 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/prk/user/loop/profiles-key/', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'no_print': 'None'}
[0m09:54:12.636198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d0f9bcd-0600-48f1-a5ab-513589b7f063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e50152980>]}
[0m09:54:12.636639 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:54:12.637214 [debug] [MainThread]: Command `dbt deps` succeeded at 09:54:12.637093 after 0.03 seconds
[0m09:54:12.637530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e516c2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e50152980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e501529e0>]}
[0m09:54:12.637856 [debug] [MainThread]: Flushing usage events
[0m09:54:15.684147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facce2b6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facccd4e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facccd4e980>]}


============================== 09:54:15.686016 | f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0 ==============================
[0m09:54:15.686016 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:54:15.686682 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'profiles_dir': '/prk/user/loop/profiles-key/', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/root/flows/ETL/etl_bss/etl_bss_paytv/modeling/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m09:54:15.890269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facccd4eb30>]}
[0m09:54:15.909766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccf05f0d0>]}
[0m09:54:15.923768 [debug] [MainThread]: checksum: 1eb5590dfc68dd362fadcf71c34d76420f2706f9e84d0070e90d21c91dfb4d7b, vars: {}, profile: , target: analytics, version: 1.5.0
[0m09:54:15.946699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:54:15.947260 [debug] [MainThread]: Partial parsing: added file: modeling://models/bss_paytv_providers.sql
[0m09:54:15.971913 [debug] [MainThread]: 1699: static parser successfully parsed bss_paytv_providers.sql
[0m09:54:15.989094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m09:54:15.994080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc923ca0>]}
[0m09:54:16.001320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc8fbf40>]}
[0m09:54:16.001783 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m09:54:16.002181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ba0fb3-6d55-4d20-a8e1-7fec20b00ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc8fbfa0>]}
[0m09:54:16.003551 [debug] [MainThread]: Command `dbt ls` succeeded at 09:54:16.003418 after 0.33 seconds
[0m09:54:16.003908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facce2b6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccde045b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc8fbee0>]}
[0m09:54:16.004238 [debug] [MainThread]: Flushing usage events
[0m11:39:28.745967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486D8DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487069E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487069F250>]}


============================== 11:39:28.754670 | e69e5a0a-3683-4a73-8b44-003a1a9b2a26 ==============================
[0m11:39:28.754670 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:39:28.755837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'send_anonymous_usage_stats': 'True'}
[0m11:39:29.011884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e69e5a0a-3683-4a73-8b44-003a1a9b2a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248706D7700>]}
[0m11:39:29.012893 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:39:29.013891 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:39:29.015884 [debug] [MainThread]: Command `dbt deps` succeeded at 11:39:29.015884 after 0.36 seconds
[0m11:39:29.016884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486D8DDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487069FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487069E710>]}
[0m11:39:29.016884 [debug] [MainThread]: Flushing usage events
[0m11:39:34.683004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C4D2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C7AF0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C7AF3670>]}


============================== 11:39:34.687987 | e23afd7b-1374-42c9-b0ad-75e73a937a54 ==============================
[0m11:39:34.687987 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:39:34.688994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:39:35.995101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C7B19360>]}
[0m11:39:36.335317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C7AF16F0>]}
[0m11:39:36.342337 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:39:36.374191 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:39:36.395828 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:39:36.396829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C85C84F0>]}
[0m11:39:39.818174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:39:39.830685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C89C8820>]}
[0m11:39:39.872664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C89E7220>]}
[0m11:39:39.873687 [info ] [MainThread]: Found 2 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:39:39.873687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23afd7b-1374-42c9-b0ad-75e73a937a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C8A53F40>]}
[0m11:39:39.877664 [debug] [MainThread]: Command `dbt ls` succeeded at 11:39:39.877664 after 5.30 seconds
[0m11:39:39.878664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C4D2DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C883BF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130C89E7280>]}
[0m11:39:39.879663 [debug] [MainThread]: Flushing usage events
[0m11:41:55.336345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B02CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B308C280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B308D870>]}


============================== 11:41:55.343045 | f8edf96c-2c8a-4dd1-96dd-02af8e91134a ==============================
[0m11:41:55.343045 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:41:55.344039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'version_check': 'True', 'profiles_dir': 'C:/adam/profiles-key', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key -t analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:55.591583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8edf96c-2c8a-4dd1-96dd-02af8e91134a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B30CF340>]}
[0m11:41:55.592605 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:41:55.594586 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:41:55.595581 [debug] [MainThread]: Command `dbt deps` succeeded at 11:41:55.595581 after 0.36 seconds
[0m11:41:55.596605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B02CDDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B308F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B308FB50>]}
[0m11:41:55.596605 [debug] [MainThread]: Flushing usage events
[0m11:42:01.623102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190D04DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190FE126B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190FE10BB0>]}


============================== 11:42:01.629193 | 10b64292-9d3d-4eb1-b610-f5e4517ed2ae ==============================
[0m11:42:01.629193 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:42:01.630134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:/adam/profiles-key', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\adam\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --project-dir C:\\adam\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir C:/adam/profiles-key --output json -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:42:02.384296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10b64292-9d3d-4eb1-b610-f5e4517ed2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190FE37220>]}
[0m11:42:02.534701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10b64292-9d3d-4eb1-b610-f5e4517ed2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219108DCFA0>]}
[0m11:42:02.536624 [info ] [MainThread]: Registered adapter: redshift=1.7.3
[0m11:42:02.547399 [debug] [MainThread]: checksum: bb19886e74a3f959ec590ad0144b6114ed986b93c15fd6fcef6c901c55aa31c4, vars: {}, profile: , target: analytics, version: 1.7.8
[0m11:42:02.699104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:42:02.699104 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_user_packages.sql
[0m11:42:02.700695 [debug] [MainThread]: Partial parsing: added file: modeling://models\bss_paytv_provider_packages.sql
[0m11:42:02.700695 [debug] [MainThread]: Partial parsing: updated file: modeling://models\source.yml
[0m11:42:03.035713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.models
[0m11:42:03.041373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10b64292-9d3d-4eb1-b610-f5e4517ed2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021911E200D0>]}
[0m11:42:03.052997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10b64292-9d3d-4eb1-b610-f5e4517ed2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021910A25D80>]}
[0m11:42:03.054078 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m11:42:03.054078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10b64292-9d3d-4eb1-b610-f5e4517ed2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021910A25D50>]}
[0m11:42:03.056093 [debug] [MainThread]: Command `dbt ls` succeeded at 11:42:03.056093 after 1.51 seconds
[0m11:42:03.056093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190D04DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021910A255D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021910A25D50>]}
[0m11:42:03.057087 [debug] [MainThread]: Flushing usage events
[0m14:14:02.566231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC0589E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEBF587A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEBF587880>]}


============================== 14:14:02.572015 | 6a677c80-92f5-45f4-b9d8-976e86d1b582 ==============================
[0m14:14:02.572015 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:14:02.573015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:02.838456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a677c80-92f5-45f4-b9d8-976e86d1b582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEBF587BB0>]}
[0m14:14:02.839982 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:14:02.842993 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:14:02.845990 [debug] [MainThread]: Command `dbt deps` succeeded at 14:14:02.844991 after 0.40 seconds
[0m14:14:02.846992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC0589E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEBF587BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC2F7E410>]}
[0m14:14:02.847992 [debug] [MainThread]: Flushing usage events
[0m14:17:54.029748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022394042E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022393047A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022393045090>]}


============================== 14:17:54.035700 | 341bf3b8-4ebe-439f-adae-a93a9e445116 ==============================
[0m14:17:54.035700 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:17:54.036780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling\\logs', 'debug': 'False', 'profiles_dir': 'D:/Projects/profiles-key/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --project-dir D:\\Projects\\etl_bss\\etl_bss_paytv\\modeling --profiles-dir D:/Projects/profiles-key/ -t analytics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:54.331570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '341bf3b8-4ebe-439f-adae-a93a9e445116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022394950B50>]}
[0m14:17:54.332577 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:17:54.335583 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:17:54.337577 [debug] [MainThread]: Command `dbt deps` succeeded at 14:17:54.337577 after 0.40 seconds
[0m14:17:54.338595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022394042E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022393047BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223969A7400>]}
[0m14:17:54.339577 [debug] [MainThread]: Flushing usage events
